"use strict";(self.webpackChunkVitesseVent_OS_3=self.webpackChunkVitesseVent_OS_3||[]).push([[179],{456:(Qm,pw,eg)=>{var Ec={};function st(n){return"function"==typeof n}function mw(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}eg.r(Ec),eg.d(Ec,{ACESFilmicToneMapping:()=>Zv,AddEquation:()=>Zo,AddOperation:()=>iI,AdditiveAnimationBlendMode:()=>wb,AdditiveBlending:()=>jv,AlphaFormat:()=>fI,AlwaysDepth:()=>K1,AlwaysStencilFunc:()=>II,AmbientLight:()=>CP,AmbientLightProbe:()=>AX,AnimationClip:()=>vc,AnimationLoader:()=>_X,AnimationMixer:()=>qX,AnimationObjectGroup:()=>jX,AnimationUtils:()=>fX,ArcCurve:()=>$R,ArrayCamera:()=>MR,ArrowHelper:()=>pY,Audio:()=>BP,AudioAnalyser:()=>OX,AudioContext:()=>z0,AudioListener:()=>RX,AudioLoader:()=>CX,AxesHelper:()=>mY,BackSide:()=>xi,BasicDepthPacking:()=>DI,BasicShadowMap:()=>wW,Bone:()=>Qp,BooleanKeyframeTrack:()=>ga,Box2:()=>eY,Box3:()=>eo,Box3Helper:()=>hY,BoxBufferGeometry:()=>xY,BoxGeometry:()=>oo,BoxHelper:()=>dY,BufferAttribute:()=>Dt,BufferGeometry:()=>et,BufferGeometryLoader:()=>IP,ByteType:()=>lI,Cache:()=>ya,Camera:()=>Bp,CameraHelper:()=>uY,CanvasTexture:()=>k7,CapsuleBufferGeometry:()=>wY,CapsuleGeometry:()=>_d,CatmullRomCurve3:()=>qR,CineonToneMapping:()=>oI,CircleBufferGeometry:()=>MY,CircleGeometry:()=>yd,ClampToEdgeWrapping:()=>zn,Clock:()=>H0,Color:()=>me,ColorKeyframeTrack:()=>F0,ColorManagement:()=>yn,CompressedArrayTexture:()=>N7,CompressedTexture:()=>g0,CompressedTextureLoader:()=>yX,ConeBufferGeometry:()=>SY,ConeGeometry:()=>vd,CubeCamera:()=>XI,CubeReflectionMapping:()=>qs,CubeRefractionMapping:()=>Xs,CubeTexture:()=>od,CubeTextureLoader:()=>vX,CubeUVReflectionMapping:()=>Ol,CubicBezierCurve:()=>x0,CubicBezierCurve3:()=>YR,CubicInterpolant:()=>_P,CullFaceBack:()=>zv,CullFaceFront:()=>N1,CullFaceFrontBack:()=>xW,CullFaceNone:()=>L1,Curve:()=>Dr,CurvePath:()=>ZR,CustomBlending:()=>k1,CustomToneMapping:()=>aI,CylinderBufferGeometry:()=>EY,CylinderGeometry:()=>ha,Cylindrical:()=>QX,Data3DTexture:()=>Fb,DataArrayTexture:()=>Sp,DataTexture:()=>uc,DataTextureLoader:()=>bX,DataUtils:()=>bY,DecrementStencilOp:()=>PW,DecrementWrapStencilOp:()=>OW,DefaultLoadingManager:()=>bP,DepthFormat:()=>Js,DepthStencilFormat:()=>Qo,DepthTexture:()=>SR,DirectionalLight:()=>U0,DirectionalLightHelper:()=>cY,DiscreteInterpolant:()=>yP,DodecahedronBufferGeometry:()=>CY,DodecahedronGeometry:()=>bd,DoubleSide:()=>Wr,DstAlphaFactor:()=>j1,DstColorFactor:()=>$1,DynamicCopyUsage:()=>YW,DynamicDrawUsage:()=>GW,DynamicReadUsage:()=>$W,EdgesGeometry:()=>JR,EllipseCurve:()=>sm,EqualDepth:()=>J1,EqualStencilFunc:()=>BW,EquirectangularReflectionMapping:()=>ju,EquirectangularRefractionMapping:()=>Wu,Euler:()=>BI,EventDispatcher:()=>_s,ExtrudeBufferGeometry:()=>DY,ExtrudeGeometry:()=>Sd,FileLoader:()=>Tr,Float16BufferAttribute:()=>T6,Float32BufferAttribute:()=>Ee,Float64BufferAttribute:()=>I6,FloatType:()=>ms,Fog:()=>qp,FogExp2:()=>$p,FramebufferTexture:()=>L7,FrontSide:()=>jr,Frustum:()=>Up,GLBufferAttribute:()=>ZX,GLSL1:()=>ZW,GLSL3:()=>Sb,GreaterDepth:()=>eI,GreaterEqualDepth:()=>Q1,GreaterEqualStencilFunc:()=>HW,GreaterStencilFunc:()=>UW,GridHelper:()=>aY,Group:()=>Ss,HalfFloatType:()=>kl,HemisphereLight:()=>wP,HemisphereLightHelper:()=>oY,HemisphereLightProbe:()=>DX,IcosahedronBufferGeometry:()=>AY,IcosahedronGeometry:()=>Ed,ImageBitmapLoader:()=>FP,ImageLoader:()=>Fd,ImageUtils:()=>Rb,IncrementStencilOp:()=>RW,IncrementWrapStencilOp:()=>FW,InstancedBufferAttribute:()=>dc,InstancedBufferGeometry:()=>TP,InstancedInterleavedBuffer:()=>KX,InstancedMesh:()=>d0,Int16BufferAttribute:()=>D6,Int32BufferAttribute:()=>A6,Int8BufferAttribute:()=>S6,IntType:()=>uI,InterleavedBuffer:()=>ld,InterleavedBufferAttribute:()=>lo,Interpolant:()=>gc,InterpolateDiscrete:()=>Bl,InterpolateLinear:()=>ea,InterpolateSmooth:()=>mp,InvertStencilOp:()=>LW,KeepStencilOp:()=>yp,KeyframeTrack:()=>Ar,LOD:()=>RR,LatheBufferGeometry:()=>TY,LatheGeometry:()=>hc,Layers:()=>ca,LessDepth:()=>Z1,LessEqualDepth:()=>ap,LessEqualStencilFunc:()=>VW,LessStencilFunc:()=>kW,Light:()=>uo,LightProbe:()=>pm,Line:()=>Es,Line3:()=>tY,LineBasicMaterial:()=>ei,LineCurve:()=>am,LineCurve3:()=>KR,LineDashedMaterial:()=>mP,LineLoop:()=>f0,LineSegments:()=>Cr,LinearEncoding:()=>gs,LinearFilter:()=>Jt,LinearInterpolant:()=>P0,LinearMipMapLinearFilter:()=>DW,LinearMipMapNearestFilter:()=>CW,LinearMipmapLinearFilter:()=>$r,LinearMipmapNearestFilter:()=>cp,LinearSRGBColorSpace:()=>Vl,LinearToneMapping:()=>rI,Loader:()=>wi,LoaderUtils:()=>bc,LoadingManager:()=>O0,LoopOnce:()=>MI,LoopPingPong:()=>EI,LoopRepeat:()=>SI,LuminanceAlphaFormat:()=>mI,LuminanceFormat:()=>pI,MOUSE:()=>vW,Material:()=>Dn,MaterialLoader:()=>mm,MathUtils:()=>Db,Matrix3:()=>ci,Matrix4:()=>He,MaxEquation:()=>Xv,Mesh:()=>On,MeshBasicMaterial:()=>Li,MeshDepthMaterial:()=>s0,MeshDistanceMaterial:()=>o0,MeshLambertMaterial:()=>fP,MeshMatcapMaterial:()=>pP,MeshNormalMaterial:()=>hP,MeshPhongMaterial:()=>uP,MeshPhysicalMaterial:()=>Ds,MeshStandardMaterial:()=>Pd,MeshToonMaterial:()=>dP,MinEquation:()=>qv,MirroredRepeatWrapping:()=>Ll,MixOperation:()=>nI,MultiplyBlending:()=>$v,MultiplyOperation:()=>Gu,NearestFilter:()=>sn,NearestMipMapLinearFilter:()=>EW,NearestMipMapNearestFilter:()=>SW,NearestMipmapLinearFilter:()=>Nl,NearestMipmapNearestFilter:()=>$u,NeverDepth:()=>Y1,NeverStencilFunc:()=>NW,NoBlending:()=>ps,NoColorSpace:()=>AW,NoToneMapping:()=>vr,NormalAnimationBlendMode:()=>gp,NormalBlending:()=>Ko,NotEqualDepth:()=>tI,NotEqualStencilFunc:()=>zW,NumberKeyframeTrack:()=>_c,Object3D:()=>Vt,ObjectLoader:()=>SX,ObjectSpaceNormalMap:()=>TI,OctahedronBufferGeometry:()=>IY,OctahedronGeometry:()=>pc,OneFactor:()=>z1,OneMinusDstAlphaFactor:()=>W1,OneMinusDstColorFactor:()=>q1,OneMinusSrcAlphaFactor:()=>Kv,OneMinusSrcColorFactor:()=>G1,OrthographicCamera:()=>nc,PCFShadowMap:()=>Hv,PCFSoftShadowMap:()=>Gv,PMREMGenerator:()=>e0,Path:()=>gd,PerspectiveCamera:()=>An,Plane:()=>ao,PlaneBufferGeometry:()=>RY,PlaneGeometry:()=>tc,PlaneHelper:()=>fY,PointLight:()=>V0,PointLightHelper:()=>rY,Points:()=>m0,PointsMaterial:()=>nm,PolarGridHelper:()=>lY,PolyhedronBufferGeometry:()=>PY,PolyhedronGeometry:()=>Cs,PositionalAudio:()=>FX,PropertyBinding:()=>Ut,PropertyMixer:()=>UP,QuadraticBezierCurve:()=>w0,QuadraticBezierCurve3:()=>M0,Quaternion:()=>Qn,QuaternionKeyframeTrack:()=>co,QuaternionLinearInterpolant:()=>vP,RED_GREEN_RGTC2_Format:()=>bb,RED_RGTC1_Format:()=>wI,REVISION:()=>op,RGBADepthPacking:()=>AI,RGBAFormat:()=>Pi,RGBAIntegerFormat:()=>bI,RGBA_ASTC_10x10_Format:()=>gb,RGBA_ASTC_10x5_Format:()=>fb,RGBA_ASTC_10x6_Format:()=>pb,RGBA_ASTC_10x8_Format:()=>mb,RGBA_ASTC_12x10_Format:()=>_b,RGBA_ASTC_12x12_Format:()=>yb,RGBA_ASTC_4x4_Format:()=>sb,RGBA_ASTC_5x4_Format:()=>ob,RGBA_ASTC_5x5_Format:()=>ab,RGBA_ASTC_6x5_Format:()=>lb,RGBA_ASTC_6x6_Format:()=>cb,RGBA_ASTC_8x5_Format:()=>ub,RGBA_ASTC_8x6_Format:()=>db,RGBA_ASTC_8x8_Format:()=>hb,RGBA_BPTC_Format:()=>pp,RGBA_ETC2_EAC_Format:()=>rb,RGBA_PVRTC_2BPPV1_Format:()=>nb,RGBA_PVRTC_4BPPV1_Format:()=>tb,RGBA_S3TC_DXT1_Format:()=>dp,RGBA_S3TC_DXT3_Format:()=>hp,RGBA_S3TC_DXT5_Format:()=>fp,RGB_ETC1_Format:()=>xI,RGB_ETC2_Format:()=>ib,RGB_PVRTC_2BPPV1_Format:()=>eb,RGB_PVRTC_4BPPV1_Format:()=>Qv,RGB_S3TC_DXT1_Format:()=>up,RGFormat:()=>yI,RGIntegerFormat:()=>vI,RawShaderMaterial:()=>cP,Ray:()=>ed,Raycaster:()=>$0,RectAreaLight:()=>DP,RedFormat:()=>gI,RedIntegerFormat:()=>_I,ReinhardToneMapping:()=>sI,RepeatWrapping:()=>Ys,ReplaceStencilOp:()=>IW,ReverseSubtractEquation:()=>V1,RingBufferGeometry:()=>FY,RingGeometry:()=>Cd,SIGNED_RED_GREEN_RGTC2_Format:()=>xb,SIGNED_RED_RGTC1_Format:()=>vb,SRGBColorSpace:()=>br,Scene:()=>Xp,ShaderChunk:()=>tt,ShaderLib:()=>Er,ShaderMaterial:()=>qr,ShadowMaterial:()=>lP,Shape:()=>fa,ShapeBufferGeometry:()=>OY,ShapeGeometry:()=>Dd,ShapePath:()=>gY,ShapeUtils:()=>Xr,ShortType:()=>cI,Skeleton:()=>hd,SkeletonHelper:()=>iY,SkinnedMesh:()=>u0,Source:()=>sa,Sphere:()=>io,SphereBufferGeometry:()=>LY,SphereGeometry:()=>mc,Spherical:()=>JX,SphericalHarmonics3:()=>AP,SplineCurve:()=>S0,SpotLight:()=>k0,SpotLightHelper:()=>nY,Sprite:()=>TR,SpriteMaterial:()=>l0,SrcAlphaFactor:()=>Yv,SrcAlphaSaturateFactor:()=>X1,SrcColorFactor:()=>H1,StaticCopyUsage:()=>XW,StaticDrawUsage:()=>Xu,StaticReadUsage:()=>WW,StereoCamera:()=>TX,StreamCopyUsage:()=>KW,StreamDrawUsage:()=>jW,StreamReadUsage:()=>qW,StringKeyframeTrack:()=>_a,SubtractEquation:()=>B1,SubtractiveBlending:()=>Wv,TOUCH:()=>bW,TangentSpaceNormalMap:()=>Qs,TetrahedronBufferGeometry:()=>NY,TetrahedronGeometry:()=>Ad,Texture:()=>Hn,TextureLoader:()=>xP,TorusBufferGeometry:()=>kY,TorusGeometry:()=>Td,TorusKnotBufferGeometry:()=>BY,TorusKnotGeometry:()=>Id,Triangle:()=>er,TriangleFanDrawMode:()=>_p,TriangleStripDrawMode:()=>Mb,TrianglesDrawMode:()=>CI,TubeBufferGeometry:()=>VY,TubeGeometry:()=>Rd,TwoPassDoubleSide:()=>MW,UVMapping:()=>lp,Uint16BufferAttribute:()=>Wb,Uint32BufferAttribute:()=>$b,Uint8BufferAttribute:()=>E6,Uint8ClampedBufferAttribute:()=>C6,Uniform:()=>W0,UniformsGroup:()=>YX,UniformsLib:()=>fe,UniformsUtils:()=>qI,UnsignedByteType:()=>Ks,UnsignedInt248Type:()=>Jo,UnsignedIntType:()=>Zs,UnsignedShort4444Type:()=>dI,UnsignedShort5551Type:()=>hI,UnsignedShortType:()=>Jv,VSMShadowMap:()=>Fl,Vector2:()=>ee,Vector3:()=>D,Vector4:()=>Rt,VectorKeyframeTrack:()=>yc,VideoTexture:()=>O7,WebGL1Renderer:()=>ER,WebGL3DRenderTarget:()=>p6,WebGLArrayRenderTarget:()=>f6,WebGLCubeRenderTarget:()=>YI,WebGLMultipleRenderTargets:()=>m6,WebGLRenderTarget:()=>wr,WebGLRenderer:()=>Wp,WebGLUtils:()=>wR,WireframeGeometry:()=>sP,WrapAroundEnding:()=>qu,ZeroCurvatureEnding:()=>ta,ZeroFactor:()=>U1,ZeroSlopeEnding:()=>na,ZeroStencilOp:()=>TW,_SRGBAFormat:()=>vp,sRGBEncoding:()=>mt});const tg=mw(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function th(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class qt{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(st(i))try{i()}catch(s){e=s instanceof tg?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{yw(s)}catch(o){e=e??[],o instanceof tg?e=[...e,...o.errors]:e.push(o)}}if(e)throw new tg(e)}}add(e){var t;if(e&&e!==this)if(this.closed)yw(e);else{if(e instanceof qt){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&th(t,e)}remove(e){const{_finalizers:t}=this;t&&th(t,e),e instanceof qt&&e._removeParent(this)}}qt.EMPTY=(()=>{const n=new qt;return n.closed=!0,n})();const gw=qt.EMPTY;function _w(n){return n instanceof qt||n&&"closed"in n&&st(n.remove)&&st(n.add)&&st(n.unsubscribe)}function yw(n){st(n)?n():n.unsubscribe()}const bo={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},nh={setTimeout(n,e,...t){const{delegate:i}=nh;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=nh;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function vw(n){nh.setTimeout(()=>{const{onUnhandledError:e}=bo;if(!e)throw n;e(n)})}function La(){}const SL=ng("C",void 0,void 0);function ng(n,e,t){return{kind:n,value:e,error:t}}let xo=null;function ih(n){if(bo.useDeprecatedSynchronousErrorHandling){const e=!xo;if(e&&(xo={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=xo;if(xo=null,t)throw i}}else n()}class ig extends qt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,_w(e)&&e.add(this)):this.destination=RL}static create(e,t,i){return new Cc(e,t,i)}next(e){this.isStopped?sg(function CL(n){return ng("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?sg(function EL(n){return ng("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?sg(SL,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const AL=Function.prototype.bind;function rg(n,e){return AL.call(n,e)}class TL{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){rh(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){rh(i)}else rh(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){rh(t)}}}class Cc extends ig{constructor(e,t,i){let r;if(super(),st(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&bo.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&rg(e.next,s),error:e.error&&rg(e.error,s),complete:e.complete&&rg(e.complete,s)}):r=e}this.destination=new TL(r)}}function rh(n){bo.useDeprecatedSynchronousErrorHandling?function DL(n){bo.useDeprecatedSynchronousErrorHandling&&xo&&(xo.errorThrown=!0,xo.error=n)}(n):vw(n)}function sg(n,e){const{onStoppedNotification:t}=bo;t&&nh.setTimeout(()=>t(n,e))}const RL={closed:!0,next:La,error:function IL(n){throw n},complete:La},og="function"==typeof Symbol&&Symbol.observable||"@@observable";function Fs(n){return n}function bw(n){return 0===n.length?Fs:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let Lt=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function OL(n){return n&&n instanceof ig||function FL(n){return n&&st(n.next)&&st(n.error)&&st(n.complete)}(n)&&_w(n)}(t)?t:new Cc(t,i,r);return ih(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=xw(i))((r,s)=>{const o=new Cc({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[og](){return this}pipe(...t){return bw(t)(this)}toPromise(t){return new(t=xw(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function xw(n){var e;return null!==(e=n??bo.Promise)&&void 0!==e?e:Promise}const LL=mw(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let wt=(()=>{class n extends Lt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new ww(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new LL}next(t){ih(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){ih(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){ih(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?gw:(this.currentObservers=null,s.push(t),new qt(()=>{this.currentObservers=null,th(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new Lt;return t.source=this,t}}return n.create=(e,t)=>new ww(e,t),n})();class ww extends wt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:gw}}function Mw(n){return st(n?.lift)}function en(n){return e=>{if(Mw(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Gt(n,e,t,i,r){return new NL(n,e,t,i,r)}class NL extends ig{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Nt(n,e){return en((t,i)=>{let r=0;t.subscribe(Gt(i,s=>{i.next(n.call(e,s,r++))}))})}function wo(n){return this instanceof wo?(this.v=n,this):new wo(n)}function UL(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function Cw(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}function Dw(n,e,t,i){if("a"===t&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?n!==e||!i:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===t?i:"a"===t?i.call(n):i?i.value:e.get(n)}const lg=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Aw(n){return st(n?.then)}function Tw(n){return st(n[og])}function Iw(n){return Symbol.asyncIterator&&st(n?.[Symbol.asyncIterator])}function Rw(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Pw=function HL(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Fw(n){return st(n?.[Pw])}function Ow(n){return function VL(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(h){i[h]&&(r[h]=function(f){return new Promise(function(p,m){s.push([h,f,p,m])>1||a(h,f)})})}function a(h,f){try{!function l(h){h.value instanceof wo?Promise.resolve(h.value.v).then(c,u):d(s[0][2],h)}(i[h](f))}catch(p){d(s[0][3],p)}}function c(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield wo(t.read());if(r)return yield wo(void 0);yield yield wo(i)}}finally{t.releaseLock()}})}function Lw(n){return st(n?.getReader)}function Rn(n){if(n instanceof Lt)return n;if(null!=n){if(Tw(n))return function GL(n){return new Lt(e=>{const t=n[og]();if(st(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(lg(n))return function jL(n){return new Lt(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(Aw(n))return function WL(n){return new Lt(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,vw)})}(n);if(Iw(n))return Nw(n);if(Fw(n))return function $L(n){return new Lt(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(Lw(n))return function qL(n){return Nw(Ow(n))}(n)}throw Rw(n)}function Nw(n){return new Lt(e=>{(function XL(n,e){var t,i,r,s;return function kL(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=UL(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function Kr(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function Na(n,e,t=1/0){return st(e)?Na((i,r)=>Nt((s,o)=>e(i,s,r,o))(Rn(n(i,r))),t):("number"==typeof e&&(t=e),en((i,r)=>function YL(n,e,t,i,r,s,o,a){const l=[];let c=0,u=0,d=!1;const h=()=>{d&&!l.length&&!c&&e.complete()},f=m=>c<i?p(m):l.push(m),p=m=>{s&&e.next(m),c++;let g=!1;Rn(t(m,u++)).subscribe(Gt(e,y=>{r?.(y),s?f(y):e.next(y)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;l.length&&c<i;){const y=l.shift();o?Kr(e,o,()=>p(y)):p(y)}h()}catch(y){e.error(y)}}))};return n.subscribe(Gt(e,f,()=>{d=!0,h()})),()=>{a?.()}}(i,r,n,t)))}function sh(n=1/0){return Na(Fs,n)}const Dc=new Lt(n=>n.complete());function kw(n){return n&&st(n.schedule)}function cg(n){return n[n.length-1]}function ug(n){return st(cg(n))?n.pop():void 0}function Ac(n){return kw(cg(n))?n.pop():void 0}function ka(n,e=0){return en((t,i)=>{t.subscribe(Gt(i,r=>Kr(i,n,()=>i.next(r),e),()=>Kr(i,n,()=>i.complete(),e),r=>Kr(i,n,()=>i.error(r),e)))})}function Bw(n,e=0){return en((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function Vw(n,e){if(!n)throw new Error("Iterable cannot be null");return new Lt(t=>{Kr(t,e,()=>{const i=n[Symbol.asyncIterator]();Kr(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Mo(n,e){return e?function iN(n,e){if(null!=n){if(Tw(n))return function JL(n,e){return Rn(n).pipe(Bw(e),ka(e))}(n,e);if(lg(n))return function eN(n,e){return new Lt(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(Aw(n))return function QL(n,e){return Rn(n).pipe(Bw(e),ka(e))}(n,e);if(Iw(n))return Vw(n,e);if(Fw(n))return function tN(n,e){return new Lt(t=>{let i;return Kr(t,e,()=>{i=n[Pw](),Kr(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>st(i?.return)&&i.return()})}(n,e);if(Lw(n))return function nN(n,e){return Vw(Ow(n),e)}(n,e)}throw Rw(n)}(n,e):Rn(n)}function Os(...n){const e=Ac(n),t=function ZL(n,e){return"number"==typeof cg(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?Rn(i[0]):sh(t)(Mo(i,e)):Dc}function Tc(n={}){const{connector:e=(()=>new wt),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,l,c=0,u=!1,d=!1;const h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=l=void 0,u=d=!1},p=()=>{const m=o;f(),m?.unsubscribe()};return en((m,g)=>{c++,!d&&!u&&h();const y=l=l??e();g.add(()=>{c--,0===c&&!d&&!u&&(a=dg(p,r))}),y.subscribe(g),!o&&c>0&&(o=new Cc({next:v=>y.next(v),error:v=>{d=!0,h(),a=dg(f,t,v),y.error(v)},complete:()=>{u=!0,h(),a=dg(f,i),y.complete()}}),Rn(m).subscribe(o))})(s)}}function dg(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new Cc({next:()=>{i.unsubscribe(),n()}});return Rn(e(...t)).subscribe(i)}function kt(n){for(let e in n)if(n[e]===kt)return e;throw Error("Could not find renamed property on target object.")}function hg(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function zt(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(zt).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function fg(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const rN=kt({__forward_ref__:kt});function Ft(n){return n.__forward_ref__=Ft,n.toString=function(){return zt(this())},n}function Ne(n){return pg(n)?n():n}function pg(n){return"function"==typeof n&&n.hasOwnProperty(rN)&&n.__forward_ref__===Ft}function mg(n){return n&&!!n.\u0275providers}const oh="https://g.co/ng/security#xss";class se extends Error{constructor(e,t){super(ah(e,t)),this.code=e}}function ah(n,e){return`NG0${Math.abs(n)}${e?": "+e.trim():""}`}function je(n){return"string"==typeof n?n:null==n?"":String(n)}function lh(n,e){throw new se(-201,!1)}function zi(n,e){null==n&&function St(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function Ce(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function hn(n){return{providers:n.providers||[],imports:n.imports||[]}}function ch(n){return Uw(n,uh)||Uw(n,Hw)}function Uw(n,e){return n.hasOwnProperty(e)?n[e]:null}function zw(n){return n&&(n.hasOwnProperty(gg)||n.hasOwnProperty(hN))?n[gg]:null}const uh=kt({\u0275prov:kt}),gg=kt({\u0275inj:kt}),Hw=kt({ngInjectableDef:kt}),hN=kt({ngInjectorDef:kt});var ze=(()=>((ze=ze||{})[ze.Default=0]="Default",ze[ze.Host=1]="Host",ze[ze.Self=2]="Self",ze[ze.SkipSelf=4]="SkipSelf",ze[ze.Optional=8]="Optional",ze))();let _g;function Hi(n){const e=_g;return _g=n,e}function Gw(n,e,t){const i=ch(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&ze.Optional?null:void 0!==e?e:void lh(zt(n))}const jt=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Ic={},yg="__NG_DI_FLAG__",dh="ngTempTokenPath",pN="ngTokenPath",mN=/\n/gm,gN="\u0275",jw="__source";let Rc;function Ba(n){const e=Rc;return Rc=n,e}function _N(n,e=ze.Default){if(void 0===Rc)throw new se(-203,!1);return null===Rc?Gw(n,void 0,e):Rc.get(n,e&ze.Optional?null:void 0,e)}function ie(n,e=ze.Default){return(function fN(){return _g}()||_N)(Ne(n),e)}function _t(n,e=ze.Default){return ie(n,hh(e))}function hh(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function vg(n){const e=[];for(let t=0;t<n.length;t++){const i=Ne(n[t]);if(Array.isArray(i)){if(0===i.length)throw new se(900,!1);let r,s=ze.Default;for(let o=0;o<i.length;o++){const a=i[o],l=yN(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(ie(r,s))}else e.push(ie(i))}return e}function Pc(n,e){return n[yg]=e,n.prototype[yg]=e,n}function yN(n){return n[yg]}function Zr(n){return{toString:n}.toString()}var Pr=(()=>((Pr=Pr||{})[Pr.OnPush=0]="OnPush",Pr[Pr.Default=1]="Default",Pr))(),ar=(()=>{return(n=ar||(ar={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",ar;var n})();const Jr={},bt=[],fh=kt({\u0275cmp:kt}),bg=kt({\u0275dir:kt}),xg=kt({\u0275pipe:kt}),$w=kt({\u0275mod:kt}),Qr=kt({\u0275fac:kt}),Fc=kt({__NG_ELEMENT_ID__:kt});let xN=0;function Gi(n){return Zr(()=>{const e=Xw(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Pr.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,data:n.data||{},encapsulation:n.encapsulation||ar.Emulated,id:"c"+xN++,styles:n.styles||bt,_:null,schemas:n.schemas||null,tView:null};Yw(t);const i=n.dependencies;return t.directiveDefs=ph(i,!1),t.pipeDefs=ph(i,!0),t})}function MN(n){return Et(n)||jn(n)}function SN(n){return null!==n}function wn(n){return Zr(()=>({type:n.type,bootstrap:n.bootstrap||bt,declarations:n.declarations||bt,imports:n.imports||bt,exports:n.exports||bt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function qw(n,e){if(null==n)return Jr;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}function De(n){return Zr(()=>{const e=Xw(n);return Yw(e),e})}function ni(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function Et(n){return n[fh]||null}function jn(n){return n[bg]||null}function pi(n){return n[xg]||null}function Xw(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,exportAs:n.exportAs||null,standalone:!0===n.standalone,selectors:n.selectors||bt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:qw(n.inputs,e),outputs:qw(n.outputs)}}function Yw(n){n.features?.forEach(e=>e(n))}function ph(n,e){if(!n)return null;const t=e?pi:MN;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(SN)}const es=0,Me=1,Ze=2,tn=3,lr=4,So=5,Wn=6,Va=7,an=8,mh=9,gh=10,Qe=11,wg=12,Lc=13,Kw=14,Ua=15,$n=16,Nc=17,za=18,Fr=19,kc=20,Zw=21,Wt=22,Mg=1,Jw=2,_h=7,yh=8,Ha=9,ii=10;function Ei(n){return Array.isArray(n)&&"object"==typeof n[Mg]}function cr(n){return Array.isArray(n)&&!0===n[Mg]}function Sg(n){return 0!=(4&n.flags)}function Bc(n){return n.componentOffset>-1}function vh(n){return 1==(1&n.flags)}function ur(n){return!!n.template}function CN(n){return 0!=(256&n[Ze])}function Eo(n,e){return n.hasOwnProperty(Qr)?n[Qr]:null}class TN{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Or(){return tM}function tM(n){return n.type.prototype.ngOnChanges&&(n.setInput=RN),IN}function IN(){const n=iM(this),e=n?.current;if(e){const t=n.previous;if(t===Jr)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function RN(n,e,t,i){const r=this.declaredInputs[t],s=iM(n)||function PN(n,e){return n[nM]=e}(n,{previous:Jr,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[r];o[r]=new TN(l&&l.currentValue,e,a===Jr),n[i]=e}Or.ngInherit=!0;const nM="__ngSimpleChanges__";function iM(n){return n[nM]||null}const ji=function(n,e,t){},rM="svg";function Bn(n){for(;Array.isArray(n);)n=n[es];return n}function Ci(n,e){return Bn(e[n.index])}function oM(n,e){return n.data[e]}function Ga(n,e){return n[e]}function mi(n,e){const t=e[n];return Ei(t)?t:t[es]}function xh(n){return 64==(64&n[Ze])}function Ns(n,e){return null==e?null:n[e]}function aM(n){n[za]=0}function Cg(n,e){n[So]+=e;let t=n,i=n[tn];for(;null!==i&&(1===e&&1===t[So]||-1===e&&0===t[So]);)i[So]+=e,t=i,i=i[tn]}const We={lFrame:_M(null),bindingsEnabled:!0};function cM(){return We.bindingsEnabled}function re(){return We.lFrame.lView}function lt(){return We.lFrame.tView}function Co(n){return We.lFrame.contextLView=n,n[an]}function Do(n){return We.lFrame.contextLView=null,n}function Vn(){let n=uM();for(;null!==n&&64===n.type;)n=n.parent;return n}function uM(){return We.lFrame.currentTNode}function Lr(n,e){const t=We.lFrame;t.currentTNode=n,t.isParent=e}function Dg(){return We.lFrame.isParent}function Ag(){We.lFrame.isParent=!1}function ri(){const n=We.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function ja(){return We.lFrame.bindingIndex++}function WN(n,e){const t=We.lFrame;t.bindingIndex=t.bindingRootIndex=n,Tg(e)}function Tg(n){We.lFrame.currentDirectiveIndex=n}function pM(){return We.lFrame.currentQueryIndex}function Rg(n){We.lFrame.currentQueryIndex=n}function qN(n){const e=n[Me];return 2===e.type?e.declTNode:1===e.type?n[Wn]:null}function mM(n,e,t){if(t&ze.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&ze.Host||(r=qN(s),null===r||(s=s[Ua],10&r.type))););if(null===r)return!1;e=r,n=s}const i=We.lFrame=gM();return i.currentTNode=e,i.lView=n,!0}function Pg(n){const e=gM(),t=n[Me];We.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function gM(){const n=We.lFrame,e=null===n?null:n.child;return null===e?_M(n):e}function _M(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function yM(){const n=We.lFrame;return We.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const vM=yM;function Fg(){const n=yM();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function si(){return We.lFrame.selectedIndex}function Ao(n){We.lFrame.selectedIndex=n}function Kt(){const n=We.lFrame;return oM(n.tView,n.selectedIndex)}function wh(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks??(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks??(n.contentHooks=[])).push(t,a),(n.contentCheckHooks??(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks??(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks??(n.viewHooks=[])).push(t,c),(n.viewCheckHooks??(n.viewCheckHooks=[])).push(t,c)),null!=u&&(n.destroyHooks??(n.destroyHooks=[])).push(t,u)}}function Mh(n,e,t){xM(n,e,3,t)}function Sh(n,e,t,i){(3&n[Ze])===t&&xM(n,e,t,i)}function Lg(n,e){let t=n[Ze];(3&t)===e&&(t&=2047,t+=1,n[Ze]=t)}function xM(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[za]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[za]+=65536),(a<s||-1==s)&&(ek(n,t,e,l),n[za]=(4294901760&n[za])+l+2),l++}function ek(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[Ze]>>11<n[za]>>16&&(3&n[Ze])===e){n[Ze]+=2048,ji(4,a,s);try{s.call(a)}finally{ji(5,a,s)}}}else{ji(4,a,s);try{s.call(a)}finally{ji(5,a,s)}}}const Wa=-1;class Uc{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function kg(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];MM(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function wM(n){return 3===n||4===n||6===n}function MM(n){return 64===n.charCodeAt(0)}function zc(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||SM(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function SM(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function EM(n){return n!==Wa}function Eh(n){return 32767&n}function Ch(n,e){let t=function rk(n){return n>>16}(n),i=e;for(;t>0;)i=i[Ua],t--;return i}let Bg=!0;function Dh(n){const e=Bg;return Bg=n,e}const CM=255,DM=5;let sk=0;const Nr={};function Ah(n,e){const t=AM(n,e);if(-1!==t)return t;const i=e[Me];i.firstCreatePass&&(n.injectorIndex=e.length,Vg(i.data,n),Vg(e,null),Vg(i.blueprint,null));const r=Ug(n,e),s=n.injectorIndex;if(EM(r)){const o=Eh(r),a=Ch(r,e),l=a[Me].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function Vg(n,e){n.push(0,0,0,0,0,0,0,0,e)}function AM(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Ug(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=LM(r),null===i)return Wa;if(t++,r=r[Ua],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return Wa}function zg(n,e,t){!function ok(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Fc)&&(i=t[Fc]),null==i&&(i=t[Fc]=sk++);const r=i&CM;e.data[n+(r>>DM)]|=1<<r}(n,e,t)}function TM(n,e,t){if(t&ze.Optional||void 0!==n)return n;lh()}function IM(n,e,t,i){if(t&ze.Optional&&void 0===i&&(i=null),!(t&(ze.Self|ze.Host))){const r=n[mh],s=Hi(void 0);try{return r?r.get(e,i,t&ze.Optional):Gw(e,i,t&ze.Optional)}finally{Hi(s)}}return TM(i,0,t)}function RM(n,e,t,i=ze.Default,r){if(null!==n){if(1024&e[Ze]){const o=function dk(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&1024&o[Ze]&&!(256&o[Ze]);){const a=PM(s,o,t,i|ze.Self,Nr);if(a!==Nr)return a;let l=s.parent;if(!l){const c=o[Zw];if(c){const u=c.get(t,Nr,i);if(u!==Nr)return u}l=LM(o),o=o[Ua]}s=l}return r}(n,e,t,i,Nr);if(o!==Nr)return o}const s=PM(n,e,t,i,Nr);if(s!==Nr)return s}return IM(e,t,i,r)}function PM(n,e,t,i,r){const s=function ck(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Fc)?n[Fc]:void 0;return"number"==typeof e?e>=0?e&CM:uk:e}(t);if("function"==typeof s){if(!mM(e,n,i))return i&ze.Host?TM(r,0,i):IM(e,t,i,r);try{const o=s(i);if(null!=o||i&ze.Optional)return o;lh()}finally{vM()}}else if("number"==typeof s){let o=null,a=AM(n,e),l=Wa,c=i&ze.Host?e[$n][Wn]:null;for((-1===a||i&ze.SkipSelf)&&(l=-1===a?Ug(n,e):e[a+8],l!==Wa&&OM(i,!1)?(o=e[Me],a=Eh(l),e=Ch(l,e)):a=-1);-1!==a;){const u=e[Me];if(FM(s,a,u.data)){const d=lk(a,e,t,o,i,c);if(d!==Nr)return d}l=e[a+8],l!==Wa&&OM(i,e[Me].data[a+8]===c)&&FM(s,a,e)?(o=u,a=Eh(l),e=Ch(l,e)):a=-1}}return r}function lk(n,e,t,i,r,s){const o=e[Me],a=o.data[n+8],u=Th(a,o,t,null==i?Bc(a)&&Bg:i!=o&&0!=(3&a.type),r&ze.Host&&s===a);return null!==u?To(e,o,u,a):Nr}function Th(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,h=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<h;f++){const p=o[f];if(f<l&&t===p||f>=l&&p.type===t)return f}if(r){const f=o[l];if(f&&ur(f)&&f.type===t)return l}return null}function To(n,e,t,i){let r=n[t];const s=e.data;if(function tk(n){return n instanceof Uc}(r)){const o=r;o.resolving&&function sN(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new se(-200,`Circular dependency in DI detected for ${n}${t}`)}(function Mt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():je(n)}(s[t]));const a=Dh(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Hi(o.injectImpl):null;mM(n,i,ze.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function QN(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=tM(e);(t.preOrderHooks??(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks??(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks??(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks??(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks??(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&Hi(l),Dh(a),o.resolving=!1,vM()}}return r}function FM(n,e,t){return!!(t[e+(n>>DM)]&1<<n)}function OM(n,e){return!(n&ze.Self||n&ze.Host&&e)}class $a{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return RM(this._tNode,this._lView,e,hh(i),t)}}function uk(){return new $a(Vn(),re())}function nn(n){return Zr(()=>{const e=n.prototype.constructor,t=e[Qr]||Hg(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Qr]||Hg(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Hg(n){return pg(n)?()=>{const e=Hg(Ne(n));return e&&e()}:Eo(n)}function LM(n){const e=n[Me],t=e.type;return 2===t?e.declTNode:1===t?n[Wn]:null}const Xa="__parameters__";function Ka(n,e,t){return Zr(()=>{const i=function Gg(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const d=l.hasOwnProperty(Xa)?l[Xa]:Object.defineProperty(l,Xa,{value:[]})[Xa];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class he{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Ce({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Io(n,e){n.forEach(t=>Array.isArray(t)?Io(t,e):e(t))}function kM(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Ih(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Wc(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function Di(n,e,t){let i=Za(n,e);return i>=0?n[1|i]=t:(i=~i,function mk(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function Wg(n,e){const t=Za(n,e);if(t>=0)return n[1|t]}function Za(n,e){return function BM(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const Ph=Pc(Ka("Inject",n=>({token:n})),-1),ks=Pc(Ka("Optional"),8),$c=Pc(Ka("SkipSelf"),4);var gi=(()=>((gi=gi||{})[gi.Important=1]="Important",gi[gi.DashCase=2]="DashCase",gi))();const Kg=new Map;let kk=0;function ZM(n){return Kg.get(n)||null}class zk{get lView(){return ZM(this.lViewId)}constructor(e,t,i){this.lViewId=e,this.nodeIndex=t,this.native=i}}function _i(n){let e=Yc(n);if(e){if(Ei(e)){const t=e;let i,r,s;if(eS(n)){if(i=function nS(n,e){const t=n[Me].components;if(t)for(let i=0;i<t.length;i++){const r=t[i];if(mi(r,n)[an]===e)return r}else if(mi(Wt,n)[an]===e)return Wt;return-1}(t,n),-1==i)throw new Error("The provided component was not found in the application");r=n}else if(function Hk(n){return n&&n.constructor&&n.constructor.\u0275dir}(n)){if(i=function jk(n,e){let t=n[Me].firstChild;for(;t;){const r=t.directiveEnd;for(let s=t.directiveStart;s<r;s++)if(n[s]===e)return t.index;t=Gk(t)}return-1}(t,n),-1==i)throw new Error("The provided directive was not found in the application");s=function iS(n,e){const t=e[Me].data[n];if(0===t.directiveStart)return bt;const i=[];for(let r=t.directiveStart;r<t.directiveEnd;r++){const s=e[r];eS(s)||i.push(s)}return i}(i,t)}else if(i=tS(t,n),-1==i)return null;const o=Bn(t[i]),a=Yc(o),l=a&&!Array.isArray(a)?a:Zg(t,i,o);if(r&&void 0===l.component&&(l.component=r,qn(l.component,l)),s&&void 0===l.directives){l.directives=s;for(let c=0;c<s.length;c++)qn(s[c],l)}qn(l.native,l),e=l}}else{const t=n;let i=t;for(;i=i.parentNode;){const r=Yc(i);if(r){const s=Array.isArray(r)?r:r.lView;if(!s)return null;const o=tS(s,t);if(o>=0){const a=Bn(s[o]),l=Zg(s,o,a);qn(a,l),e=l;break}}}}return e||null}function Zg(n,e,t){return new zk(n[kc],e,t)}const Jg="__ngContext__";function qn(n,e){Ei(e)?(n[Jg]=e[kc],function Vk(n){Kg.set(n[kc],n)}(e)):n[Jg]=e}function Yc(n){const e=n[Jg];return"number"==typeof e?ZM(e):e||null}function eS(n){return n&&n.constructor&&n.constructor.\u0275cmp}function tS(n,e){const t=n[Me];for(let i=Wt;i<t.bindingStartIndex;i++)if(Bn(n[i])===e)return i;return-1}function Gk(n){if(n.child)return n.child;if(n.next)return n.next;for(;n.parent&&!n.parent.next;)n=n.parent;return n.parent&&n.parent.next}let Qg;function e_(n,e){return Qg(n,e)}function Kc(n){const e=n[tn];return cr(e)?e[tn]:e}function t_(n){return rS(n[Lc])}function n_(n){return rS(n[lr])}function rS(n){for(;null!==n&&!cr(n);)n=n[lr];return n}function Qa(n,e,t,i,r){if(null!=i){let s,o=!1;cr(i)?s=i:Ei(i)&&(o=!0,i=i[es]);const a=Bn(i);0===n&&null!==t?null==r?uS(e,t,a):Ro(e,t,a,r||null,!0):1===n&&null!==t?Ro(e,t,a,r||null,!0):2===n?function c_(n,e,t){const i=Lh(n,e);i&&function o2(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function c2(n,e,t,i,r){const s=t[_h];s!==Bn(t)&&Qa(e,n,i,s,r);for(let a=ii;a<t.length;a++){const l=t[a];Zc(l[Me],l,n,e,i,s)}}(e,n,s,t,r)}}function r_(n,e,t){return n.createElement(e,t)}function oS(n,e){const t=n[Ha],i=t.indexOf(e),r=e[tn];512&e[Ze]&&(e[Ze]&=-513,Cg(r,-1)),t.splice(i,1)}function s_(n,e){if(n.length<=ii)return;const t=ii+e,i=n[t];if(i){const r=i[Nc];null!==r&&r!==n&&oS(r,i),e>0&&(n[t-1][lr]=i[lr]);const s=Ih(n,ii+e);!function Zk(n,e){Zc(n,e,e[Qe],2,null,null),e[es]=null,e[Wn]=null}(i[Me],i);const o=s[Fr];null!==o&&o.detachView(s[Me]),i[tn]=null,i[lr]=null,i[Ze]&=-65}return i}function aS(n,e){if(!(128&e[Ze])){const t=e[Qe];t.destroyNode&&Zc(n,e,t,3,null,null),function e2(n){let e=n[Lc];if(!e)return o_(n[Me],n);for(;e;){let t=null;if(Ei(e))t=e[Lc];else{const i=e[ii];i&&(t=i)}if(!t){for(;e&&!e[lr]&&e!==n;)Ei(e)&&o_(e[Me],e),e=e[tn];null===e&&(e=n),Ei(e)&&o_(e[Me],e),t=e&&e[lr]}e=t}}(e)}}function o_(n,e){if(!(128&e[Ze])){e[Ze]&=-65,e[Ze]|=128,function s2(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Uc)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];ji(4,a,l);try{l.call(a)}finally{ji(5,a,l)}}else{ji(4,r,s);try{s.call(r)}finally{ji(5,r,s)}}}}}(n,e),function r2(n,e){const t=n.cleanup,i=e[Va];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[r=o]():i[r=-o].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)(0,i[s])();e[Va]=null}}(n,e),1===e[Me].type&&e[Qe].destroy();const t=e[Nc];if(null!==t&&cr(e[tn])){t!==e[tn]&&oS(t,e);const i=e[Fr];null!==i&&i.detachView(n)}!function Uk(n){Kg.delete(n[kc])}(e)}}function lS(n,e,t){return function cS(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[es];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===ar.None||s===ar.Emulated)return null}return Ci(i,t)}}(n,e.parent,t)}function Ro(n,e,t,i,r){n.insertBefore(e,t,i,r)}function uS(n,e,t){n.appendChild(e,t)}function dS(n,e,t,i,r){null!==i?Ro(n,e,t,i,r):uS(n,e,t)}function Lh(n,e){return n.parentNode(e)}function hS(n,e,t){return pS(n,e,t)}let a_,Bh,h_,pS=function fS(n,e,t){return 40&n.type?Ci(n,t):null};function Nh(n,e,t,i){const r=lS(n,i,e),s=e[Qe],a=hS(i.parent||e[Wn],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)dS(s,r,t[l],a,!1);else dS(s,r,t,a,!1);void 0!==a_&&a_(s,i,e,t,r)}function kh(n,e){if(null!==e){const t=e.type;if(3&t)return Ci(e,n);if(4&t)return l_(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return kh(n,i);{const r=n[e.index];return cr(r)?l_(-1,r):Bn(r)}}if(32&t)return e_(e,n)()||Bn(n[e.index]);{const i=gS(n,e);return null!==i?Array.isArray(i)?i[0]:kh(Kc(n[$n]),i):kh(n,e.next)}}return null}function gS(n,e){return null!==e?n[$n][Wn].projection[e.projection]:null}function l_(n,e){const t=ii+n+1;if(t<e.length){const i=e[t],r=i[Me].firstChild;if(null!==r)return kh(i,r)}return e[_h]}function u_(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&qn(Bn(a),i),t.flags|=2),32!=(32&t.flags))if(8&l)u_(n,e,t.child,i,r,s,!1),Qa(e,n,r,a,s);else if(32&l){const c=e_(t,i);let u;for(;u=c();)Qa(e,n,r,u,s);Qa(e,n,r,a,s)}else 16&l?_S(n,e,i,t,r,s):Qa(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Zc(n,e,t,i,r,s){u_(t,i,n.firstChild,e,r,s,!1)}function _S(n,e,t,i,r,s){const o=t[$n],l=o[Wn].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Qa(e,n,r,l[c],s);else u_(n,e,l,o[tn],r,s,!0)}function yS(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function vS(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&kg(n,e,i),null!==r&&yS(n,e,r),null!==s&&function d2(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}function el(n){return function d_(){if(void 0===Bh&&(Bh=null,jt.trustedTypes))try{Bh=jt.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Bh}()?.createHTML(n)||n}class Po{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${oh})`}}class g2 extends Po{getTypeName(){return"HTML"}}class _2 extends Po{getTypeName(){return"Style"}}class y2 extends Po{getTypeName(){return"Script"}}class v2 extends Po{getTypeName(){return"URL"}}class b2 extends Po{getTypeName(){return"ResourceURL"}}function Ai(n){return n instanceof Po?n.changingThisBreaksApplicationSecurity:n}function kr(n,e){const t=function x2(n){return n instanceof Po&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${oh})`)}return t===e}class D2{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(el(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class A2{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=el(e),t}}const I2=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Uh(n){return(n=String(n)).match(I2)?n:"unsafe:"+n}function is(n){const e={};for(const t of n.split(","))e[t]=!0;return e}function Jc(...n){const e={};for(const t of n)for(const i in t)t.hasOwnProperty(i)&&(e[i]=!0);return e}const ES=is("area,br,col,hr,img,wbr"),CS=is("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),DS=is("rp,rt"),p_=Jc(ES,Jc(CS,is("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Jc(DS,is("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Jc(DS,CS)),m_=is("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),AS=Jc(m_,is("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),is("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),R2=is("script,style,template");class P2{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!p_.hasOwnProperty(t))return this.sanitizedSomething=!0,!R2.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=e.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),o=s.name,a=o.toLowerCase();if(!AS.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;m_[a]&&(l=Uh(l)),this.buf.push(" ",o,'="',TS(l),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();p_.hasOwnProperty(t)&&!ES.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(TS(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const F2=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,O2=/([^\#-~ |!])/g;function TS(n){return n.replace(/&/g,"&amp;").replace(F2,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(O2,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let zh;function IS(n,e){let t=null;try{zh=zh||function SS(n){const e=new A2(n);return function T2(){try{return!!(new window.DOMParser).parseFromString(el(""),"text/html")}catch{return!1}}()?new D2(e):e}(n);let i=e?String(e):"";t=zh.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=t.innerHTML,t=zh.getInertBodyElement(i)}while(i!==s);return el((new P2).sanitizeChildren(g_(t)||t))}finally{if(t){const i=g_(t)||t;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function g_(n){return"content"in n&&function L2(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var xt=(()=>((xt=xt||{})[xt.NONE=0]="NONE",xt[xt.HTML=1]="HTML",xt[xt.STYLE=2]="STYLE",xt[xt.SCRIPT=3]="SCRIPT",xt[xt.URL=4]="URL",xt[xt.RESOURCE_URL=5]="RESOURCE_URL",xt))();const FS=new he("ENVIRONMENT_INITIALIZER"),OS=new he("INJECTOR",-1),LS=new he("INJECTOR_DEF_TYPES");class NS{get(e,t=Ic){if(t===Ic){const i=new Error(`NullInjectorError: No provider for ${zt(e)}!`);throw i.name="NullInjectorError",i}return t}}function j2(...n){return{\u0275providers:kS(0,n),\u0275fromNgModule:!0}}function kS(n,...e){const t=[],i=new Set;let r;return Io(e,s=>{const o=s;__(o,t,[],i)&&(r||(r=[]),r.push(o))}),void 0!==r&&BS(r,t),t}function BS(n,e){for(let t=0;t<n.length;t++){const{providers:r}=n[t];y_(r,s=>{e.push(s)})}}function __(n,e,t,i){if(!(n=Ne(n)))return!1;let r=null,s=zw(n);const o=!s&&Et(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const l=n.ngModule;if(s=zw(l),!s)return!1;r=l}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)__(c,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;i.add(r);try{Io(s.imports,u=>{__(u,e,t,i)&&(c||(c=[]),c.push(u))})}finally{}void 0!==c&&BS(c,e)}if(!a){const c=Eo(r)||(()=>new r);e.push({provide:r,useFactory:c,deps:bt},{provide:LS,useValue:r,multi:!0},{provide:FS,useValue:()=>ie(r),multi:!0})}const l=s.providers;null==l||a||y_(l,u=>{e.push(u)})}}return r!==n&&void 0!==n.providers}function y_(n,e){for(let t of n)mg(t)&&(t=t.\u0275providers),Array.isArray(t)?y_(t,e):e(t)}const W2=kt({provide:String,useValue:kt});function v_(n){return null!==n&&"object"==typeof n&&W2 in n}function Fo(n){return"function"==typeof n}const b_=new he("Set Injector scope."),Hh={},q2={};let x_;function Gh(){return void 0===x_&&(x_=new NS),x_}class Oo{}class zS extends Oo{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,M_(e,o=>this.processProvider(o)),this.records.set(OS,tl(void 0,this)),r.has("environment")&&this.records.set(Oo,tl(void 0,this));const s=this.records.get(b_);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(LS.multi,bt,ze.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}runInContext(e){this.assertNotDestroyed();const t=Ba(this),i=Hi(void 0);try{return e()}finally{Ba(t),Hi(i)}}get(e,t=Ic,i=ze.Default){this.assertNotDestroyed(),i=hh(i);const r=Ba(this),s=Hi(void 0);try{if(!(i&ze.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function J2(n){return"function"==typeof n||"object"==typeof n&&n instanceof he}(e)&&ch(e);a=l&&this.injectableDefInScope(l)?tl(w_(e),Hh):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&ze.Self?Gh():this.parent).get(e,t=i&ze.Optional&&t===Ic?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[dh]=o[dh]||[]).unshift(zt(e)),r)throw o;return function vN(n,e,t,i){const r=n[dh];throw e[jw]&&r.unshift(e[jw]),n.message=function bN(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&n.charAt(1)==gN?n.slice(2):n;let r=zt(e);if(Array.isArray(e))r=e.map(zt).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):zt(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(mN,"\n  ")}`}("\n"+n.message,r,t,i),n[pN]=r,n[dh]=null,n}(o,e,"R3InjectorError",this.source)}throw o}finally{Hi(s),Ba(r)}}resolveInjectorInitializers(){const e=Ba(this),t=Hi(void 0);try{const i=this.get(FS.multi,bt,ze.Self);for(const r of i)r()}finally{Ba(e),Hi(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(zt(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new se(205,!1)}processProvider(e){let t=Fo(e=Ne(e))?e:Ne(e&&e.provide);const i=function Y2(n){return v_(n)?tl(void 0,n.useValue):tl(HS(n),Hh)}(e);if(Fo(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=tl(void 0,Hh,!0),r.factory=()=>vg(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===Hh&&(t.value=q2,t.value=t.factory()),"object"==typeof t.value&&t.value&&function Z2(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Ne(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}}function w_(n){const e=ch(n),t=null!==e?e.factory:Eo(n);if(null!==t)return t;if(n instanceof he)throw new se(204,!1);if(n instanceof Function)return function X2(n){const e=n.length;if(e>0)throw Wc(e,"?"),new se(204,!1);const t=function uN(n){const e=n&&(n[uh]||n[Hw]);return e?(function dN(n){if(n.hasOwnProperty("name"))return n.name;(""+n).match(/^function\s*([^\s(]+)/)}(n),e):null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new se(204,!1)}function HS(n,e,t){let i;if(Fo(n)){const r=Ne(n);return Eo(r)||w_(r)}if(v_(n))i=()=>Ne(n.useValue);else if(function US(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...vg(n.deps||[]));else if(function VS(n){return!(!n||!n.useExisting)}(n))i=()=>ie(Ne(n.useExisting));else{const r=Ne(n&&(n.useClass||n.provide));if(!function K2(n){return!!n.deps}(n))return Eo(r)||w_(r);i=()=>new r(...vg(n.deps))}return i}function tl(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function M_(n,e){for(const t of n)Array.isArray(t)?M_(t,e):t&&mg(t)?M_(t.\u0275providers,e):e(t)}class Q2{}class GS{}class t3{resolveComponentFactory(e){throw function e3(n){const e=Error(`No component factory found for ${zt(n)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=n,e}(e)}}let eu=(()=>{class n{}return n.NULL=new t3,n})();function n3(){return nl(Vn(),re())}function nl(n,e){return new Tt(Ci(n,e))}let Tt=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=n3,n})();function r3(n){return n instanceof Tt?n.nativeElement:n}class Lo{}let No=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function s3(){const n=re(),t=mi(Vn().index,n);return(Ei(t)?t:n)[Qe]}(),n})(),o3=(()=>{class n{}return n.\u0275prov=Ce({token:n,providedIn:"root",factory:()=>null}),n})();class il{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const a3=new il("15.2.7"),S_={},E_="ngOriginalError";function C_(n){return n[E_]}class rs{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&C_(e);for(;t&&C_(t);)t=C_(t);return t||null}}function $S(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const qS="ng-template";function y3(n,e,t){let i=0,r=!0;for(;i<n.length;){let s=n[i++];if("string"==typeof s&&r){const o=n[i++];if(t&&"class"===s&&-1!==$S(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;i<n.length&&"string"==typeof(s=n[i++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function XS(n){return 4===n.type&&n.value!==qS}function v3(n,e,t){return e===(4!==n.type||t?n.value:qS)}function b3(n,e,t){let i=4;const r=n.attrs||[],s=function M3(n){for(let e=0;e<n.length;e++)if(wM(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!v3(n,l,t)||""===l&&1===e.length){if(dr(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!y3(n.attrs,c,t)){if(dr(i))return!1;o=!0}continue}const d=x3(8&i?"class":l,r,XS(n),t);if(-1===d){if(dr(i))return!1;o=!0;continue}if(""!==c){let h;h=d>s?"":r[d+1].toLowerCase();const f=8&i?h:null;if(f&&-1!==$S(f,c,0)||2&i&&c!==h){if(dr(i))return!1;o=!0}}}}else{if(!o&&!dr(i)&&!dr(l))return!1;if(o&&dr(l))continue;o=!1,i=l|1&i}}return dr(i)||o}function dr(n){return 0==(1&n)}function x3(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function S3(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function YS(n,e,t=!1){for(let i=0;i<e.length;i++)if(b3(n,e[i],t))return!0;return!1}function E3(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function KS(n,e){return n?":not("+e.trim()+")":e}function C3(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!dr(o)&&(e+=KS(s,r),r=""),i=o,s=s||!dr(i);t++}return""!==r&&(e+=KS(s,r)),e}const $e={};function yi(n){ZS(lt(),re(),si()+n,!1)}function ZS(n,e,t,i){if(!i)if(3==(3&e[Ze])){const s=n.preOrderCheckHooks;null!==s&&Mh(e,s,t)}else{const s=n.preOrderHooks;null!==s&&Sh(e,s,0,t)}Ao(t)}function tE(n,e=null,t=null,i){const r=nE(n,e,t,i);return r.resolveInjectorInitializers(),r}function nE(n,e=null,t=null,i,r=new Set){const s=[t||bt,j2(n)];return i=i||("object"==typeof n?void 0:zt(n)),new zS(s,e||Gh(),i||null,r)}let hr=(()=>{class n{static create(t,i){if(Array.isArray(t))return tE({name:""},i,t,"");{const r=t.name??"";return tE({name:r},t.parent,t.providers,r)}}}return n.THROW_IF_NOT_FOUND=Ic,n.NULL=new NS,n.\u0275prov=Ce({token:n,providedIn:"any",factory:()=>ie(OS)}),n.__NG_ELEMENT_ID__=-1,n})();function U(n,e=ze.Default){const t=re();return null===t?ie(n,e):RM(Vn(),t,Ne(n),e)}function cE(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const s=t[i+1];if(-1!==s){const o=n.data[s];Rg(t[i]),o.contentQueries(2,e[s],s)}}}function Wh(n,e,t,i,r,s,o,a,l,c,u){const d=e.blueprint.slice();return d[es]=r,d[Ze]=76|i,(null!==u||n&&1024&n[Ze])&&(d[Ze]|=1024),aM(d),d[tn]=d[Ua]=n,d[an]=t,d[gh]=o||n&&n[gh],d[Qe]=a||n&&n[Qe],d[wg]=l||n&&n[wg]||null,d[mh]=c||n&&n[mh]||null,d[Wn]=s,d[kc]=function Bk(){return kk++}(),d[Zw]=u,d[$n]=2==e.type?n[$n]:d,d}function ol(n,e,t,i,r){let s=n.data[e];if(null===s)s=function P_(n,e,t,i,r){const s=uM(),o=Dg(),l=n.data[e]=function J3(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l,l.prev=s)),l}(n,e,t,i,r),function jN(){return We.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function Vc(){const n=We.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Lr(s,!0),s}function tu(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function F_(n,e,t){Pg(e);try{const i=n.viewQuery;null!==i&&H_(1,i,t);const r=n.template;null!==r&&uE(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&cE(n,e),n.staticViewQueries&&H_(2,n.viewQuery,t);const s=n.components;null!==s&&function Y3(n,e){for(let t=0;t<e.length;t++)yB(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[Ze]&=-5,Fg()}}function $h(n,e,t,i){const r=e[Ze];if(128!=(128&r)){Pg(e);try{aM(e),function hM(n){return We.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&uE(n,e,t,2,i);const o=3==(3&r);if(o){const c=n.preOrderCheckHooks;null!==c&&Mh(e,c,null)}else{const c=n.preOrderHooks;null!==c&&Sh(e,c,0,null),Lg(e,0)}if(function gB(n){for(let e=t_(n);null!==e;e=n_(e)){if(!e[Jw])continue;const t=e[Ha];for(let i=0;i<t.length;i++){const r=t[i];512&r[Ze]||Cg(r[tn],1),r[Ze]|=512}}}(e),function mB(n){for(let e=t_(n);null!==e;e=n_(e))for(let t=ii;t<e.length;t++){const i=e[t],r=i[Me];xh(i)&&$h(r,i,r.template,i[an])}}(e),null!==n.contentQueries&&cE(n,e),o){const c=n.contentCheckHooks;null!==c&&Mh(e,c)}else{const c=n.contentHooks;null!==c&&Sh(e,c,1),Lg(e,1)}!function q3(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)Ao(~r);else{const s=r,o=t[++i],a=t[++i];WN(o,s),a(2,e[s])}}}finally{Ao(-1)}}(n,e);const a=n.components;null!==a&&function X3(n,e){for(let t=0;t<e.length;t++)_B(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&H_(2,l,i),o){const c=n.viewCheckHooks;null!==c&&Mh(e,c)}else{const c=n.viewHooks;null!==c&&Sh(e,c,2),Lg(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[Ze]&=-41,512&e[Ze]&&(e[Ze]&=-513,Cg(e[tn],-1))}finally{Fg()}}}function uE(n,e,t,i,r){const s=si(),o=2&i;try{Ao(-1),o&&e.length>Wt&&ZS(n,e,Wt,!1),ji(o?2:0,r),t(i,r)}finally{Ao(s),ji(o?3:1,r)}}function O_(n,e,t){if(Sg(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}function L_(n,e,t){cM()&&(function sB(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;Bc(t)&&function hB(n,e,t){const i=Ci(e,n),r=dE(t),s=n[gh],o=qh(n,Wh(n,r,null,t.onPush?32:16,i,e,s,s.createRenderer(i,t),null,null,null));n[e.index]=o}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||Ah(t,e),qn(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=To(e,n,a,t);qn(c,e),null!==o&&fB(0,a-r,c,l,0,o),ur(l)&&(mi(t.index,e)[an]=To(e,n,a,t))}}(n,e,t,Ci(t,e)),64==(64&t.flags)&&gE(n,e,t))}function N_(n,e,t=Ci){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function dE(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=k_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function k_(n,e,t,i,r,s,o,a,l,c){const u=Wt+i,d=u+r,h=function K3(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:$e);return t}(u,d),f="function"==typeof c?c():c;return h[Me]={type:n,blueprint:h,template:t,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function hE(n,e,t,i){const r=yE(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&vE(n).push(i,r.length-1))}function fE(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?pE(t,e,r,s):i.hasOwnProperty(r)&&pE(t,e,i[r],s)}return t}function pE(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function B_(n,e,t,i){if(cM()){const r=null===i?null:{"":-1},s=function aB(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(YS(e,o.selectors,!1))if(i||(i=[]),ur(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),V_(n,e,a.length)}else i.unshift(o),V_(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&mE(n,e,t,o,r,a),r&&function lB(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new se(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=zc(t.mergedAttrs,t.attrs)}function mE(n,e,t,i,r,s){for(let c=0;c<i.length;c++)zg(Ah(t,e),n,i[c].type);!function uB(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let c=0;c<i.length;c++){const u=i[c];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,l=tu(n,e,i.length,null);for(let c=0;c<i.length;c++){const u=i[c];t.mergedAttrs=zc(t.mergedAttrs,u.hostAttrs),dB(n,t,e,l,u),cB(l,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((n.preOrderHooks??(n.preOrderHooks=[])).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((n.preOrderCheckHooks??(n.preOrderCheckHooks=[])).push(t.index),a=!0),l++}!function Q3(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let l=null,c=null;for(let u=e.directiveStart;u<r;u++){const d=s[u],h=t?t.get(d):null,p=h?h.outputs:null;l=fE(d.inputs,u,l,h?h.inputs:null),c=fE(d.outputs,u,c,p);const m=null===l||null===o||XS(e)?null:pB(l,u,o);a.push(m)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}(n,t,s)}function gE(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function $N(){return We.lFrame.currentDirectiveIndex}();try{Ao(s);for(let a=i;a<r;a++){const l=n.data[a],c=e[a];Tg(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&oB(l,c)}}finally{Ao(-1),Tg(o)}}function oB(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function V_(n,e,t){e.componentOffset=t,(n.components??(n.components=[])).push(e.index)}function cB(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;ur(e)&&(t[""]=n)}}function dB(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=Eo(r.type)),o=new Uc(s,ur(r),U);n.blueprint[i]=o,t[i]=o,function iB(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function rB(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,tu(n,t,r.hostVars,$e),r)}function Br(n,e,t,i,r,s){const o=Ci(n,e);!function U_(n,e,t,i,r,s,o){if(null==s)n.removeAttribute(e,r,t);else{const a=null==o?je(s):o(s,i||"",r);n.setAttribute(e,r,a,t)}}(e[Qe],o,s,n.value,t,i,r)}function fB(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],d=o[l++];null!==a?i.setInput(t,d,c,u):t[u]=d}}}function pB(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){i.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function _E(n,e,t,i){return[n,!0,!1,e,null,0,i,t,null,null]}function _B(n,e){const t=mi(e,n);if(xh(t)){const i=t[Me];48&t[Ze]?$h(i,t,i.template,t[an]):t[So]>0&&z_(t)}}function z_(n){for(let i=t_(n);null!==i;i=n_(i))for(let r=ii;r<i.length;r++){const s=i[r];if(xh(s))if(512&s[Ze]){const o=s[Me];$h(o,s,o.template,s[an])}else s[So]>0&&z_(s)}const t=n[Me].components;if(null!==t)for(let i=0;i<t.length;i++){const r=mi(t[i],n);xh(r)&&r[So]>0&&z_(r)}}function yB(n,e){const t=mi(e,n),i=t[Me];(function vB(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),F_(i,t,t[an])}function qh(n,e){return n[Lc]?n[Kw][lr]=e:n[Lc]=e,n[Kw]=e,e}function Xh(n){for(;n;){n[Ze]|=32;const e=Kc(n);if(CN(n)&&!e)return n;n=e}return null}function Yh(n,e,t,i=!0){const r=e[gh];r.begin&&r.begin();try{$h(n,e,n.template,t)}catch(o){throw i&&xE(e,o),o}finally{r.end&&r.end()}}function H_(n,e,t){Rg(0),e(n,t)}function yE(n){return n[Va]||(n[Va]=[])}function vE(n){return n.cleanup||(n.cleanup=[])}function xE(n,e){const t=n[mh],i=t?t.get(rs,null):null;i&&i.handleError(e)}function G_(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=n.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function Kh(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=fg(r,a):2==s&&(i=fg(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function Zh(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(Bn(s)),cr(s))for(let a=ii;a<s.length;a++){const l=s[a],c=l[Me].firstChild;null!==c&&Zh(l[Me],l,c,i)}const o=t.type;if(8&o)Zh(n,e,t.child,i);else if(32&o){const a=e_(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=gS(e,t);if(Array.isArray(a))i.push(...a);else{const l=Kc(e[$n]);Zh(l[Me],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class nu{get rootNodes(){const e=this._lView,t=e[Me];return Zh(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[an]}set context(e){this._lView[an]=e}get destroyed(){return 128==(128&this._lView[Ze])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[tn];if(cr(e)){const t=e[yh],i=t?t.indexOf(this):-1;i>-1&&(s_(e,i),Ih(t,i))}this._attachedToViewContainer=!1}aS(this._lView[Me],this._lView)}onDestroy(e){hE(this._lView[Me],this._lView,null,e)}markForCheck(){Xh(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ze]&=-65}reattach(){this._lView[Ze]|=64}detectChanges(){Yh(this._lView[Me],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new se(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Qk(n,e){Zc(n,e,e[Qe],2,null,null)}(this._lView[Me],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new se(902,!1);this._appRef=e}}class bB extends nu{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Yh(e[Me],e,e[an],!1)}checkNoChanges(){}get context(){return null}}class wE extends eu{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Et(e);return new iu(t,this.ngModule)}}function ME(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class wB{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=hh(i);const r=this.injector.get(e,S_,i);return r!==S_||t===S_?r:this.parentInjector.get(e,t,i)}}class iu extends GS{get inputs(){return ME(this.componentDef.inputs)}get outputs(){return ME(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function D3(n){return n.map(C3).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof Oo?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new wB(e,s):e,a=o.get(Lo,null);if(null===a)throw new se(407,!1);const l=o.get(o3,null),c=a.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",d=i?function Z3(n,e,t){return n.selectRootElement(e,t===ar.ShadowDom)}(c,i,this.componentDef.encapsulation):r_(c,u,function xB(n){const e=n.toLowerCase();return"svg"===e?rM:"math"===e?"math":null}(u)),h=this.componentDef.onPush?288:272,f=k_(0,null,null,1,0,null,null,null,null,null),p=Wh(null,f,null,h,null,null,a,c,l,o,null);let m,g;Pg(p);try{const y=this.componentDef;let v,_=null;y.findHostDirectiveDefs?(v=[],_=new Map,y.findHostDirectiveDefs(y,v,_),v.push(y)):v=[y];const b=function SB(n,e){const t=n[Me],i=Wt;return n[i]=e,ol(t,i,2,"#host",null)}(p,d),w=function EB(n,e,t,i,r,s,o,a){const l=r[Me];!function CB(n,e,t,i){for(const r of n)e.mergedAttrs=zc(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(Kh(e,e.mergedAttrs,!0),null!==t&&vS(i,t,e))}(i,n,e,o);const c=s.createRenderer(e,t),u=Wh(r,dE(t),null,t.onPush?32:16,r[n.index],n,s,c,a||null,null,null);return l.firstCreatePass&&V_(l,n,i.length-1),qh(r,u),r[n.index]=u}(b,d,y,v,p,a,c);g=oM(f,Wt),d&&function AB(n,e,t,i){if(i)kg(n,t,["ng-version",a3.full]);else{const{attrs:r,classes:s}=function A3(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!dr(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&kg(n,t,r),s&&s.length>0&&yS(n,t,s.join(" "))}}(c,y,d,i),void 0!==t&&function TB(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(g,this.ngContentSelectors,t),m=function DB(n,e,t,i,r,s){const o=Vn(),a=r[Me],l=Ci(o,r);mE(a,r,o,t,null,i);for(let u=0;u<t.length;u++)qn(To(r,a,o.directiveStart+u,o),r);gE(a,r,o),l&&qn(l,r);const c=To(r,a,o.directiveStart+o.componentOffset,o);if(n[an]=r[an]=c,null!==s)for(const u of s)u(c,e);return O_(a,o,n),c}(w,y,v,_,p,[IB]),F_(f,p,null)}finally{Fg()}return new MB(this.componentType,m,nl(g,p),p,g)}}class MB extends Q2{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new bB(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){const s=this._rootLView;G_(s[Me],s,r,e,t),Xh(mi(this._tNode.index,s))}}get injector(){return new $a(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function IB(){const n=Vn();wh(re()[Me],n)}function Xe(n){let e=function SE(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(ur(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new se(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=j_(n.inputs),o.declaredInputs=j_(n.declaredInputs),o.outputs=j_(n.outputs);const a=r.hostBindings;a&&OB(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&PB(n,l),c&&FB(n,c),hg(n.inputs,r.inputs),hg(n.declaredInputs,r.declaredInputs),hg(n.outputs,r.outputs),ur(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===Xe&&(t=!1)}}e=Object.getPrototypeOf(e)}!function RB(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=zc(r.hostAttrs,t=zc(t,r.hostAttrs))}}(i)}function j_(n){return n===Jr?{}:n===bt?[]:n}function PB(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function FB(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function OB(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}function Jh(n){return!!W_(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function W_(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Xn(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Pn(n,e,t,i){const r=re();return Xn(r,ja(),e)&&(lt(),Br(Kt(),r,n,e,t,i)),Pn}function su(n,e,t,i,r,s,o,a){const l=re(),c=lt(),u=n+Wt,d=c.firstCreatePass?function jB(n,e,t,i,r,s,o,a,l){const c=e.consts,u=ol(e,n,4,o||null,Ns(c,a));B_(e,t,u,Ns(c,l)),wh(e,u);const d=u.tView=k_(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,i,r,s,o):c.data[u];Lr(d,!1);const h=l[Qe].createComment("");Nh(c,l,h,d),qn(h,l),qh(l,l[u]=_E(h,l,h,d)),vh(d)&&L_(c,l,d),null!=o&&N_(l,d,a)}function fn(n,e,t){const i=re();return Xn(i,ja(),e)&&function Ti(n,e,t,i,r,s,o,a){const l=Ci(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(G_(n,t,u,i,r),Bc(e)&&function tB(n,e){const t=mi(e,n);16&t[Ze]||(t[Ze]|=32)}(t,e.index)):3&e.type&&(i=function eB(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(l,i,r))}(lt(),Kt(),i,n,e,i[Qe],t,!1),fn}function q_(n,e,t,i,r){const o=r?"class":"style";G_(n,t,e.inputs[o],o,i)}function pt(n,e,t,i){const r=re(),s=lt(),o=Wt+n,a=r[Qe],l=s.firstCreatePass?function $B(n,e,t,i,r,s){const o=e.consts,l=ol(e,n,2,i,Ns(o,r));return B_(e,t,l,Ns(o,s)),null!==l.attrs&&Kh(l,l.attrs,!1),null!==l.mergedAttrs&&Kh(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,r,e,t,i):s.data[o],c=r[o]=r_(a,e,function JN(){return We.lFrame.currentNamespace}()),u=vh(l);return Lr(l,!0),vS(a,c,l),32!=(32&l.flags)&&Nh(s,r,c,l),0===function BN(){return We.lFrame.elementDepthCount}()&&qn(c,r),function VN(){We.lFrame.elementDepthCount++}(),u&&(L_(s,r,l),O_(s,l,r)),null!==i&&N_(r,l),pt}function Ot(){let n=Vn();Dg()?Ag():(n=n.parent,Lr(n,!1));const e=n;!function UN(){We.lFrame.elementDepthCount--}();const t=lt();return t.firstCreatePass&&(wh(t,n),Sg(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function nk(n){return 0!=(8&n.flags)}(e)&&q_(t,e,re(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function ik(n){return 0!=(16&n.flags)}(e)&&q_(t,e,re(),e.stylesWithoutHost,!1),Ot}function Yn(n,e,t,i){return pt(n,e,t,i),Ot(),Yn}function ef(n,e,t){const i=re(),r=lt(),s=n+Wt,o=r.firstCreatePass?function qB(n,e,t,i,r){const s=e.consts,o=Ns(s,i),a=ol(e,n,8,"ng-container",o);return null!==o&&Kh(a,o,!0),B_(e,t,a,Ns(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,i,e,t):r.data[s];Lr(o,!0);const a=i[s]=i[Qe].createComment("");return Nh(r,i,a,o),qn(a,i),vh(o)&&(L_(r,i,o),O_(r,o,i)),null!=t&&N_(i,o),ef}function tf(){let n=Vn();const e=lt();return Dg()?Ag():(n=n.parent,Lr(n,!1)),e.firstCreatePass&&(wh(e,n),Sg(n)&&e.queries.elementEnd(n)),tf}function nf(){return re()}function rf(n){return!!n&&"function"==typeof n.then}const VE=function BE(n){return!!n&&"function"==typeof n.subscribe};function pn(n,e,t,i){const r=re(),s=lt(),o=Vn();return function zE(n,e,t,i,r,s,o){const a=vh(i),c=n.firstCreatePass&&vE(n),u=e[an],d=yE(e);let h=!0;if(3&i.type||o){const m=Ci(i,e),g=o?o(m):m,y=d.length,v=o?b=>o(Bn(b[i.index])):i.index;let _=null;if(!o&&a&&(_=function XB(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[Va],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==_)(_.__ngLastListenerFn__||_).__ngNextListenerFn__=s,_.__ngLastListenerFn__=s,h=!1;else{s=GE(i,e,u,s,!1);const b=t.listen(g,r,s);d.push(s,b),c&&c.push(r,v,y,y+1)}}else s=GE(i,e,u,s,!1);const f=i.outputs;let p;if(h&&null!==f&&(p=f[r])){const m=p.length;if(m)for(let g=0;g<m;g+=2){const w=e[p[g]][p[g+1]].subscribe(s),M=d.length;d.push(s,w),c&&c.push(r,i.index,M,-(M+1))}}}(s,r,r[Qe],o,n,e,i),pn}function HE(n,e,t,i){try{return ji(6,e,t),!1!==t(i)}catch(r){return xE(n,r),!1}finally{ji(7,e,t)}}function GE(n,e,t,i,r){return function s(o){if(o===Function)return i;Xh(n.componentOffset>-1?mi(n.index,e):e);let l=HE(e,t,i,o),c=s.__ngNextListenerFn__;for(;c;)l=HE(e,t,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function as(n=1){return function XN(n){return(We.lFrame.contextLView=function YN(n,e){for(;n>0;)e=e[Ua],n--;return e}(n,We.lFrame.contextLView))[an]}(n)}function YB(n,e){let t=null;const i=function w3(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?YS(n,s,!0):E3(i,s))return r}else t=r}return t}function Bo(n){const e=re()[$n][Wn];if(!e.projection){const i=e.projection=Wc(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?YB(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function Bs(n,e=0,t){const i=re(),r=lt(),s=ol(r,Wt+n,16,null,t||null);null===s.projection&&(s.projection=e),Ag(),32!=(32&s.flags)&&function l2(n,e,t){_S(e[Qe],0,e,t,lS(n,t,e),hS(t.parent||e[Wn],t,e))}(r,i,s)}function sf(n,e){return n<<17|e<<2}function Vs(n){return n>>17&32767}function Y_(n){return 2|n}function Vo(n){return(131068&n)>>2}function K_(n,e){return-131069&n|e<<2}function Z_(n){return 1|n}function QE(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?Vs(s):Vo(s),l=!1;for(;0!==a&&(!1===l||o);){const u=n[a+1];tV(n[a],e)&&(l=!0,n[a+1]=i?Z_(u):Y_(u)),a=i?Vs(u):Vo(u)}l&&(n[t+1]=i?Y_(s):Z_(s))}function tV(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Za(n,e)>=0}function af(n,e,t){return fr(n,e,t,!1),af}function Ii(n,e){return fr(n,e,null,!0),Ii}function fr(n,e,t,i){const r=re(),s=lt(),o=function ns(n){const e=We.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}(2);s.firstUpdatePass&&function aC(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[si()],o=function oC(n,e){return e>=n.expandoStartIndex}(n,t);(function dC(n,e){return 0!=(n.flags&(e?8:16))})(s,i)&&null===e&&!o&&(e=!1),e=function uV(n,e,t,i){const r=function Ig(n){const e=We.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=ou(t=J_(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=J_(r,n,e,t,i),null===s){let l=function dV(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==Vo(i))return n[Vs(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=J_(null,n,e,l[1],i),l=ou(l,e.attrs,i),function hV(n,e,t,i){n[Vs(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function fV(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=ou(i,n[s].hostAttrs,t);return ou(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function QB(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=Vs(o),l=Vo(o);n[i]=t;let u,c=!1;if(Array.isArray(t)?(u=t[1],(null===u||Za(t,u)>0)&&(c=!0)):u=t,r)if(0!==l){const h=Vs(n[a+1]);n[i+1]=sf(h,a),0!==h&&(n[h+1]=K_(n[h+1],i)),n[a+1]=function ZB(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=sf(a,0),0!==a&&(n[a+1]=K_(n[a+1],i)),a=i;else n[i+1]=sf(l,0),0===a?a=i:n[l+1]=K_(n[l+1],i),l=i;c&&(n[i+1]=Y_(n[i+1])),QE(n,u,i,!0),QE(n,u,i,!1),function eV(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Za(s,e)>=0&&(t[i+1]=Z_(t[i+1]))}(e,u,n,i,s),o=sf(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}(s,n,o,i),e!==$e&&Xn(r,o,e)&&function cC(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1],u=function JB(n){return 1==(1&n)}(c)?uC(l,e,t,r,Vo(c),o):void 0;lf(u)||(lf(s)||function KB(n){return 2==(2&n)}(c)&&(s=uC(l,null,t,r,a,o)),function u2(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:gi.DashCase;null==r?n.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=gi.Important),n.setStyle(t,i,r,s))}}(i,o,function bh(n,e){return Bn(e[n])}(si(),t),r,s))}(s,s.data[si()],r,r[Qe],n,r[o+1]=function gV(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=zt(Ai(n)))),n}(e,t),i,o)}function J_(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=ou(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function ou(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Di(n,o,!!t||e[++s]))}return void 0===n?null:n}function uC(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),u=c?l[1]:l,d=null===u;let h=t[r+1];h===$e&&(h=d?bt:void 0);let f=d?Wg(h,i):u===i?h:void 0;if(c&&!lf(f)&&(f=Wg(l,i)),lf(f)&&(a=f,o))return a;const p=n[r+1];r=o?Vs(p):Vo(p)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=Wg(l,i))}return a}function lf(n){return void 0!==n}function vi(n,e=""){const t=re(),i=lt(),r=n+Wt,s=i.firstCreatePass?ol(i,r,1,e,null):i.data[r],o=t[r]=function i_(n,e){return n.createText(e)}(t[Qe],e);Nh(i,t,o,s),Lr(s,!1)}const yl="en-US";let FC=yl;function iy(n,e,t,i,r){if(n=Ne(n),Array.isArray(n))for(let s=0;s<n.length;s++)iy(n[s],e,t,i,r);else{const s=lt(),o=re();let a=Fo(n)?n:Ne(n.provide),l=HS(n);const c=Vn(),u=1048575&c.providerIndexes,d=c.directiveStart,h=c.providerIndexes>>20;if(Fo(n)||!n.multi){const f=new Uc(l,r,U),p=sy(a,e,r?u:u+h,d);-1===p?(zg(Ah(c,o),s,a),ry(s,n,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(f),o.push(f)):(t[p]=f,o[p]=f)}else{const f=sy(a,e,u+h,d),p=sy(a,e,u,u+h),g=p>=0&&t[p];if(r&&!g||!r&&!(f>=0&&t[f])){zg(Ah(c,o),s,a);const y=function OU(n,e,t,i,r){const s=new Uc(n,t,U);return s.multi=[],s.index=e,s.componentProviders=0,rD(s,r,i&&!t),s}(r?FU:PU,t.length,r,i,l);!r&&g&&(t[p].providerFactory=y),ry(s,n,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(y),o.push(y)}else ry(s,n,f>-1?f:p,rD(t[r?p:f],l,!r&&i));!r&&i&&g&&t[p].componentProviders++}}}function ry(n,e,t,i){const r=Fo(e),s=function $2(n){return!!n.useClass}(e);if(r||s){const l=(s?Ne(e.useClass):e).prototype.ngOnDestroy;if(l){const c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const u=c.indexOf(t);-1===u?c.push(t,[i,l]):c[u+1].push(i,l)}else c.push(t,l)}}}function rD(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function sy(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function PU(n,e,t,i){return oy(this.multi,[])}function FU(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=To(t,t[Me],this.providerFactory.index,i);s=a.slice(0,o),oy(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],oy(r,s);return s}function oy(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Ct(n,e=[]){return t=>{t.providersResolver=(i,r)=>function RU(n,e,t){const i=lt();if(i.firstCreatePass){const r=ur(n);iy(t,i.data,i.blueprint,r,!0),iy(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class vl{}class LU{}class sD extends vl{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new wE(this);const i=function Si(n,e){const t=n[$w]||null;if(!t&&!0===e)throw new Error(`Type ${zt(n)} does not have '\u0275mod' property.`);return t}(e);this._bootstrapComponents=function ss(n){return n instanceof Function?n():n}(i.bootstrap),this._r3Injector=nE(e,t,[{provide:vl,useValue:this},{provide:eu,useValue:this.componentFactoryResolver}],zt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class ay extends LU{constructor(e){super(),this.moduleType=e}create(e){return new sD(this.moduleType,e)}}class kU extends vl{constructor(e,t,i){super(),this.componentFactoryResolver=new wE(this),this.instance=null;const r=new zS([...e,{provide:vl,useValue:this},{provide:eu,useValue:this.componentFactoryResolver}],t||Gh(),i,new Set(["environment"]));this.injector=r,r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function ly(n,e,t=null){return new kU(n,e,t).injector}let BU=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t.id)){const i=kS(0,t.type),r=i.length>0?ly([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t.id,r)}return this.cachedInjectors.get(t.id)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=Ce({token:n,providedIn:"environment",factory:()=>new n(ie(Oo))}),n})();function hu(n){n.getStandaloneInjector=e=>e.get(BU).getOrCreateStandaloneInjector(n)}function cy(n){const e=_i(n);if(null===e)return null;if(void 0===e.component){const t=e.lView;if(null===t)return null;e.component=function Wk(n,e){const t=e[Me].data[n],{directiveStart:i,componentOffset:r}=t;return r>-1?e[i+r]:null}(e.nodeIndex,t)}return e.component}function GU(n,e){return n.name==e.name?0:n.name<e.name?-1:1}function jU(n){return void 0!==n.type&&void 0!==n.declaredInputs&&void 0!==n.findHostDirectiveDefs}function fD(n,e,t,i,r,s){const o=e+t;return Xn(n,o,r)?function Vr(n,e,t){return n[e]=t}(n,o+1,s?i.call(s,r):i(r)):function fu(n,e){const t=n[e];return t===$e?void 0:t}(n,o+1)}function vD(n,e,t){const i=n+Wt,r=re(),s=Ga(r,i);return function pu(n,e){return n[Me].data[e].pure}(r,i)?fD(r,ri(),e,s.transform,t,s):s.transform(t)}function uy(n){return e=>{setTimeout(n,void 0,e)}}const It=class az extends wt{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=uy(s),r&&(r=uy(r)),o&&(o=uy(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof qt&&e.add(a),a}};function lz(){return this._results[Symbol.iterator]()}class bl{get changes(){return this._changes||(this._changes=new It)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=bl.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=lz)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=function Wi(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function fk(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let qi=(()=>{class n{}return n.__NG_ELEMENT_ID__=dz,n})();const cz=qi,uz=class extends cz{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e,t){const i=this._declarationTContainer.tView,r=Wh(this._declarationLView,i,e,16,null,i.declTNode,null,null,null,null,t||null);r[Nc]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[Fr];return null!==o&&(r[Fr]=o.createEmbeddedView(i)),F_(i,r,e),new nu(r)}};function dz(){return ff(Vn(),re())}function ff(n,e){return 4&n.type?new uz(e,n,nl(n,e)):null}let Kn=(()=>{class n{}return n.__NG_ELEMENT_ID__=hz,n})();function hz(){return wD(Vn(),re())}const fz=Kn,bD=class extends fz{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return nl(this._hostTNode,this._hostLView)}get injector(){return new $a(this._hostTNode,this._hostLView)}get parentInjector(){const e=Ug(this._hostTNode,this._hostLView);if(EM(e)){const t=Ch(e,this._hostLView),i=Eh(e);return new $a(t[Me].data[i+8],t)}return new $a(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=xD(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-ii}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const o=e.createEmbeddedView(t||{},s);return this.insert(o,r),o}createComponent(e,t,i,r,s){const o=e&&!function jc(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const d=t||{};a=d.index,i=d.injector,r=d.projectableNodes,s=d.environmentInjector||d.ngModuleRef}const l=o?e:new iu(Et(e)),c=i||this.parentInjector;if(!s&&null==l.ngModule){const h=(o?c:this.parentInjector).get(Oo,null);h&&(s=h)}const u=l.create(c,r,void 0,s);return this.insert(u.hostView,a),u}insert(e,t){const i=e._lView,r=i[Me];if(function kN(n){return cr(n[tn])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const d=i[tn],h=new bD(d,d[Wn],d[tn]);h.detach(h.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function t2(n,e,t,i){const r=ii+i,s=t.length;i>0&&(t[r-1][lr]=e),i<s-ii?(e[lr]=t[r],kM(t,ii+i,e)):(t.push(e),e[lr]=null),e[tn]=t;const o=e[Nc];null!==o&&t!==o&&function n2(n,e){const t=n[Ha];e[$n]!==e[tn][tn][$n]&&(n[Jw]=!0),null===t?n[Ha]=[e]:t.push(e)}(o,e);const a=e[Fr];null!==a&&a.insertView(n),e[Ze]|=64}(r,i,o,s);const a=l_(s,o),l=i[Qe],c=Lh(l,o[_h]);return null!==c&&function Jk(n,e,t,i,r,s){i[es]=r,i[Wn]=e,Zc(n,i,t,1,r,s)}(r,o[Wn],l,i,c,a),e.attachToViewContainerRef(),kM(dy(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=xD(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=s_(this._lContainer,t);i&&(Ih(dy(this._lContainer),t),aS(i[Me],i))}detach(e){const t=this._adjustIndex(e,-1),i=s_(this._lContainer,t);return i&&null!=Ih(dy(this._lContainer),t)?new nu(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function xD(n){return n[yh]}function dy(n){return n[yh]||(n[yh]=[])}function wD(n,e){let t;const i=e[n.index];if(cr(i))t=i;else{let r;if(8&n.type)r=Bn(i);else{const s=e[Qe];r=s.createComment("");const o=Ci(n,e);Ro(s,Lh(s,o),r,function a2(n,e){return n.nextSibling(e)}(s,o),!1)}e[n.index]=t=_E(i,e,r,n),qh(e,t)}return new bD(t,n,e)}class hy{constructor(e){this.queryList=e,this.matches=null}clone(){return new hy(this.queryList)}setDirty(){this.queryList.setDirty()}}class fy{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new fy(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==DD(e,t).matches&&this.queries[t].setDirty()}}class MD{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class py{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new py(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class my{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new my(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,pz(t,s)),this.matchTNodeWithReadOption(e,t,Th(t,e,s,!1,!1))}else i===qi?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Th(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Tt||r===Kn||r===qi&&4&t.type)this.addMatch(t.index,-2);else{const s=Th(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function pz(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function gz(n,e,t,i){return-1===t?function mz(n,e){return 11&n.type?nl(n,e):4&n.type?ff(n,e):null}(e,n):-2===t?function _z(n,e,t){return t===Tt?nl(e,n):t===qi?ff(e,n):t===Kn?wD(e,n):void 0}(n,e,i):To(n,n[Me],t,e)}function SD(n,e,t,i){const r=e[Fr].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:gz(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function gy(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=SD(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let d=ii;d<u.length;d++){const h=u[d];h[Nc]===h[tn]&&gy(h[Me],h,c,i)}if(null!==u[Ha]){const d=u[Ha];for(let h=0;h<d.length;h++){const f=d[h];gy(f[Me],f,c,i)}}}}}return i}function Xi(n){const e=re(),t=lt(),i=pM();Rg(i+1);const r=DD(t,i);if(n.dirty&&function NN(n){return 4==(4&n[Ze])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?gy(t,e,i,[]):SD(t,e,r,i);n.reset(s,r3),n.notifyOnChanges()}return!0}return!1}function Us(n,e,t){const i=lt();i.firstCreatePass&&(CD(i,new MD(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),ED(i,re(),e)}function mu(n,e,t,i){const r=lt();if(r.firstCreatePass){const s=Vn();CD(r,new MD(e,t,i),s.index),function vz(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),2==(2&t)&&(r.staticContentQueries=!0)}ED(r,re(),t)}function Yi(){return function yz(n,e){return n[Fr].queries[e].queryList}(re(),pM())}function ED(n,e,t){const i=new bl(4==(4&t));hE(n,e,i,i.destroy),null===e[Fr]&&(e[Fr]=new fy),e[Fr].queries.push(new hy(i))}function CD(n,e,t){null===n.queries&&(n.queries=new py),n.queries.track(new my(e,t))}function DD(n,e){return n.queries.getByIndex(e)}function mf(...n){}const $D=new he("Application Initializer");let gf=(()=>{class n{constructor(t){this.appInits=t,this.resolve=mf,this.reject=mf,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(rf(s))t.push(s);else if(VE(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(ie($D,8))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const _u=new he("AppId",{providedIn:"root",factory:function qD(){return`${xy()}${xy()}${xy()}`}});function xy(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const XD=new he("Platform Initializer"),wy=new he("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Ml=new he("AnimationModuleType"),Hr=new he("LocaleId",{providedIn:"root",factory:()=>_t(Hr,ze.Optional|ze.SkipSelf)||function Uz(){return typeof $localize<"u"&&$localize.locale||yl}()}),Wz=(()=>Promise.resolve(0))();function My(n){typeof Zone>"u"?Wz.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class ot{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new It(!1),this.onMicrotaskEmpty=new It(!1),this.onStable=new It(!1),this.onError=new It(!1),typeof Zone>"u")throw new se(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function $z(){let n=jt.requestAnimationFrame,e=jt.cancelAnimationFrame;if(typeof Zone<"u"&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function Yz(n){const e=()=>{!function Xz(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(jt,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Ey(n),n.isCheckStableRunning=!0,Sy(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Ey(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return ZD(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),JD(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return ZD(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),JD(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,Ey(n),Sy(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!ot.isInAngularZone())throw new se(909,!1)}static assertNotInAngularZone(){if(ot.isInAngularZone())throw new se(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,qz,mf,mf);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const qz={};function Sy(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Ey(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function ZD(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function JD(n){n._nesting--,Sy(n)}class Kz{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new It,this.onMicrotaskEmpty=new It,this.onStable=new It,this.onError=new It}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const QD=new he(""),_f=new he("");let Ay,Cy=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Ay||(function Zz(n){Ay=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ot.assertNotInAngularZone(),My(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())My(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(ie(ot),ie(Dy),ie(_f))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac}),n})(),Dy=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return Ay?.findTestabilityInTree(this,t,i)??null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const ls=!1;let zs=null;const eA=new he("AllowMultipleToken"),Ty=new he("PlatformDestroyListeners"),Jz=new he("appBootstrapListener");function nA(n,e,t=[]){const i=`Platform: ${e}`,r=new he(i);return(s=[])=>{let o=Iy();if(!o||o.injector.get(eA,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function tH(n){if(zs&&!zs.get(eA,!1))throw new se(400,!1);zs=n;const e=n.get(rA);(function tA(n){const e=n.get(XD,null);e&&e.forEach(t=>t())})(n)}(function iA(n=[],e){return hr.create({name:e,providers:[{provide:b_,useValue:"platform"},{provide:Ty,useValue:new Set([()=>zs=null])},...n]})}(a,i))}return function iH(n){const e=Iy();if(!e)throw new se(401,!1);return e}()}}function Iy(){return zs?.get(rA)??null}let rA=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function oA(n,e){let t;return t="noop"===n?new Kz:("zone.js"===n?void 0:n)||new ot(e),t}(i?.ngZone,function sA(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(i)),s=[{provide:ot,useValue:r}];return r.run(()=>{const o=hr.create({providers:s,parent:this.injector,name:t.moduleType.name}),a=t.create(o),l=a.injector.get(rs,null);if(!l)throw new se(402,!1);return r.runOutsideAngular(()=>{const c=r.onError.subscribe({next:u=>{l.handleError(u)}});a.onDestroy(()=>{yf(this._modules,a),c.unsubscribe()})}),function aA(n,e,t){try{const i=t();return rf(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(l,r,()=>{const c=a.injector.get(gf);return c.runInitializers(),c.donePromise.then(()=>(function OC(n){zi(n,"Expected localeId to be defined"),"string"==typeof n&&(FC=n.toLowerCase().replace(/_/g,"-"))}(a.injector.get(Hr,yl)||yl),this._moduleDoBootstrap(a),a))})})}bootstrapModule(t,i=[]){const r=lA({},i);return function Qz(n,e,t){const i=new ay(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(yu);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new se(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new se(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(Ty,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(ie(hr))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function lA(n,e){return Array.isArray(e)?e.reduce(lA,n):{...n,...e}}let yu=(()=>{class n{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(t,i,r){this._zone=t,this._injector=i,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new Lt(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),o=new Lt(a=>{let l;this._zone.runOutsideAngular(()=>{l=this._zone.onStable.subscribe(()=>{ot.assertNotInAngularZone(),My(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const c=this._zone.onUnstable.subscribe(()=>{ot.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{l.unsubscribe(),c.unsubscribe()}});this.isStable=Os(s,o.pipe(Tc()))}bootstrap(t,i){const r=t instanceof GS;if(!this._injector.get(gf).done){!r&&function Oc(n){const e=Et(n)||jn(n)||pi(n);return null!==e&&e.standalone}(t);throw new se(405,ls)}let o;o=r?t:this._injector.get(eu).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function eH(n){return n.isBoundToModule}(o)?void 0:this._injector.get(vl),c=o.create(hr.NULL,[],i||o.selector,a),u=c.location.nativeElement,d=c.injector.get(QD,null);return d?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),yf(this.components,c),d?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new se(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;yf(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(Jz,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>yf(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new se(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(t){return new(t||n)(ie(ot),ie(Oo),ie(rs))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function yf(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}let Zn=(()=>{class n{}return n.__NG_ELEMENT_ID__=sH,n})();function sH(n){return function oH(n,e,t){if(Bc(n)&&!t){const i=mi(n.index,e);return new nu(i,i)}return 47&n.type?new nu(e[$n],e):null}(Vn(),re(),16==(16&n))}class dA{constructor(e){this.nativeNode=e}get parent(){const e=this.nativeNode.parentNode;return e?new vf(e):null}get injector(){return function cD(n){const e=_i(n),t=e?e.lView:null;return null===t?hr.NULL:new $a(t[Me].data[e.nodeIndex],t)}(this.nativeNode)}get componentInstance(){const e=this.nativeNode;return e&&(cy(e)||function aD(n){const e=_i(n);let i,t=e?e.lView:null;if(null===t)return null;for(;2===t[Me].type&&(i=Kc(t));)t=i;return 256&t[Ze]?null:t[an]}(e))}get context(){return cy(this.nativeNode)||function oD(n){!function WU(n){if(typeof Element<"u"&&!(n instanceof Element))throw new Error("Expecting instance of DOM Element")}(n);const e=_i(n),t=e?e.lView:null;return null===t?null:t[an]}(this.nativeNode)}get listeners(){return function dD(n){const e=_i(n),t=null===e?null:e.lView;if(null===t)return[];const r=t[Va],s=t[Me].cleanup,o=[];if(s&&r)for(let a=0;a<s.length;){const l=s[a++],c=s[a++];if("string"==typeof l){const u=l,d=Bn(t[c]),h=r[s[a++]],f=s[a++];n==d&&o.push({element:n,name:u,callback:h,useCapture:"boolean"==typeof f&&f,type:"boolean"==typeof f||f>=0?"dom":"output"})}}return o.sort(GU),o}(this.nativeNode).filter(e=>"dom"===e.type)}get references(){return function HU(n){const e=_i(n);if(null===e)return{};if(void 0===e.localRefs){const t=e.lView;if(null===t)return{};e.localRefs=function $k(n,e){const t=n[Me].data[e];if(t&&t.localNames){const i={};let r=t.index+1;for(let s=0;s<t.localNames.length;s+=2)i[t.localNames[s]]=n[r],r++;return i}return null}(t,e.nodeIndex)}return e.localRefs||{}}(this.nativeNode)}get providerTokens(){return function VU(n){const e=_i(n),t=e?e.lView:null;if(null===t)return[];const i=t[Me],r=i.data[e.nodeIndex],s=[],a=r.directiveEnd;for(let l=1048575&r.providerIndexes;l<a;l++){let c=i.data[l];jU(c)&&(c=c.type),s.push(c)}return s}(this.nativeNode)}}class vf extends dA{constructor(e){super(e)}get nativeElement(){return this.nativeNode.nodeType==Node.ELEMENT_NODE?this.nativeNode:null}get name(){const e=_i(this.nativeNode),t=e?e.lView:null;return null!==t?t[Me].data[e.nodeIndex].value:this.nativeNode.nodeName}get properties(){const e=_i(this.nativeNode),t=e?e.lView:null;if(null===t)return{};const i=t[Me].data,r=i[e.nodeIndex],s={};return function aH(n,e){if(n){let t=Object.getPrototypeOf(n);const i=Node.prototype;for(;null!==t&&t!==i;){const r=Object.getOwnPropertyDescriptors(t);for(let s in r)if(!s.startsWith("__")&&!s.startsWith("on")){const o=n[s];lH(o)&&(e[s]=o)}t=Object.getPrototypeOf(t)}}}(this.nativeElement,s),function cH(n,e,t,i){let r=e.propertyBindings;if(null!==r)for(let s=0;s<r.length;s++){const o=r[s],l=i[o].split("\ufffd"),c=l[0];if(l.length>1){let u=l[1];for(let d=1;d<l.length-1;d++)u+=je(t[o+d-1])+l[d+1];n[c]=u}else n[c]=t[o]}}(s,r,t,i),s}get attributes(){const e={},t=this.nativeElement;if(!t)return e;const i=_i(t),r=i?i.lView:null;if(null===r)return{};const s=r[Me].data[i.nodeIndex].attrs,o=[];if(s){let l=0;for(;l<s.length;){const c=s[l];if("string"!=typeof c)break;e[c]=s[l+1],o.push(c.toLowerCase()),l+=2}}const a=t.attributes;for(let l=0;l<a.length;l++){const c=a[l],u=c.name.toLowerCase();-1===o.indexOf(u)&&(e[u]=c.value)}return e}get styles(){return this.nativeElement&&this.nativeElement.style?this.nativeElement.style:{}}get classes(){const e={},i=this.nativeElement.className;return("string"!=typeof i?i.baseVal.split(" "):i.split(" ")).forEach(s=>e[s]=!0),e}get childNodes(){const e=this.nativeNode.childNodes,t=[];for(let i=0;i<e.length;i++)t.push(Sl(e[i]));return t}get children(){const e=this.nativeElement;if(!e)return[];const t=e.children,i=[];for(let r=0;r<t.length;r++)i.push(Sl(t[r]));return i}query(e){return this.queryAll(e)[0]||null}queryAll(e){const t=[];return hA(this,e,t,!0),t}queryAllNodes(e){const t=[];return hA(this,e,t,!1),t}triggerEventHandler(e,t){const i=this.nativeNode,r=[];this.listeners.forEach(s=>{if(s.name===e){const o=s.callback;o.call(i,t),r.push(o)}}),"function"==typeof i.eventListeners&&i.eventListeners(e).forEach(s=>{if(-1!==s.toString().indexOf("__ngUnwrap__")){const o=s("__ngUnwrap__");return-1===r.indexOf(o)&&o.call(i,t)}})}}function lH(n){return"string"==typeof n||"boolean"==typeof n||"number"==typeof n||null===n}function hA(n,e,t,i){const r=_i(n.nativeNode),s=r?r.lView:null;null!==s?zo(s[Me].data[r.nodeIndex],s,e,t,i,n.nativeNode):Py(n.nativeNode,e,t,i)}function zo(n,e,t,i,r,s){const o=function LN(n,e){const t=null===n?-1:n.index;return-1!==t?Bn(e[t]):null}(n,e);if(11&n.type){if(Ry(o,t,i,r,s),Bc(n)){const l=mi(n.index,e);l&&l[Me].firstChild&&zo(l[Me].firstChild,l,t,i,r,s)}else n.child&&zo(n.child,e,t,i,r,s),o&&Py(o,t,i,r);const a=e[n.index];cr(a)&&fA(a,t,i,r,s)}else if(4&n.type){const a=e[n.index];Ry(a[_h],t,i,r,s),fA(a,t,i,r,s)}else if(16&n.type){const a=e[$n],c=a[Wn].projection[n.projection];if(Array.isArray(c))for(let u of c)Ry(u,t,i,r,s);else if(c){const u=a[tn];zo(u[Me].data[c.index],u,t,i,r,s)}}else n.child&&zo(n.child,e,t,i,r,s);if(s!==o){const a=2&n.flags?n.projectionNext:n.next;a&&zo(a,e,t,i,r,s)}}function fA(n,e,t,i,r){for(let s=ii;s<n.length;s++){const o=n[s],a=o[Me].firstChild;a&&zo(a,o,e,t,i,r)}}function Ry(n,e,t,i,r){if(r!==n){const s=Sl(n);if(!s)return;(i&&s instanceof vf&&e(s)&&-1===t.indexOf(s)||!i&&e(s)&&-1===t.indexOf(s))&&t.push(s)}}function Py(n,e,t,i){const r=n.childNodes,s=r.length;for(let o=0;o<s;o++){const a=r[o],l=Sl(a);l&&((i&&l instanceof vf&&e(l)&&-1===t.indexOf(l)||!i&&e(l)&&-1===t.indexOf(l))&&t.push(l),Py(a,e,t,i))}}const Oy="__ng_debug__";function Sl(n){return n instanceof Node?(n.hasOwnProperty(Oy)||(n[Oy]=n.nodeType==Node.ELEMENT_NODE?new vf(n):new dA(n)),n[Oy]):null}class pA{constructor(){}supports(e){return Jh(e)}create(e){return new dH(e)}}const uH=(n,e)=>e;class dH{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||uH}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<gA(i,r,s)?t:i,a=gA(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let h=0;h<c;h++){const f=h<s.length?s[h]:s[h]=0,p=f+h;u<=p&&p<c&&(s[h]=f+1)}s[o.previousIndex]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Jh(e))throw new se(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function zB(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new hH(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new mA),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new mA),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class hH{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class fH{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class mA{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new fH,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function gA(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class _A{constructor(){}supports(e){return e instanceof Map||W_(e)}create(){return new pH}}class pH{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||W_(e)))throw new se(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new mH(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class mH{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function yA(){return new bf([new pA])}let bf=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||yA()),deps:[[n,new $c,new ks]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new se(901,!1)}}return n.\u0275prov=Ce({token:n,providedIn:"root",factory:yA}),n})();function vA(){return new vu([new _A])}let vu=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||vA()),deps:[[n,new $c,new ks]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new se(901,!1)}}return n.\u0275prov=Ce({token:n,providedIn:"root",factory:vA}),n})();const yH=nA(null,"core",[]);let vH=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(ie(yu))},n.\u0275mod=wn({type:n}),n.\u0275inj=hn({}),n})(),Ny=null;function cs(){return Ny}class wH{}const at=new he("DocumentToken");let bA=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ce({token:n,factory:function(){return function MH(){return ie(xA)}()},providedIn:"platform"}),n})(),xA=(()=>{class n extends bA{constructor(t){super(),this._doc=t,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return cs().getBaseHref(this._doc)}onPopState(t){const i=cs().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=cs().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){wA()?this._history.pushState(t,i,r):this._location.hash=r}replaceState(t,i,r){wA()?this._history.replaceState(t,i,r):this._location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(ie(at))},n.\u0275prov=Ce({token:n,factory:function(){return function SH(){return new xA(ie(at))}()},providedIn:"platform"}),n})();function wA(){return!!window.history.pushState}function MA(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function SA(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Ho(n){return n&&"?"!==n[0]?"?"+n:n}let ky=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ce({token:n,factory:function(){return _t(CH)},providedIn:"root"}),n})();const EH=new he("appBaseHref");let CH=(()=>{class n extends ky{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??_t(at).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return MA(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Ho(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+Ho(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+Ho(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(ie(bA),ie(EH,8))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),EA=(()=>{class n{constructor(t){this._subject=new It,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function TH(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(SA(CA(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Ho(i))}normalize(t){return n.stripTrailingSlash(function AH(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,CA(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ho(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ho(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.normalizeQueryParams=Ho,n.joinWithSlash=MA,n.stripTrailingSlash=SA,n.\u0275fac=function(t){return new(t||n)(ie(ky))},n.\u0275prov=Ce({token:n,factory:function(){return function DH(){return new EA(ie(ky))}()},providedIn:"root"}),n})();function CA(n){return n.replace(/\/index.html$/,"")}const qy=/\s+/,LA=[];let NA=(()=>{class n{constructor(t,i,r,s){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this.initialClasses=LA,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(qy):LA}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(qy):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,Boolean(t[i]));this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(qy).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return n.\u0275fac=function(t){return new(t||n)(U(bf),U(vu),U(Tt),U(No))},n.\u0275dir=De({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})(),Xy=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new _4,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){UA("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){UA("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(U(Kn),U(qi))},n.\u0275dir=De({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class _4{constructor(){this.$implicit=null,this.ngIf=null}}function UA(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${zt(e)}'.`)}let Qy=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=wn({type:n}),n.\u0275inj=hn({}),n})();const GA="browser";class bG extends wH{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class nv extends bG{static makeCurrent(){!function xH(n){Ny||(Ny=n)}(new nv)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function xG(){return Mu=Mu||document.querySelector("base"),Mu?Mu.getAttribute("href"):null}();return null==t?null:function wG(n){Pf=Pf||document.createElement("a"),Pf.setAttribute("href",n);const e=Pf.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Mu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function h4(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let Pf,Mu=null;const YA=new he("TRANSITION_ID"),SG=[{provide:$D,useFactory:function MG(n,e,t){return()=>{t.get(gf).donePromise.then(()=>{const i=cs(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[YA,at,hr],multi:!0}];let CG=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ce({token:n,factory:n.\u0275fac}),n})();const Ff=new he("EventManagerPlugins");let Of=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(ie(Ff),ie(ot))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac}),n})();class KA{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=cs().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let ZA=(()=>{class n{constructor(){this.usageCount=new Map}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)0===this.changeUsageCount(i,-1)&&this.onStyleRemoved(i)}onStyleRemoved(t){}onStyleAdded(t){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(t,i){const r=this.usageCount;let s=r.get(t)??0;return s+=i,s>0?r.set(t,s):r.delete(t),s}ngOnDestroy(){for(const t of this.getAllStyles())this.onStyleRemoved(t);this.usageCount.clear()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ce({token:n,factory:n.\u0275fac}),n})(),Su=(()=>{class n extends ZA{constructor(t){super(),this.doc=t,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.forEach(s=>s.remove()),i.delete(t)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}addStyleToHost(t,i){const r=this.doc.createElement("style");r.textContent=i,t.appendChild(r);const s=this.styleRef.get(i);s?s.push(r):this.styleRef.set(i,[r])}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return n.\u0275fac=function(t){return new(t||n)(ie(at))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac}),n})();const iv={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},rv=/%COMP%/g,eT=new he("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function tT(n,e){return e.flat(100).map(t=>t.replace(rv,n))}function nT(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let Lf=(()=>{class n{constructor(t,i,r,s){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestory=s,this.rendererByCompId=new Map,this.defaultRenderer=new sv(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;const r=this.getOrCreateRenderer(t,i);return r instanceof sT?r.applyToHost(t):r instanceof ov&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.eventManager,a=this.sharedStylesHost,l=this.removeStylesOnCompDestory;switch(i.encapsulation){case ar.Emulated:s=new sT(o,a,i,this.appId,l);break;case ar.ShadowDom:return new FG(o,a,t,i);default:s=new ov(o,a,i,l)}s.onDestroy=()=>r.delete(i.id),r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(ie(Of),ie(Su),ie(_u),ie(eT))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac}),n})();class sv{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(iv[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(rT(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(rT(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=iv[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=iv[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(gi.DashCase|gi.Important)?e.style.setProperty(t,i,r&gi.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&gi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,nT(i)):this.eventManager.addEventListener(e,t,nT(i))}}function rT(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class FG extends sv{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=tT(r.id,r.styles);for(const o of s){const a=document.createElement("style");a.textContent=o,this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class ov extends sv{constructor(e,t,i,r,s=i.id){super(e),this.sharedStylesHost=t,this.removeStylesOnCompDestory=r,this.rendererUsageCount=0,this.styles=tT(s,i.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class sT extends ov{constructor(e,t,i,r,s){const o=r+"-"+i.id;super(e,t,i,s,o),this.contentAttr=function IG(n){return"_ngcontent-%COMP%".replace(rv,n)}(o),this.hostAttr=function RG(n){return"_nghost-%COMP%".replace(rv,n)}(o)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let OG=(()=>{class n extends KA{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(ie(at))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac}),n})();const oT=["alt","control","meta","shift"],LG={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},NG={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let kG=(()=>{class n extends KA{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>cs().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),oT.forEach(c=>{const u=i.indexOf(c);u>-1&&(i.splice(u,1),o+=c+".")}),o+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,i){let r=LG[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),oT.forEach(o=>{o!==r&&(0,NG[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(ie(at))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac}),n})();const zG=nA(yH,"browser",[{provide:wy,useValue:GA},{provide:XD,useValue:function BG(){nv.makeCurrent()},multi:!0},{provide:at,useFactory:function UG(){return function m2(n){h_=n}(document),document},deps:[]}]),cT=new he(""),uT=[{provide:_f,useClass:class EG{addToWindow(e){jt.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},jt.getAllAngularTestabilities=()=>e.getAllTestabilities(),jt.getAllAngularRootElements=()=>e.getAllRootElements(),jt.frameworkStabilizers||(jt.frameworkStabilizers=[]),jt.frameworkStabilizers.push(i=>{const r=jt.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?cs().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:QD,useClass:Cy,deps:[ot,Dy,_f]},{provide:Cy,useClass:Cy,deps:[ot,Dy,_f]}],dT=[{provide:b_,useValue:"root"},{provide:rs,useFactory:function VG(){return new rs},deps:[]},{provide:Ff,useClass:OG,multi:!0,deps:[at,ot,wy]},{provide:Ff,useClass:kG,multi:!0,deps:[at]},{provide:Lf,useClass:Lf,deps:[Of,Su,_u,eT]},{provide:Lo,useExisting:Lf},{provide:ZA,useExisting:Su},{provide:Su,useClass:Su,deps:[at]},{provide:Of,useClass:Of,deps:[Ff,ot]},{provide:class q4{},useClass:CG,deps:[]},[]];let hT=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:_u,useValue:t.appId},{provide:YA,useExisting:_u},SG]}}}return n.\u0275fac=function(t){return new(t||n)(ie(cT,12))},n.\u0275mod=wn({type:n}),n.\u0275inj=hn({providers:[...dT,...uT],imports:[Qy,vH]}),n})();typeof window<"u"&&window;let cv=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ce({token:n,factory:function(t){let i=null;return i=t?new(t||n):ie(mT),i},providedIn:"root"}),n})(),mT=(()=>{class n extends cv{constructor(t){super(),this._doc=t}sanitize(t,i){if(null==i)return null;switch(t){case xt.NONE:return i;case xt.HTML:return kr(i,"HTML")?Ai(i):IS(this._doc,String(i)).toString();case xt.STYLE:return kr(i,"Style")?Ai(i):i;case xt.SCRIPT:if(kr(i,"Script"))return Ai(i);throw new Error("unsafe value used in a script context");case xt.URL:return kr(i,"URL")?Ai(i):Uh(String(i));case xt.RESOURCE_URL:if(kr(i,"ResourceURL"))return Ai(i);throw new Error(`unsafe value used in a resource URL context (see ${oh})`);default:throw new Error(`Unexpected SecurityContext ${t} (see ${oh})`)}}bypassSecurityTrustHtml(t){return function w2(n){return new g2(n)}(t)}bypassSecurityTrustStyle(t){return function M2(n){return new _2(n)}(t)}bypassSecurityTrustScript(t){return function S2(n){return new y2(n)}(t)}bypassSecurityTrustUrl(t){return function E2(n){return new v2(n)}(t)}bypassSecurityTrustResourceUrl(t){return function C2(n){return new b2(n)}(t)}}return n.\u0275fac=function(t){return new(t||n)(ie(at))},n.\u0275prov=Ce({token:n,factory:function(t){let i=null;return i=t?new t:function XG(n){return new mT(n.get(at))}(ie(hr)),i},providedIn:"root"}),n})();class gT{}class YG{}const ds="*";function Nf(n,e){return{type:7,name:n,definitions:e,options:{}}}function Eu(n,e=null){return{type:4,styles:e,timings:n}}function _T(n,e=null){return{type:2,steps:n,options:e}}function yr(n){return{type:6,styles:n,offset:null}}function El(n,e,t){return{type:0,name:n,styles:e,options:t}}function Cu(n,e,t=null){return{type:1,expr:n,animation:e,options:t}}function yT(n){Promise.resolve().then(n)}class Du{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){yT(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class vT{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?yT(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}const uv="!",KG=Nf("FMopenClose",[El("open",yr({opacity:1})),El("closed",yr({opacity:0})),Cu("* => *",[Eu("3s ease")])]);let dv;Nf("EEopenClose",[El("open",yr({opacity:1})),El("closed",yr({opacity:0})),Cu("* => *",[Eu("7s ease")])]);try{dv=typeof Intl<"u"&&Intl.v8BreakIterator}catch{dv=!1}let Au,kf,Go,hv,Ji=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function W4(n){return n===GA}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!dv)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(ie(wy))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Tu(n){return function ZG(){if(null==Au&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Au=!0}))}finally{Au=Au||!1}return Au}()?n:!!n.capture}function xT(){if(null==Go){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Go=!1,Go;if("scrollBehavior"in document.documentElement.style)Go=!0;else{const n=Element.prototype.scrollTo;Go=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return Go}function Iu(){if("object"!=typeof document||!document)return 0;if(null==kf){const n=document.createElement("div"),e=n.style;n.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),i=t.style;i.width="2px",i.height="1px",n.appendChild(t),document.body.appendChild(n),kf=0,0===n.scrollLeft&&(n.scrollLeft=1,kf=0===n.scrollLeft?1:2),n.remove()}return kf}function Gs(n){return n.composedPath?n.composedPath()[0]:n.target}function fv(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}class Ru extends wt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function Ri(...n){return Mo(n,Ac(n))}function ST(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}function hs(n,e,t){const i=st(n)||e||t?{next:n,error:e,complete:t}:n;return i?en((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(Gt(s,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),s.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):Fs}class y5 extends qt{constructor(e,t){super()}schedule(e,t=0){return this}}const Bf={setInterval(n,e,...t){const{delegate:i}=Bf;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=Bf;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class Vf extends y5{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return Bf.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&Bf.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,th(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const gv={now:()=>(gv.delegate||Date).now(),delegate:void 0};class Pu{constructor(e,t=Pu.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}Pu.now=gv.now;class Uf extends Pu{constructor(e,t=Pu.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const zf=new Uf(Vf),v5=zf;function Hf(n,e=zf){return en((t,i)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const c=s;s=null,i.next(c)}};function l(){const c=o+n,u=e.now();if(u<c)return r=this.schedule(void 0,c-u),void i.add(r);a()}t.subscribe(Gt(i,c=>{s=c,o=e.now(),r||(r=e.schedule(l,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{s=r=null}))})}function li(n,e){return en((t,i)=>{let r=0;t.subscribe(Gt(i,s=>n.call(e,s,r++)&&i.next(s)))})}function ET(n){return li((e,t)=>n<=t)}function jo(n,e=Fs){return n=n??b5,en((t,i)=>{let r,s=!0;t.subscribe(Gt(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}function b5(n,e){return n===e}function Qi(n){return en((e,t)=>{Rn(n).subscribe(Gt(t,()=>t.complete(),La)),!t.closed&&e.subscribe(t)})}function js(n){return null!=n&&"false"!=`${n}`}function Gf(n){return Array.isArray(n)?n:[n]}function _n(n){return null==n?"":"string"==typeof n?n:`${n}px`}function Dl(n){return n instanceof Tt?n.nativeElement:n}const{isArray:M5}=Array,{getPrototypeOf:S5,prototype:E5,keys:C5}=Object;function CT(n){if(1===n.length){const e=n[0];if(M5(e))return{args:e,keys:null};if(function D5(n){return n&&"object"==typeof n&&S5(n)===E5}(e)){const t=C5(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:A5}=Array;function _v(n){return Nt(e=>function T5(n,e){return A5(e)?n(...e):n(e)}(n,e))}function DT(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function AT(...n){const e=Ac(n),t=ug(n),{args:i,keys:r}=CT(n);if(0===i.length)return Mo([],e);const s=new Lt(function I5(n,e,t=Fs){return i=>{TT(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)TT(e,()=>{const c=Mo(n[l],e);let u=!1;c.subscribe(Gt(i,d=>{s[l]=d,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>DT(r,o):Fs));return t?s.pipe(_v(t)):s}function TT(n,e,t){n?Kr(t,n,e):e()}function jf(...n){return function R5(){return sh(1)}()(Mo(n,Ac(n)))}function fs(n){return n<=0?()=>Dc:en((e,t)=>{let i=0;e.subscribe(Gt(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function Wo(...n){const e=Ac(n);return en((t,i)=>{(e?jf(n,t,e):jf(n,t)).subscribe(i)})}const IT=new Set;let Al,P5=(()=>{class n{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):O5}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function F5(n){if(!IT.has(n))try{Al||(Al=document.createElement("style"),Al.setAttribute("type","text/css"),document.head.appendChild(Al)),Al.sheet&&(Al.sheet.insertRule(`@media ${n} {body{ }}`,0),IT.add(n))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return n.\u0275fac=function(t){return new(t||n)(ie(Ji))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function O5(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let L5=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new wt}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return RT(Gf(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=AT(RT(Gf(t)).map(o=>this._registerQuery(o).observable));return s=jf(s.pipe(fs(1)),s.pipe(ET(1),Hf(0))),s.pipe(Nt(o=>{const a={matches:!1,breakpoints:{}};return o.forEach(({matches:l,query:c})=>{a.matches=a.matches||l,a.breakpoints[c]=l}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),s={observable:new Lt(o=>{const a=l=>this._zone.run(()=>o.next(l));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(Wo(i),Nt(({matches:o})=>({query:t,matches:o})),Qi(this._destroySubject)),mql:i};return this._queries.set(t,s),s}}return n.\u0275fac=function(t){return new(t||n)(ie(P5),ie(ot))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function RT(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}class B5{constructor(e){this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new wt,this._typeaheadSubscription=qt.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=t=>t.disabled,this._pressedLetters=[],this.tabOut=new wt,this.change=new wt,e instanceof bl&&(this._itemChangesSubscription=e.changes.subscribe(t=>{if(this._activeItem){const r=t.toArray().indexOf(this._activeItem);r>-1&&r!==this._activeItemIndex&&(this._activeItemIndex=r)}}))}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(hs(t=>this._pressedLetters.push(t)),Hf(e),li(()=>this._pressedLetters.length>0),Nt(()=>this._pressedLetters.join(""))).subscribe(t=>{const i=this._getItemsArray();for(let r=1;r<i.length+1;r++){const s=(this._activeItemIndex+r)%i.length,o=i[s];if(!this._skipPredicateFn(o)&&0===o.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(s);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}withPageUpDown(e=!0,t=10){return this._pageUpAndDown={enabled:e,delta:t},this}setActiveItem(e){const t=this._activeItem;this.updateActiveItem(e),this._activeItem!==t&&this.change.next(this._activeItemIndex)}onKeydown(e){const t=e.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!e[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;case 33:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(s>0?s:0,1);break}return;case 34:if(this._pageUpAndDown.enabled&&r){const s=this._activeItemIndex+this._pageUpAndDown.delta,o=this._getItemsArray().length;this._setActiveItemByIndex(s<o?s:o-1,-1);break}return;default:return void((r||ST(e,"shiftKey"))&&(e.key&&1===e.key.length?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))))}this._pressedLetters=[],e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){const t=this._getItemsArray(),i="number"==typeof e?e:t.indexOf(e);this._activeItem=t[i]??null,this._activeItemIndex=i}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){const t=this._getItemsArray();for(let i=1;i<=t.length;i++){const r=(this._activeItemIndex+e*i+t.length)%t.length;if(!this._skipPredicateFn(t[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,t){const i=this._getItemsArray();if(i[e]){for(;this._skipPredicateFn(i[e]);)if(!i[e+=t])return;this.setActiveItem(e)}}_getItemsArray(){return this._items instanceof bl?this._items.toArray():this._items}}class V5 extends B5{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(e){return this._origin=e,this}setActiveItem(e){super.setActiveItem(e),this.activeItem&&this.activeItem.focus(this._origin)}}function yv(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}function vv(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const W5=new he("cdk-input-modality-detector-options"),$5={ignoreKeys:[18,17,224,91,16]},Tl=Tu({passive:!0,capture:!0});let q5=(()=>{class n{get mostRecentModality(){return this._modality.value}constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new Ru(null),this._lastTouchMs=0,this._onKeydown=o=>{this._options?.ignoreKeys?.some(a=>a===o.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Gs(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(yv(o)?"keyboard":"mouse"),this._mostRecentTarget=Gs(o))},this._onTouchstart=o=>{vv(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Gs(o))},this._options={...$5,...s},this.modalityDetected=this._modality.pipe(ET(1)),this.modalityChanged=this.modalityDetected.pipe(jo()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,Tl),r.addEventListener("mousedown",this._onMousedown,Tl),r.addEventListener("touchstart",this._onTouchstart,Tl)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Tl),document.removeEventListener("mousedown",this._onMousedown,Tl),document.removeEventListener("touchstart",this._onTouchstart,Tl))}}return n.\u0275fac=function(t){return new(t||n)(ie(Ji),ie(ot),ie(at),ie(W5,8))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Y5=new he("cdk-focus-monitor-default-options"),Wf=Tu({passive:!0,capture:!0});let $f=(()=>{class n{constructor(t,i,r,s,o){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new wt,this._rootNodeFocusAndBlurListener=a=>{for(let c=Gs(a);c;c=c.parentElement)"focus"===a.type?this._onFocus(a,c):this._onBlur(a,c)},this._document=s,this._detectionMode=o?.detectionMode||0}monitor(t,i=!1){const r=Dl(t);if(!this._platform.isBrowser||1!==r.nodeType)return Ri(null);const s=function QG(n){if(function JG(){if(null==hv){const n=typeof document<"u"?document.head:null;hv=!(!n||!n.createShadowRoot&&!n.attachShadow)}return hv}()){const e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return i&&(o.checkChildren=!0),o.subject;const a={checkChildren:i,subject:new wt,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const i=Dl(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=Dl(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,l])=>this._originChanged(a,i,l)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=Gs(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,Wf),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,Wf)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Qi(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Wf),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Wf),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const s=t.labels;if(s)for(let o=0;o<s.length;o++)if(s[o].contains(i))return!0;return!1}}return n.\u0275fac=function(t){return new(t||n)(ie(ot),ie(Ji),ie(q5),ie(at,8),ie(Y5,8))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const NT="cdk-high-contrast-black-on-white",kT="cdk-high-contrast-white-on-black",bv="cdk-high-contrast-active";let K5=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=_t(L5).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(bv,NT,kT),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?t.add(bv,NT):2===i&&t.add(bv,kT)}}}return n.\u0275fac=function(t){return new(t||n)(ie(Ji),ie(at))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Z5=new he("cdk-dir-doc",{providedIn:"root",factory:function J5(){return _t(at)}}),Q5=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Fu=(()=>{class n{constructor(t){this.value="ltr",this.change=new It,t&&(this.value=function e8(n){const e=n?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?Q5.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(t){return new(t||n)(ie(Z5,8))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ou=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=wn({type:n}),n.\u0275inj=hn({}),n})();const n8=new he("mat-sanity-checks",{providedIn:"root",factory:function t8(){return!0}});let Gr=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!fv()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return n.\u0275fac=function(t){return new(t||n)(ie(K5),ie(n8,8),ie(at))},n.\u0275mod=wn({type:n}),n.\u0275inj=hn({imports:[Ou,Ou]}),n})();function xv(n){return class extends n{get disabled(){return this._disabled}set disabled(e){this._disabled=js(e)}constructor(...e){super(...e),this._disabled=!1}}}function wv(n,e){return class extends n{get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}constructor(...t){super(...t),this.defaultColor=e,this.color=e}}}function Mv(n){return class extends n{get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=js(e)}constructor(...e){super(...e),this._disableRipple=!1}}}class s8{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const UT=Tu({passive:!0,capture:!0});class o8{constructor(){this._events=new Map,this._delegateEventHandler=e=>{const t=Gs(e);t&&this._events.get(e.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,i,r){const s=this._events.get(t);if(s){const o=s.get(i);o?o.add(r):s.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,UT)})}removeHandler(e,t,i){const r=this._events.get(e);if(!r)return;const s=r.get(t);s&&(s.delete(i),0===s.size&&r.delete(t),0===r.size&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,UT)))}}const zT={enterDuration:225,exitDuration:150},HT=Tu({passive:!0,capture:!0}),GT=["mousedown","touchstart"],jT=["mouseup","mouseleave","touchend","touchcancel"];class Nu{constructor(e,t,i,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Dl(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={...zT,...i.animation};i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=i.radius||function l8(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),a=e-r.left,l=t-r.top,c=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=a-o+"px",u.style.top=l-o+"px",u.style.height=2*o+"px",u.style.width=2*o+"px",null!=i.color&&(u.style.backgroundColor=i.color),u.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(u);const d=window.getComputedStyle(u),f=d.transitionDuration,p="none"===d.transitionProperty||"0s"===f||"0s, 0s"===f||0===r.width&&0===r.height,m=new s8(this,u,i,p);u.style.transform="scale3d(1, 1, 1)",m.state=0,i.persistent||(this._mostRecentTransientRipple=m);let g=null;return!p&&(c||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const y=()=>this._finishRippleTransition(m),v=()=>this._destroyRipple(m);u.addEventListener("transitionend",y),u.addEventListener("transitioncancel",v),g={onTransitionEnd:y,onTransitionCancel:v}}),this._activeRipples.set(m,g),(p||!c)&&this._finishRippleTransition(m),m}fadeOutRipple(e){if(2===e.state||3===e.state)return;const t=e.element,i={...zT,...e.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=Dl(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,GT.forEach(i=>{Nu._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{jT.forEach(t=>{this._triggerElement.addEventListener(t,this,HT)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){0===e.state?this._startFadeOutTransition(e):2===e.state&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=1,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=yv(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!vv(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const e=this._triggerElement;e&&(GT.forEach(t=>Nu._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&jT.forEach(t=>e.removeEventListener(t,this,HT)))}}Nu._eventManager=new o8;const c8=new he("mat-ripple-global-options");let qf=(()=>{class n{get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}constructor(t,i,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new Nu(this,i,t,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}}return n.\u0275fac=function(t){return new(t||n)(U(Tt),U(ot),U(Ji),U(c8,8),U(Ml,8))},n.\u0275dir=De({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,i){2&t&&Ii("mat-ripple-unbounded",i.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),n})(),Sv=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=wn({type:n}),n.\u0275inj=hn({imports:[Gr,Gr]}),n})();const d8=["mat-icon-button",""],h8=["*"],f8=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],p8=wv(xv(Mv(class{constructor(n){this._elementRef=n}})));let m8=(()=>{class n extends p8{constructor(t,i,r,s){super(t),this._platform=i,this._ngZone=r,this._animationMode=s,this._focusMonitor=_t($f),this._isFab=!1;const o=t.nativeElement.classList;for(const a of f8)this._hasHostAttributes(a.selector)&&a.mdcClasses.forEach(l=>{o.add(l)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t="program",i){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,i):this._elementRef.nativeElement.focus(i)}_hasHostAttributes(...t){return t.some(i=>this._elementRef.nativeElement.hasAttribute(i))}_isRippleDisabled(){return this.disableRipple||this.disabled}}return n.\u0275fac=function(t){!function R_(){throw new Error("invalid")}()},n.\u0275dir=De({type:n,viewQuery:function(t,i){if(1&t&&Us(qf,5),2&t){let r;Xi(r=Yi())&&(i.ripple=r.first)}},features:[Xe]}),n})(),y8=(()=>{class n extends m8{constructor(t,i,r,s){super(t,i,r,s)}}return n.\u0275fac=function(t){return new(t||n)(U(Tt),U(Ji),U(ot),U(Ml,8))},n.\u0275cmp=Gi({type:n,selectors:[["button","mat-icon-button",""]],hostVars:7,hostBindings:function(t,i){2&t&&(Pn("disabled",i.disabled||null),Ii("_mat-animation-noopable","NoopAnimations"===i._animationMode)("mat-unthemed",!i.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Xe],attrs:d8,ngContentSelectors:h8,decls:5,vars:3,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(t,i){1&t&&(Bo(),Yn(0,"span",0),Bs(1),Yn(2,"span",1)(3,"span",2)(4,"span",3)),2&t&&(yi(3),fn("matRippleDisabled",i._isRippleDisabled())("matRippleCentered",!0)("matRippleTrigger",i._elementRef.nativeElement))},dependencies:[qf],styles:['.mdc-icon-button{font-size:24px;width:48px;height:48px;padding:12px}.mdc-icon-button .mdc-icon-button__focus-ring{max-height:48px;max-width:48px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__ripple{width:40px;height:40px;margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__focus-ring{max-height:40px;max-width:40px}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-icon-button svg,.mdc-icon-button img{width:24px;height:24px}.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size, 48px);width:var(--mdc-icon-button-state-layer-size, 48px);color:var(--mdc-icon-button-icon-color, inherit);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size, 24px);height:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity, 0.38)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color, #000)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),n})(),v8=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=wn({type:n}),n.\u0275inj=hn({imports:[Gr,Sv,Gr]}),n})();function Ev(...n){const e=ug(n),{args:t,keys:i}=CT(n),r=new Lt(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let u=0;u<o;u++){let d=!1;Rn(t[u]).subscribe(Gt(s,h=>{d||(d=!0,c--),a[u]=h},()=>l--,void 0,()=>{(!l||!d)&&(c||s.next(i?DT(i,a):a),s.complete())}))}});return e?r.pipe(_v(e)):r}function ku(n){return en((e,t)=>{let s,i=null,r=!1;i=e.subscribe(Gt(t,void 0,void 0,o=>{s=Rn(n(o,ku(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}class Cv{}class Ws{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let i=e[t];const r=t.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(r,i),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Ws?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Ws;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Ws?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class M8{encodeKey(e){return $T(e)}encodeValue(e){return $T(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const E8=/%(\d[a-f0-9])/gi,C8={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function $T(n){return encodeURIComponent(n).replace(E8,(e,t)=>C8[t]??e)}function Xf(n){return`${n}`}class $s{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new M8,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function S8(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(Xf):[Xf(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new $s({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Xf(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(Xf(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class D8{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function qT(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function XT(n){return typeof Blob<"u"&&n instanceof Blob}function YT(n){return typeof FormData<"u"&&n instanceof FormData}class Bu{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function A8(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new Ws),this.context||(this.context=new D8),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new $s,this.urlWithParams=t}serializeBody(){return null===this.body?null:qT(this.body)||XT(this.body)||YT(this.body)||function T8(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof $s?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||YT(this.body)?null:XT(this.body)?this.body.type||null:qT(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof $s?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let l=e.headers||this.headers,c=e.params||this.params;const u=e.context??this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((d,h)=>d.set(h,e.setHeaders[h]),l)),e.setParams&&(c=Object.keys(e.setParams).reduce((d,h)=>d.set(h,e.setParams[h]),c)),new Bu(t,i,s,{params:c,headers:l,context:u,reportProgress:a,responseType:r,withCredentials:o})}}var Un=(()=>((Un=Un||{})[Un.Sent=0]="Sent",Un[Un.UploadProgress=1]="UploadProgress",Un[Un.ResponseHeader=2]="ResponseHeader",Un[Un.DownloadProgress=3]="DownloadProgress",Un[Un.Response=4]="Response",Un[Un.User=5]="User",Un))();class I8{constructor(e,t=200,i="OK"){this.headers=e.headers||new Ws,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class Dv extends I8{constructor(e={}){super(e),this.type=Un.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Dv({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}function Av(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let Tv=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof Bu)s=t;else{let l,c;l=r.headers instanceof Ws?r.headers:new Ws(r.headers),r.params&&(c=r.params instanceof $s?r.params:new $s({fromObject:r.params})),s=new Bu(t,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=Ri(s).pipe(function w8(n,e){return st(e)?Na(n,e,1):Na(n,1)}(l=>this.handler.handle(l)));if(t instanceof Bu||"events"===r.observe)return o;const a=o.pipe(li(l=>l instanceof Dv));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(Nt(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(Nt(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(Nt(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(Nt(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new $s).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,Av(r,i))}post(t,i,r={}){return this.request("POST",t,Av(r,i))}put(t,i,r={}){return this.request("PUT",t,Av(r,i))}}return n.\u0275fac=function(t){return new(t||n)(ie(Cv))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac}),n})();const G8=["*"];let Kf;function Vu(n){return function j8(){if(void 0===Kf&&(Kf=null,typeof window<"u")){const n=window;void 0!==n.trustedTypes&&(Kf=n.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return Kf}()?.createHTML(n)||n}function r1(n){return Error(`Unable to find icon with the name "${n}"`)}function s1(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function o1(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}class $o{constructor(e,t,i){this.url=e,this.svgText=t,this.options=i}}let Zf=(()=>{class n{constructor(t,i,r,s){this._httpClient=t,this._sanitizer=i,this._errorHandler=s,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(t,i,r){return this.addSvgIconInNamespace("",t,i,r)}addSvgIconLiteral(t,i,r){return this.addSvgIconLiteralInNamespace("",t,i,r)}addSvgIconInNamespace(t,i,r,s){return this._addSvgIconConfig(t,i,new $o(r,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,i,r,s){const o=this._sanitizer.sanitize(xt.HTML,r);if(!o)throw o1(r);const a=Vu(o);return this._addSvgIconConfig(t,i,new $o("",a,s))}addSvgIconSet(t,i){return this.addSvgIconSetInNamespace("",t,i)}addSvgIconSetLiteral(t,i){return this.addSvgIconSetLiteralInNamespace("",t,i)}addSvgIconSetInNamespace(t,i,r){return this._addSvgIconSetConfig(t,new $o(i,null,r))}addSvgIconSetLiteralInNamespace(t,i,r){const s=this._sanitizer.sanitize(xt.HTML,i);if(!s)throw o1(i);const o=Vu(s);return this._addSvgIconSetConfig(t,new $o("",o,r))}registerFontClassAlias(t,i=t){return this._fontCssClassesByAlias.set(t,i),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const i=this._sanitizer.sanitize(xt.RESOURCE_URL,t);if(!i)throw s1(t);const r=this._cachedIconsByUrl.get(i);return r?Ri(Jf(r)):this._loadSvgIconFromConfig(new $o(t,null)).pipe(hs(s=>this._cachedIconsByUrl.set(i,s)),Nt(s=>Jf(s)))}getNamedSvgIcon(t,i=""){const r=a1(i,t);let s=this._svgIconConfigs.get(r);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(i,t),s)return this._svgIconConfigs.set(r,s),this._getSvgFromConfig(s);const o=this._iconSetConfigs.get(i);return o?this._getSvgFromIconSetConfigs(t,o):function b8(n,e){const t=st(n)?n:()=>n,i=r=>r.error(t());return new Lt(e?r=>e.schedule(i,0,r):i)}(r1(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?Ri(Jf(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(Nt(i=>Jf(i)))}_getSvgFromIconSetConfigs(t,i){const r=this._extractIconWithNameFromAnySet(t,i);return r?Ri(r):Ev(i.filter(o=>!o.svgText).map(o=>this._loadSvgIconSetFromConfig(o).pipe(ku(a=>{const c=`Loading icon set URL: ${this._sanitizer.sanitize(xt.RESOURCE_URL,o.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(c)),Ri(null)})))).pipe(Nt(()=>{const o=this._extractIconWithNameFromAnySet(t,i);if(!o)throw r1(t);return o}))}_extractIconWithNameFromAnySet(t,i){for(let r=i.length-1;r>=0;r--){const s=i[r];if(s.svgText&&s.svgText.toString().indexOf(t)>-1){const o=this._svgElementFromConfig(s),a=this._extractSvgIconFromSet(o,t,s.options);if(a)return a}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(hs(i=>t.svgText=i),Nt(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?Ri(null):this._fetchIcon(t).pipe(hs(i=>t.svgText=i))}_extractSvgIconFromSet(t,i,r){const s=t.querySelector(`[id="${i}"]`);if(!s)return null;const o=s.cloneNode(!0);if(o.removeAttribute("id"),"svg"===o.nodeName.toLowerCase())return this._setSvgAttributes(o,r);if("symbol"===o.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(o),r);const a=this._svgElementFromString(Vu("<svg></svg>"));return a.appendChild(o),this._setSvgAttributes(a,r)}_svgElementFromString(t){const i=this._document.createElement("DIV");i.innerHTML=t;const r=i.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const i=this._svgElementFromString(Vu("<svg></svg>")),r=t.attributes;for(let s=0;s<r.length;s++){const{name:o,value:a}=r[s];"id"!==o&&i.setAttribute(o,a)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&i.appendChild(t.childNodes[s].cloneNode(!0));return i}_setSvgAttributes(t,i){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),i&&i.viewBox&&t.setAttribute("viewBox",i.viewBox),t}_fetchIcon(t){const{url:i,options:r}=t,s=r?.withCredentials??!1;if(!this._httpClient)throw function W8(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==i)throw Error(`Cannot fetch icon from URL "${i}".`);const o=this._sanitizer.sanitize(xt.RESOURCE_URL,i);if(!o)throw s1(i);const a=this._inProgressUrlFetches.get(o);if(a)return a;const l=this._httpClient.get(o,{responseType:"text",withCredentials:s}).pipe(Nt(c=>Vu(c)),function x8(n){return en((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}(()=>this._inProgressUrlFetches.delete(o)),Tc());return this._inProgressUrlFetches.set(o,l),l}_addSvgIconConfig(t,i,r){return this._svgIconConfigs.set(a1(t,i),r),this}_addSvgIconSetConfig(t,i){const r=this._iconSetConfigs.get(t);return r?r.push(i):this._iconSetConfigs.set(t,[i]),this}_svgElementFromConfig(t){if(!t.svgElement){const i=this._svgElementFromString(t.svgText);this._setSvgAttributes(i,t.options),t.svgElement=i}return t.svgElement}_getIconConfigFromResolvers(t,i){for(let r=0;r<this._resolvers.length;r++){const s=this._resolvers[r](i,t);if(s)return q8(s)?new $o(s.url,null,s.options):new $o(s,null)}}}return n.\u0275fac=function(t){return new(t||n)(ie(Tv,8),ie(cv),ie(at,8),ie(rs))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Jf(n){return n.cloneNode(!0)}function a1(n,e){return n+":"+e}function q8(n){return!(!n.url||!n.options)}const X8=wv(class{constructor(n){this._elementRef=n}}),Y8=new he("MAT_ICON_DEFAULT_OPTIONS"),K8=new he("mat-icon-location",{providedIn:"root",factory:function Z8(){const n=_t(at),e=n?n.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),l1=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],J8=l1.map(n=>`[${n}]`).join(", "),Q8=/^url\(['"]?#(.*?)['"]?\)$/;let Rv,ej=(()=>{class n extends X8{get inline(){return this._inline}set inline(t){this._inline=js(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const i=this._cleanupFontValue(t);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const i=this._cleanupFontValue(t);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}constructor(t,i,r,s,o,a){super(t),this._iconRegistry=i,this._location=s,this._errorHandler=o,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=qt.EMPTY,a&&(a.color&&(this.color=this.defaultColor=a.color),a.fontSet&&(this.fontSet=a.fontSet)),r||t.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(t){if(!t)return["",""];const i=t.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let i=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const r=t.childNodes[i];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,i=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>t.classList.remove(r)),i.forEach(r=>t.classList.add(r)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&!i.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const i=this._elementsWithExternalReferences;i&&i.forEach((r,s)=>{r.forEach(o=>{s.setAttribute(o.name,`url('${t}#${o.value}')`)})})}_cacheChildrenWithExternalReferences(t){const i=t.querySelectorAll(J8),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<i.length;s++)l1.forEach(o=>{const a=i[s],l=a.getAttribute(o),c=l?l.match(Q8):null;if(c){let u=r.get(a);u||(u=[],r.set(a,u)),u.push({name:o,value:c[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[i,r]=this._splitIconName(t);i&&(this._svgNamespace=i),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,i).pipe(fs(1)).subscribe(s=>this._setSvgElement(s),s=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${r}! ${s.message}`))})}}}return n.\u0275fac=function(t){return new(t||n)(U(Tt),U(Zf),function Hc(n){return function ak(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(wM(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(Vn(),n)}("aria-hidden"),U(K8),U(rs),U(Y8,8))},n.\u0275cmp=Gi({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(t,i){2&t&&(Pn("data-mat-icon-type",i._usingFontIcon()?"font":"svg")("data-mat-icon-name",i._svgName||i.fontIcon)("data-mat-icon-namespace",i._svgNamespace||i.fontSet)("fontIcon",i._usingFontIcon()?i.fontIcon:null),Ii("mat-icon-inline",i.inline)("mat-icon-no-color","primary"!==i.color&&"accent"!==i.color&&"warn"!==i.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[Xe],ngContentSelectors:G8,decls:1,vars:0,template:function(t,i){1&t&&(Bo(),Bs(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),n})(),tj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=wn({type:n}),n.\u0275inj=hn({imports:[Gr,Gr]}),n})(),nj=1;const Qf={};function c1(n){return n in Qf&&(delete Qf[n],!0)}const ij={setImmediate(n){const e=nj++;return Qf[e]=!0,Rv||(Rv=Promise.resolve()),Rv.then(()=>c1(e)&&n()),e},clearImmediate(n){c1(n)}},{setImmediate:rj,clearImmediate:sj}=ij,ep={setImmediate(...n){const{delegate:e}=ep;return(e?.setImmediate||rj)(...n)},clearImmediate(n){const{delegate:e}=ep;return(e?.clearImmediate||sj)(n)},delegate:void 0},Pv=new class aj extends Uf{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class oj extends Vf{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=ep.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(ep.clearImmediate(t),e._scheduled=void 0)}});function tp(n,e){return en((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(Gt(i,l=>{r?.unsubscribe();let c=0;const u=s++;Rn(n(l,u)).subscribe(r=Gt(i,d=>i.next(e?e(l,d,u,c++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function u1(n,e){return e?t=>jf(e.pipe(fs(1),function lj(){return en((n,e)=>{n.subscribe(Gt(e,La))})}()),t.pipe(u1(n))):Na((t,i)=>Rn(n(t,i)).pipe(fs(1),function cj(n){return Nt(()=>n)}(t)))}function Fv(n=0,e,t=v5){let i=-1;return null!=e&&(kw(e)?t=e:i=e),new Lt(r=>{let s=function uj(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}function d1(n,e=zf){const t=Fv(n,e);return u1(()=>t)}class Ov{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class dj extends Ov{constructor(e,t,i,r,s){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=s}}class h1 extends Ov{constructor(e,t,i,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class hj extends Ov{constructor(e){super(),this.element=e instanceof Tt?e.nativeElement:e}}class fj{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof dj?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof h1?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof hj?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class pj extends fj{constructor(e,t,i,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=o=>{const a=o.element,l=this._document.createComment("dom-portal");a.parentNode.insertBefore(l,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(a,l)})},this._document=s}attachComponentPortal(e){const i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(e.injector||this._defaultInjector||hr.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=e,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let mj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=wn({type:n}),n.\u0275inj=hn({}),n})();const gj=["addListener","removeListener"],_j=["addEventListener","removeEventListener"],yj=["on","off"];function qo(n,e,t,i){if(st(t)&&(i=t,t=void 0),i)return qo(n,e,t).pipe(_v(i));const[r,s]=function xj(n){return st(n.addEventListener)&&st(n.removeEventListener)}(n)?_j.map(o=>a=>n[o](e,a,t)):function vj(n){return st(n.addListener)&&st(n.removeListener)}(n)?gj.map(f1(n,e)):function bj(n){return st(n.on)&&st(n.off)}(n)?yj.map(f1(n,e)):[];if(!r&&lg(n))return Na(o=>qo(o,e,t))(Rn(n));if(!r)throw new TypeError("Invalid event target");return new Lt(o=>{const a=(...l)=>o.next(1<l.length?l:l[0]);return r(a),()=>s(a)})}function f1(n,e){return t=>i=>n[t](e,i)}const Uu={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=Uu;i&&(e=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=e(s=>{t=void 0,n(s)});return new qt(()=>t?.(r))},requestAnimationFrame(...n){const{delegate:e}=Uu;return(e?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:e}=Uu;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0},Sj=new class Mj extends Uf{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class wj extends Vf{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=Uu.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(Uu.cancelAnimationFrame(t),e._scheduled=void 0)}});function Lv(n,e=zf){return function Ej(n){return en((e,t)=>{let i=!1,r=null,s=null,o=!1;const a=()=>{if(s?.unsubscribe(),s=null,i){i=!1;const c=r;r=null,t.next(c)}o&&t.complete()},l=()=>{s=null,o&&t.complete()};e.subscribe(Gt(t,c=>{i=!0,r=c,s||Rn(n(c)).subscribe(s=Gt(t,a,l))},()=>{o=!0,(!i||!s||s.closed)&&t.complete()}))})}(()=>Fv(n,e))}const Cj=["contentWrapper"],Dj=["*"],Aj=new he("VIRTUAL_SCROLL_STRATEGY");let np=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new wt,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new Lt(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(Lv(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Ri()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(li(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=Dl(i),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>qo(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(t){return new(t||n)(ie(ot),ie(Ji),ie(at,8))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),p1=(()=>{class n{constructor(t,i,r,s){this.elementRef=t,this.scrollDispatcher=i,this.ngZone=r,this.dir=s,this._destroyed=new wt,this._elementScrolled=new Lt(o=>this.ngZone.runOutsideAngular(()=>qo(this.elementRef.nativeElement,"scroll").pipe(Qi(this._destroyed)).subscribe(o)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const i=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=r?t.end:t.start),null==t.right&&(t.right=r?t.start:t.end),null!=t.bottom&&(t.top=i.scrollHeight-i.clientHeight-t.bottom),r&&0!=Iu()?(null!=t.left&&(t.right=i.scrollWidth-i.clientWidth-t.left),2==Iu()?t.left=t.right:1==Iu()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=i.scrollWidth-i.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const i=this.elementRef.nativeElement;xT()?i.scrollTo(t):(null!=t.top&&(i.scrollTop=t.top),null!=t.left&&(i.scrollLeft=t.left))}measureScrollOffset(t){const i="left",r="right",s=this.elementRef.nativeElement;if("top"==t)return s.scrollTop;if("bottom"==t)return s.scrollHeight-s.clientHeight-s.scrollTop;const o=this.dir&&"rtl"==this.dir.value;return"start"==t?t=o?r:i:"end"==t&&(t=o?i:r),o&&2==Iu()?t==i?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:o&&1==Iu()?t==i?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:t==i?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}}return n.\u0275fac=function(t){return new(t||n)(U(Tt),U(np),U(ot),U(Fu,8))},n.\u0275dir=De({type:n,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0}),n})(),Nv=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new wt,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(Lv(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(t){return new(t||n)(ie(Ji),ie(ot),ie(at,8))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const m1=new he("VIRTUAL_SCROLLABLE");let Rj=(()=>{class n extends p1{constructor(t,i,r,s){super(t,i,r,s)}measureViewportSize(t){const i=this.elementRef.nativeElement;return"horizontal"===t?i.clientWidth:i.clientHeight}}return n.\u0275fac=function(t){return new(t||n)(U(Tt),U(np),U(ot),U(Fu,8))},n.\u0275dir=De({type:n,features:[Xe]}),n})();const Fj=typeof requestAnimationFrame<"u"?Sj:Pv;let Oj=(()=>{class n extends Rj{get orientation(){return this._orientation}set orientation(t){this._orientation!==t&&(this._orientation=t,this._calculateSpacerSize())}get appendOnly(){return this._appendOnly}set appendOnly(t){this._appendOnly=js(t)}constructor(t,i,r,s,o,a,l,c){super(t,a,r,o),this.elementRef=t,this._changeDetectorRef=i,this._scrollStrategy=s,this.scrollable=c,this._platform=_t(Ji),this._detachedSubject=new wt,this._renderedRangeSubject=new wt,this._orientation="vertical",this._appendOnly=!1,this.scrolledIndexChange=new Lt(u=>this._scrollStrategy.scrolledIndexChange.subscribe(d=>Promise.resolve().then(()=>this.ngZone.run(()=>u.next(d))))),this.renderedRangeStream=this._renderedRangeSubject,this._totalContentSize=0,this._totalContentWidth="",this._totalContentHeight="",this._renderedRange={start:0,end:0},this._dataLength=0,this._viewportSize=0,this._renderedContentOffset=0,this._renderedContentOffsetNeedsRewrite=!1,this._isChangeDetectionPending=!1,this._runAfterChangeDetection=[],this._viewportChanges=qt.EMPTY,this._viewportChanges=l.change().subscribe(()=>{this.checkViewportSize()}),this.scrollable||(this.elementRef.nativeElement.classList.add("cdk-virtual-scrollable"),this.scrollable=this)}ngOnInit(){this._platform.isBrowser&&(this.scrollable===this&&super.ngOnInit(),this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._measureViewportSize(),this._scrollStrategy.attach(this),this.scrollable.elementScrolled().pipe(Wo(null),Lv(0,Fj)).subscribe(()=>this._scrollStrategy.onContentScrolled()),this._markChangeDetectionNeeded()})))}ngOnDestroy(){this.detach(),this._scrollStrategy.detach(),this._renderedRangeSubject.complete(),this._detachedSubject.complete(),this._viewportChanges.unsubscribe(),super.ngOnDestroy()}attach(t){this.ngZone.runOutsideAngular(()=>{this._forOf=t,this._forOf.dataStream.pipe(Qi(this._detachedSubject)).subscribe(i=>{const r=i.length;r!==this._dataLength&&(this._dataLength=r,this._scrollStrategy.onDataLengthChanged()),this._doChangeDetection()})})}detach(){this._forOf=null,this._detachedSubject.next()}getDataLength(){return this._dataLength}getViewportSize(){return this._viewportSize}getRenderedRange(){return this._renderedRange}measureBoundingClientRectWithScrollOffset(t){return this.getElementRef().nativeElement.getBoundingClientRect()[t]}setTotalContentSize(t){this._totalContentSize!==t&&(this._totalContentSize=t,this._calculateSpacerSize(),this._markChangeDetectionNeeded())}setRenderedRange(t){(function Pj(n,e){return n.start==e.start&&n.end==e.end})(this._renderedRange,t)||(this.appendOnly&&(t={start:0,end:Math.max(this._renderedRange.end,t.end)}),this._renderedRangeSubject.next(this._renderedRange=t),this._markChangeDetectionNeeded(()=>this._scrollStrategy.onContentRendered()))}getOffsetToRenderedContentStart(){return this._renderedContentOffsetNeedsRewrite?null:this._renderedContentOffset}setRenderedContentOffset(t,i="to-start"){t=this.appendOnly&&"to-start"===i?0:t;const s="horizontal"==this.orientation,o=s?"X":"Y";let l=`translate${o}(${Number((s&&this.dir&&"rtl"==this.dir.value?-1:1)*t)}px)`;this._renderedContentOffset=t,"to-end"===i&&(l+=` translate${o}(-100%)`,this._renderedContentOffsetNeedsRewrite=!0),this._renderedContentTransform!=l&&(this._renderedContentTransform=l,this._markChangeDetectionNeeded(()=>{this._renderedContentOffsetNeedsRewrite?(this._renderedContentOffset-=this.measureRenderedContentSize(),this._renderedContentOffsetNeedsRewrite=!1,this.setRenderedContentOffset(this._renderedContentOffset)):this._scrollStrategy.onRenderedOffsetChanged()}))}scrollToOffset(t,i="auto"){const r={behavior:i};"horizontal"===this.orientation?r.start=t:r.top=t,this.scrollable.scrollTo(r)}scrollToIndex(t,i="auto"){this._scrollStrategy.scrollToIndex(t,i)}measureScrollOffset(t){let i;return i=this.scrollable==this?r=>super.measureScrollOffset(r):r=>this.scrollable.measureScrollOffset(r),Math.max(0,i(t??("horizontal"===this.orientation?"start":"top"))-this.measureViewportOffset())}measureViewportOffset(t){let i;const r="left",s="right",o="rtl"==this.dir?.value;i="start"==t?o?s:r:"end"==t?o?r:s:t||("horizontal"===this.orientation?"left":"top");const a=this.scrollable.measureBoundingClientRectWithScrollOffset(i);return this.elementRef.nativeElement.getBoundingClientRect()[i]-a}measureRenderedContentSize(){const t=this._contentWrapper.nativeElement;return"horizontal"===this.orientation?t.offsetWidth:t.offsetHeight}measureRangeSize(t){return this._forOf?this._forOf.measureRangeSize(t,this.orientation):0}checkViewportSize(){this._measureViewportSize(),this._scrollStrategy.onDataLengthChanged()}_measureViewportSize(){this._viewportSize=this.scrollable.measureViewportSize(this.orientation)}_markChangeDetectionNeeded(t){t&&this._runAfterChangeDetection.push(t),this._isChangeDetectionPending||(this._isChangeDetectionPending=!0,this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._doChangeDetection()})))}_doChangeDetection(){this._isChangeDetectionPending=!1,this._contentWrapper.nativeElement.style.transform=this._renderedContentTransform,this.ngZone.run(()=>this._changeDetectorRef.markForCheck());const t=this._runAfterChangeDetection;this._runAfterChangeDetection=[];for(const i of t)i()}_calculateSpacerSize(){this._totalContentHeight="horizontal"===this.orientation?"":`${this._totalContentSize}px`,this._totalContentWidth="horizontal"===this.orientation?`${this._totalContentSize}px`:""}}return n.\u0275fac=function(t){return new(t||n)(U(Tt),U(Zn),U(ot),U(Aj,8),U(Fu,8),U(np),U(Nv),U(m1,8))},n.\u0275cmp=Gi({type:n,selectors:[["cdk-virtual-scroll-viewport"]],viewQuery:function(t,i){if(1&t&&Us(Cj,7),2&t){let r;Xi(r=Yi())&&(i._contentWrapper=r.first)}},hostAttrs:[1,"cdk-virtual-scroll-viewport"],hostVars:4,hostBindings:function(t,i){2&t&&Ii("cdk-virtual-scroll-orientation-horizontal","horizontal"===i.orientation)("cdk-virtual-scroll-orientation-vertical","horizontal"!==i.orientation)},inputs:{orientation:"orientation",appendOnly:"appendOnly"},outputs:{scrolledIndexChange:"scrolledIndexChange"},standalone:!0,features:[Ct([{provide:p1,useFactory:(e,t)=>e||t,deps:[[new ks,new Ph(m1)],n]}]),Xe,hu],ngContentSelectors:Dj,decls:4,vars:4,consts:[[1,"cdk-virtual-scroll-content-wrapper"],["contentWrapper",""],[1,"cdk-virtual-scroll-spacer"]],template:function(t,i){1&t&&(Bo(),pt(0,"div",0,1),Bs(2),Ot(),Yn(3,"div",2)),2&t&&(yi(3),af("width",i._totalContentWidth)("height",i._totalContentHeight))},styles:["cdk-virtual-scroll-viewport{display:block;position:relative;transform:translateZ(0)}.cdk-virtual-scrollable{overflow:auto;will-change:scroll-position;contain:strict;-webkit-overflow-scrolling:touch}.cdk-virtual-scroll-content-wrapper{position:absolute;top:0;left:0;contain:content}[dir=rtl] .cdk-virtual-scroll-content-wrapper{right:0;left:auto}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper{min-height:100%}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-left:0;padding-right:0;margin-left:0;margin-right:0;border-left-width:0;border-right-width:0;outline:none}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:100%}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;border-top-width:0;border-bottom-width:0;outline:none}.cdk-virtual-scroll-spacer{height:1px;transform-origin:0 0;flex:0 0 auto}[dir=rtl] .cdk-virtual-scroll-spacer{transform-origin:100% 0}"],encapsulation:2,changeDetection:0}),n})(),kv=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=wn({type:n}),n.\u0275inj=hn({}),n})(),g1=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=wn({type:n}),n.\u0275inj=hn({imports:[Ou,kv,Oj,Ou,kv]}),n})();const _1=xT();class Lj{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=_n(-this._previousScrollPosition.left),e.style.top=_n(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,i=e.style,r=this._document.body.style,s=i.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),_1&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),_1&&(i.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class Nj{constructor(e,t,i,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0).pipe(li(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class y1{enable(){}disable(){}attach(){}}function Bv(n,e){return e.some(t=>n.bottom<t.top||n.top>t.bottom||n.right<t.left||n.left>t.right)}function v1(n,e){return e.some(t=>n.top<t.top||n.bottom>t.bottom||n.left<t.left||n.right>t.right)}class kj{constructor(e,t,i,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();Bv(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let Bj=(()=>{class n{constructor(t,i,r,s){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new y1,this.close=o=>new Nj(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new Lj(this._viewportRuler,this._document),this.reposition=o=>new kj(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}}return n.\u0275fac=function(t){return new(t||n)(ie(np),ie(Nv),ie(ot),ie(at))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class b1{constructor(e){if(this.scrollStrategy=new y1,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const i of t)void 0!==e[i]&&(this[i]=e[i])}}}class Vj{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let x1=(()=>{class n{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}}return n.\u0275fac=function(t){return new(t||n)(ie(at))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Uj=(()=>{class n extends x1{constructor(t,i){super(t),this._ngZone=i,this._keydownListener=r=>{const s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){const a=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>a.next(r)):a.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return n.\u0275fac=function(t){return new(t||n)(ie(at),ie(ot,8))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),zj=(()=>{class n extends x1{constructor(t,i,r){super(t),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=Gs(s)},this._clickListener=s=>{const o=Gs(s),a="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;const l=this._attachedOverlays.slice();for(let c=l.length-1;c>-1;c--){const u=l[c];if(u._outsidePointerEvents.observers.length<1||!u.hasAttached())continue;if(u.overlayElement.contains(o)||u.overlayElement.contains(a))break;const d=u._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>d.next(s)):d.next(s)}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}}return n.\u0275fac=function(t){return new(t||n)(ie(at),ie(Ji),ie(ot,8))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),w1=(()=>{class n{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||fv()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const i=this._document.createElement("div");i.classList.add(t),fv()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}}return n.\u0275fac=function(t){return new(t||n)(ie(at),ie(Ji))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Hj{constructor(e,t,i,r,s,o,a,l,c,u=!1){this._portalOutlet=e,this._host=t,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=l,this._outsideClickDispatcher=c,this._animationsDisabled=u,this._backdropElement=null,this._backdropClick=new wt,this._attachments=new wt,this._detachments=new wt,this._locationChanges=qt.EMPTY,this._backdropClickHandler=d=>this._backdropClick.next(d),this._backdropTransitionendHandler=d=>{this._disposeBackdrop(d.target)},this._keydownEvents=new wt,this._outsidePointerEvents=new wt,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(fs(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=_n(this._config.width),e.height=_n(this._config.height),e.minWidth=_n(this._config.minWidth),e.minHeight=_n(this._config.minHeight),e.maxWidth=_n(this._config.maxWidth),e.maxHeight=_n(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,i){const r=Gf(t||[]).filter(s=>!!s);r.length&&(i?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(Qi(Os(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const M1="cdk-overlay-connected-position-bounding-box",Gj=/([A-Za-z%]+)$/;class jj{get positions(){return this._preferredPositions}constructor(e,t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new wt,this._resizeSubscription=qt.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._validatePositions(),e.hostElement.classList.add(M1),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,s=[];let o;for(let a of this._preferredPositions){let l=this._getOriginPoint(e,r,a),c=this._getOverlayPoint(l,t,a),u=this._getOverlayFit(c,t,i,a);if(u.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(a,l);this._canFitWithFlexibleDimensions(u,c,i)?s.push({position:a,origin:l,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(l,a)}):(!o||o.overlayFit.visibleArea<u.visibleArea)&&(o={overlayFit:u,overlayPoint:c,originPoint:l,position:a,overlayRect:t})}if(s.length){let a=null,l=-1;for(const c of s){const u=c.boundingBoxRect.width*c.boundingBoxRect.height*(c.position.weight||1);u>l&&(l=u,a=c)}return this._isPushed=!1,void this._applyPosition(a.position,a.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Xo(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(M1),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,i){let r,s;if("center"==i.originX)r=e.left+e.width/2;else{const o=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;r="start"==i.originX?o:a}return t.left<0&&(r-=t.left),s="center"==i.originY?e.top+e.height/2:"top"==i.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,i){let r,s;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,i,r){const s=E1(t);let{x:o,y:a}=e,l=this._getOffset(r,"x"),c=this._getOffset(r,"y");l&&(o+=l),c&&(a+=c);let h=0-a,f=a+s.height-i.height,p=this._subtractOverflows(s.width,0-o,o+s.width-i.width),m=this._subtractOverflows(s.height,h,f),g=p*m;return{visibleArea:g,isCompletelyWithinViewport:s.width*s.height===g,fitsInViewportVertically:m===s.height,fitsInViewportHorizontally:p==s.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,s=i.right-t.x,o=S1(this._overlayRef.getConfig().minHeight),a=S1(this._overlayRef.getConfig().minWidth);return(e.fitsInViewportVertically||null!=o&&o<=r)&&(e.fitsInViewportHorizontally||null!=a&&a<=s)}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=E1(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),a=Math.max(e.y+r.height-s.height,0),l=Math.max(s.top-i.top-e.y,0),c=Math.max(s.left-i.left-e.x,0);let u=0,d=0;return u=r.width<=s.width?c||-o:e.x<this._viewportMargin?s.left-i.left-e.x:0,d=r.height<=s.height?l||-a:e.y<this._viewportMargin?s.top-i.top-e.y:0,this._previousPushAmount={x:u,y:d},{x:e.x+u,y:e.y+d}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const i=this._getScrollVisibility(),r=new Vj(e,i);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=e.overlayY;i="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(e,t){const i=this._viewportRect,r=this._isRtl();let s,o,a,u,d,h;if("top"===t.overlayY)o=e.y,s=i.height-o+this._viewportMargin;else if("bottom"===t.overlayY)a=i.height-e.y+2*this._viewportMargin,s=i.height-a+this._viewportMargin;else{const f=Math.min(i.bottom-e.y+i.top,e.y),p=this._lastBoundingBoxSize.height;s=2*f,o=e.y-f,s>p&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-p/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)h=i.width-e.x+this._viewportMargin,u=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)d=e.x,u=i.right-e.x;else{const f=Math.min(i.right-e.x+i.left,e.x),p=this._lastBoundingBoxSize.width;u=2*f,d=e.x-f,u>p&&!this._isInitialRender&&!this._growAfterOpen&&(d=e.x-p/2)}return{top:o,left:d,bottom:a,right:h,width:u,height:s}}_setBoundingBoxStyles(e,t){const i=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=_n(i.height),r.top=_n(i.top),r.bottom=_n(i.bottom),r.width=_n(i.width),r.left=_n(i.left),r.right=_n(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=_n(s)),o&&(r.maxWidth=_n(o))}this._lastBoundingBoxSize=i,Xo(this._boundingBox.style,r)}_resetBoundingBoxStyles(){Xo(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Xo(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const u=this._viewportRuler.getViewportScrollPosition();Xo(i,this._getExactOverlayY(t,e,u)),Xo(i,this._getExactOverlayX(t,e,u))}else i.position="static";let a="",l=this._getOffset(t,"x"),c=this._getOffset(t,"y");l&&(a+=`translateX(${l}px) `),c&&(a+=`translateY(${c}px)`),i.transform=a.trim(),o.maxHeight&&(r?i.maxHeight=_n(o.maxHeight):s&&(i.maxHeight="")),o.maxWidth&&(r?i.maxWidth=_n(o.maxWidth):s&&(i.maxWidth="")),Xo(this._pane.style,i)}_getExactOverlayY(e,t,i){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=_n(s.y),r}_getExactOverlayX(e,t,i){let o,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),o=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===o?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=_n(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:v1(e,i),isOriginOutsideView:Bv(e,i),isOverlayClipped:v1(t,i),isOverlayOutsideView:Bv(t,i)}}_subtractOverflows(e,...t){return t.reduce((i,r)=>i-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&Gf(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof Tt)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}}function Xo(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function S1(n){if("number"!=typeof n&&null!=n){const[e,t]=n.split(Gj);return t&&"px"!==t?null:parseFloat(e)}return n||null}function E1(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const C1="cdk-global-overlay-wrapper";class Wj{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(C1),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:a}=i,l=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),c=!("100%"!==s&&"100vh"!==s||a&&"100%"!==a&&"100vh"!==a),u=this._xPosition,d=this._xOffset,h="rtl"===this._overlayRef.getConfig().direction;let f="",p="",m="";l?m="flex-start":"center"===u?(m="center",h?p=d:f=d):h?"left"===u||"end"===u?(m="flex-end",f=d):("right"===u||"start"===u)&&(m="flex-start",p=d):"left"===u||"start"===u?(m="flex-start",f=d):("right"===u||"end"===u)&&(m="flex-end",p=d),e.position=this._cssPosition,e.marginLeft=l?"0":f,e.marginTop=c?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=l?"0":p,t.justifyContent=m,t.alignItems=c?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(C1),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let $j=(()=>{class n{constructor(t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new Wj}flexibleConnectedTo(t){return new jj(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return n.\u0275fac=function(t){return new(t||n)(ie(Nv),ie(at),ie(Ji),ie(w1))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),qj=0,ip=(()=>{class n{constructor(t,i,r,s,o,a,l,c,u,d,h,f){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=a,this._ngZone=l,this._document=c,this._directionality=u,this._location=d,this._outsideClickDispatcher=h,this._animationsModuleType=f}create(t){const i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),o=new b1(t);return o.direction=o.direction||this._directionality.value,new Hj(s,i,r,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+qj++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(yu)),new pj(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return n.\u0275fac=function(t){return new(t||n)(ie(Bj),ie(w1),ie(eu),ie($j),ie(Uj),ie(hr),ie(ot),ie(at),ie(Fu),ie(EA),ie(zj),ie(Ml,8))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Kj={provide:new he("cdk-connected-overlay-scroll-strategy"),deps:[ip],useFactory:function Yj(n){return()=>n.scrollStrategies.reposition()}};let Zj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=wn({type:n}),n.\u0275inj=hn({providers:[ip,Kj],imports:[Ou,mj,g1,g1]}),n})();const Jj=["mat-menu-item",""];function Qj(n,e){1&n&&(function Og(){We.lFrame.currentNamespace=rM}(),pt(0,"svg",3),Yn(1,"polygon",4),Ot())}const eW=[[["mat-icon"],["","matMenuItemIcon",""]],"*"],tW=["mat-icon, [matMenuItemIcon]","*"];function nW(n,e){if(1&n){const t=nf();pt(0,"div",0),pn("keydown",function(r){return Co(t),Do(as()._handleKeydown(r))})("click",function(){return Co(t),Do(as().closed.emit("click"))})("@transformMenu.start",function(r){return Co(t),Do(as()._onAnimationStart(r))})("@transformMenu.done",function(r){return Co(t),Do(as()._onAnimationDone(r))}),pt(1,"div",1),Bs(2),Ot()()}if(2&n){const t=as();fn("id",t.panelId)("ngClass",t._classList)("@transformMenu",t._panelAnimationState),Pn("aria-label",t.ariaLabel||null)("aria-labelledby",t.ariaLabelledby||null)("aria-describedby",t.ariaDescribedby||null)}}const iW=["*"],Vv=new he("MAT_MENU_PANEL"),rW=Mv(xv(class{}));let rp=(()=>{class n extends rW{constructor(t,i,r,s,o){super(),this._elementRef=t,this._document=i,this._focusMonitor=r,this._parentMenu=s,this._changeDetectorRef=o,this.role="menuitem",this._hovered=new wt,this._focused=new wt,this._highlighted=!1,this._triggersSubmenu=!1,s?.addItem?.(this)}focus(t,i){this._focusMonitor&&t?this._focusMonitor.focusVia(this._getHostElement(),t,i):this._getHostElement().focus(i),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(t){this.disabled&&(t.preventDefault(),t.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){const t=this._elementRef.nativeElement.cloneNode(!0),i=t.querySelectorAll("mat-icon, .material-icons");for(let r=0;r<i.length;r++)i[r].remove();return t.textContent?.trim()||""}_setHighlighted(t){this._highlighted=t,this._changeDetectorRef?.markForCheck()}_setTriggersSubmenu(t){this._triggersSubmenu=t,this._changeDetectorRef?.markForCheck()}_hasFocus(){return this._document&&this._document.activeElement===this._getHostElement()}}return n.\u0275fac=function(t){return new(t||n)(U(Tt),U(at),U($f),U(Vv,8),U(Zn))},n.\u0275cmp=Gi({type:n,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-mdc-menu-item","mat-mdc-focus-indicator","mdc-list-item"],hostVars:8,hostBindings:function(t,i){1&t&&pn("click",function(s){return i._checkDisabled(s)})("mouseenter",function(){return i._handleMouseEnter()}),2&t&&(Pn("role",i.role)("tabindex",i._getTabIndex())("aria-disabled",i.disabled)("disabled",i.disabled||null),Ii("mat-mdc-menu-item-highlighted",i._highlighted)("mat-mdc-menu-item-submenu-trigger",i._triggersSubmenu))},inputs:{disabled:"disabled",disableRipple:"disableRipple",role:"role"},exportAs:["matMenuItem"],features:[Xe],attrs:Jj,ngContentSelectors:tW,decls:5,vars:3,consts:[[1,"mdc-list-item__primary-text"],["matRipple","",1,"mat-mdc-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["class","mat-mdc-menu-submenu-icon","viewBox","0 0 5 10","focusable","false",4,"ngIf"],["viewBox","0 0 5 10","focusable","false",1,"mat-mdc-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(t,i){1&t&&(Bo(eW),Bs(0),pt(1,"span",0),Bs(2,1),Ot(),Yn(3,"div",1),su(4,Qj,2,0,"svg",2)),2&t&&(yi(3),fn("matRippleDisabled",i.disableRipple||i.disabled)("matRippleTrigger",i._getHostElement()),yi(1),fn("ngIf",i._triggersSubmenu))},dependencies:[Xy,qf],encapsulation:2,changeDetection:0}),n})();const sW=new he("MatMenuContent"),sp={transformMenu:Nf("transformMenu",[El("void",yr({opacity:0,transform:"scale(0.8)"})),Cu("void => enter",Eu("120ms cubic-bezier(0, 0, 0.2, 1)",yr({opacity:1,transform:"scale(1)"}))),Cu("* => void",Eu("100ms 25ms linear",yr({opacity:0})))]),fadeInItems:Nf("fadeInItems",[El("showing",yr({opacity:1})),Cu("void => *",[yr({opacity:0}),Eu("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let oW=0;const D1=new he("mat-menu-default-options",{providedIn:"root",factory:function aW(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}});let zu=(()=>{class n{get xPosition(){return this._xPosition}set xPosition(t){this._xPosition=t,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(t){this._yPosition=t,this.setPositionClasses()}get overlapTrigger(){return this._overlapTrigger}set overlapTrigger(t){this._overlapTrigger=js(t)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(t){this._hasBackdrop=js(t)}set panelClass(t){const i=this._previousPanelClass;i&&i.length&&i.split(" ").forEach(r=>{this._classList[r]=!1}),this._previousPanelClass=t,t&&t.length&&(t.split(" ").forEach(r=>{this._classList[r]=!0}),this._elementRef.nativeElement.className="")}get classList(){return this.panelClass}set classList(t){this.panelClass=t}constructor(t,i,r,s){this._elementRef=t,this._ngZone=i,this._defaultOptions=r,this._changeDetectorRef=s,this._xPosition=this._defaultOptions.xPosition,this._yPosition=this._defaultOptions.yPosition,this._directDescendantItems=new bl,this._classList={},this._panelAnimationState="void",this._animationDone=new wt,this.overlayPanelClass=this._defaultOptions.overlayPanelClass||"",this.backdropClass=this._defaultOptions.backdropClass,this._overlapTrigger=this._defaultOptions.overlapTrigger,this._hasBackdrop=this._defaultOptions.hasBackdrop,this.closed=new It,this.close=this.closed,this.panelId="mat-menu-panel-"+oW++}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new V5(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe(Wo(this._directDescendantItems),tp(t=>Os(...t.map(i=>i._focused)))).subscribe(t=>this._keyManager.updateActiveItem(t)),this._directDescendantItems.changes.subscribe(t=>{const i=this._keyManager;if("enter"===this._panelAnimationState&&i.activeItem?._hasFocus()){const r=t.toArray(),s=Math.max(0,Math.min(r.length-1,i.activeItemIndex||0));r[s]&&!r[s].disabled?i.setActiveItem(s):i.setNextItemActive()}})}ngOnDestroy(){this._keyManager?.destroy(),this._directDescendantItems.destroy(),this.closed.complete(),this._firstItemFocusSubscription?.unsubscribe()}_hovered(){return this._directDescendantItems.changes.pipe(Wo(this._directDescendantItems),tp(i=>Os(...i.map(r=>r._hovered))))}addItem(t){}removeItem(t){}_handleKeydown(t){const i=t.keyCode,r=this._keyManager;switch(i){case 27:ST(t)||(t.preventDefault(),this.closed.emit("keydown"));break;case 37:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case 39:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;default:return(38===i||40===i)&&r.setFocusOrigin("keyboard"),void r.onKeydown(t)}t.stopPropagation()}focusFirstItem(t="program"){this._firstItemFocusSubscription?.unsubscribe(),this._firstItemFocusSubscription=this._ngZone.onStable.pipe(fs(1)).subscribe(()=>{let i=null;if(this._directDescendantItems.length&&(i=this._directDescendantItems.first._getHostElement().closest('[role="menu"]')),!i||!i.contains(document.activeElement)){const r=this._keyManager;r.setFocusOrigin(t).setFirstItemActive(),!r.activeItem&&i&&i.focus()}})}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(t){const i=Math.min(this._baseElevation+t,24),r=`${this._elevationPrefix}${i}`,s=Object.keys(this._classList).find(o=>o.startsWith(this._elevationPrefix));(!s||s===this._previousElevation)&&(this._previousElevation&&(this._classList[this._previousElevation]=!1),this._classList[r]=!0,this._previousElevation=r)}setPositionClasses(t=this.xPosition,i=this.yPosition){const r=this._classList;r["mat-menu-before"]="before"===t,r["mat-menu-after"]="after"===t,r["mat-menu-above"]="above"===i,r["mat-menu-below"]="below"===i,this._changeDetectorRef?.markForCheck()}_startAnimation(){this._panelAnimationState="enter"}_resetAnimation(){this._panelAnimationState="void"}_onAnimationDone(t){this._animationDone.next(t),this._isAnimating=!1}_onAnimationStart(t){this._isAnimating=!0,"enter"===t.toState&&0===this._keyManager.activeItemIndex&&(t.element.scrollTop=0)}_updateDirectDescendants(){this._allItems.changes.pipe(Wo(this._allItems)).subscribe(t=>{this._directDescendantItems.reset(t.filter(i=>i._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}}return n.\u0275fac=function(t){return new(t||n)(U(Tt),U(ot),U(D1),U(Zn))},n.\u0275dir=De({type:n,contentQueries:function(t,i,r){if(1&t&&(mu(r,sW,5),mu(r,rp,5),mu(r,rp,4)),2&t){let s;Xi(s=Yi())&&(i.lazyContent=s.first),Xi(s=Yi())&&(i._allItems=s),Xi(s=Yi())&&(i.items=s)}},viewQuery:function(t,i){if(1&t&&Us(qi,5),2&t){let r;Xi(r=Yi())&&(i.templateRef=r.first)}},inputs:{backdropClass:"backdropClass",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:"overlapTrigger",hasBackdrop:"hasBackdrop",panelClass:["class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"}}),n})(),lW=(()=>{class n extends zu{constructor(t,i,r,s){super(t,i,r,s),this._elevationPrefix="mat-elevation-z",this._baseElevation=8}}return n.\u0275fac=function(t){return new(t||n)(U(Tt),U(ot),U(D1),U(Zn))},n.\u0275cmp=Gi({type:n,selectors:[["mat-menu"]],hostVars:3,hostBindings:function(t,i){2&t&&Pn("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},exportAs:["matMenu"],features:[Ct([{provide:Vv,useExisting:n}]),Xe],ngContentSelectors:iW,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-mdc-menu-panel","mdc-menu-surface","mdc-menu-surface--open","mat-mdc-elevation-specific",3,"id","ngClass","keydown","click"],[1,"mat-mdc-menu-content","mdc-list"]],template:function(t,i){1&t&&(Bo(),su(0,nW,3,6,"ng-template"))},dependencies:[NA],styles:['.mdc-menu-surface{display:none;position:absolute;box-sizing:border-box;max-width:var(--mdc-menu-max-width, calc(100vw - 32px));max-height:var(--mdc-menu-max-height, calc(100vh - 32px));margin:0;padding:0;transform:scale(1);transform-origin:top left;opacity:0;overflow:auto;will-change:transform,opacity;z-index:8;border-radius:var(--mdc-shape-medium, 4px);transform-origin-left:top left;transform-origin-right:top right}.mdc-menu-surface:focus{outline:none}.mdc-menu-surface--animating-open{display:inline-block;transform:scale(0.8);opacity:0}.mdc-menu-surface--open{display:inline-block;transform:scale(1);opacity:1}.mdc-menu-surface--animating-closed{display:inline-block;opacity:0}[dir=rtl] .mdc-menu-surface,.mdc-menu-surface[dir=rtl]{transform-origin-left:top right;transform-origin-right:top left}.mdc-menu-surface--anchor{position:relative;overflow:visible}.mdc-menu-surface--fixed{position:fixed}.mdc-menu-surface--fullwidth{width:100%}mat-menu{display:none}.mat-mdc-menu-content{margin:0;padding:8px 0;list-style-type:none}.mat-mdc-menu-content:focus{outline:none}.mat-mdc-menu-panel.ng-animating{pointer-events:none}.cdk-high-contrast-active .mat-mdc-menu-panel{outline:solid 1px}.mat-mdc-menu-panel.mat-mdc-menu-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;position:relative}.mat-mdc-menu-item{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:16px;padding-right:16px;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);cursor:pointer;width:100%;text-align:left;box-sizing:border-box;color:inherit;font-size:inherit;background:none;text-decoration:none;margin:0;min-height:48px}.mat-mdc-menu-item:focus{outline:none}[dir=rtl] .mat-mdc-menu-item,.mat-mdc-menu-item[dir=rtl]{padding-left:16px;padding-right:16px}.mat-mdc-menu-item::-moz-focus-inner{border:0}.mat-mdc-menu-item.mdc-list-item{align-items:center}.mat-mdc-menu-item[disabled]{cursor:default;opacity:.38}.mat-mdc-menu-item[disabled]::after{display:block;position:absolute;content:"";top:0;left:0;bottom:0;right:0}.mat-mdc-menu-item .mat-icon{margin-right:16px}[dir=rtl] .mat-mdc-menu-item{text-align:right}[dir=rtl] .mat-mdc-menu-item .mat-icon{margin-right:0;margin-left:16px}.mat-mdc-menu-item .mdc-list-item__primary-text{white-space:normal}.mat-mdc-menu-item.mat-mdc-menu-item-submenu-trigger{padding-right:32px}[dir=rtl] .mat-mdc-menu-item.mat-mdc-menu-item-submenu-trigger{padding-right:16px;padding-left:32px}.cdk-high-contrast-active .mat-mdc-menu-item{margin-top:1px}.mat-mdc-menu-submenu-icon{position:absolute;top:50%;right:16px;transform:translateY(-50%);width:5px;height:10px;fill:currentColor}[dir=rtl] .mat-mdc-menu-submenu-icon{right:auto;left:16px;transform:translateY(-50%) scaleX(-1)}.cdk-high-contrast-active .mat-mdc-menu-submenu-icon{fill:CanvasText}.mat-mdc-menu-item .mat-mdc-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}'],encapsulation:2,data:{animation:[sp.transformMenu,sp.fadeInItems]},changeDetection:0}),n})();const A1=new he("mat-menu-scroll-strategy"),uW={provide:A1,deps:[ip],useFactory:function cW(n){return()=>n.scrollStrategies.reposition()}},T1=Tu({passive:!0});let dW=(()=>{class n{get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(t){this.menu=t}get menu(){return this._menu}set menu(t){t!==this._menu&&(this._menu=t,this._menuCloseSubscription.unsubscribe(),t&&(this._menuCloseSubscription=t.close.subscribe(i=>{this._destroyMenu(i),("click"===i||"tab"===i)&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(i)})),this._menuItemInstance?._setTriggersSubmenu(this.triggersSubmenu()))}constructor(t,i,r,s,o,a,l,c,u){this._overlay=t,this._element=i,this._viewContainerRef=r,this._menuItemInstance=a,this._dir=l,this._focusMonitor=c,this._ngZone=u,this._overlayRef=null,this._menuOpen=!1,this._closingActionsSubscription=qt.EMPTY,this._hoverSubscription=qt.EMPTY,this._menuCloseSubscription=qt.EMPTY,this._changeDetectorRef=_t(Zn),this._handleTouchStart=d=>{vv(d)||(this._openedBy="touch")},this._openedBy=void 0,this.restoreFocus=!0,this.menuOpened=new It,this.onMenuOpen=this.menuOpened,this.menuClosed=new It,this.onMenuClose=this.menuClosed,this._scrollStrategy=s,this._parentMaterialMenu=o instanceof zu?o:void 0,i.nativeElement.addEventListener("touchstart",this._handleTouchStart,T1)}ngAfterContentInit(){this._handleHover()}ngOnDestroy(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._element.nativeElement.removeEventListener("touchstart",this._handleTouchStart,T1),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}triggersSubmenu(){return!!(this._menuItemInstance&&this._parentMaterialMenu&&this.menu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){const t=this.menu;if(this._menuOpen||!t)return;const i=this._createOverlay(t),r=i.getConfig(),s=r.positionStrategy;this._setPosition(t,s),r.hasBackdrop=null==t.hasBackdrop?!this.triggersSubmenu():t.hasBackdrop,i.attach(this._getPortal(t)),t.lazyContent&&t.lazyContent.attach(this.menuData),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),this._initMenu(t),t instanceof zu&&(t._startAnimation(),t._directDescendantItems.changes.pipe(Qi(t.close)).subscribe(()=>{s.withLockedPosition(!1).reapplyLastPosition(),s.withLockedPosition(!0)}))}closeMenu(){this.menu?.close.emit()}focus(t,i){this._focusMonitor&&t?this._focusMonitor.focusVia(this._element,t,i):this._element.nativeElement.focus(i)}updatePosition(){this._overlayRef?.updatePosition()}_destroyMenu(t){if(!this._overlayRef||!this.menuOpen)return;const i=this.menu;this._closingActionsSubscription.unsubscribe(),this._overlayRef.detach(),this.restoreFocus&&("keydown"===t||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,i instanceof zu?(i._resetAnimation(),i.lazyContent?i._animationDone.pipe(li(r=>"void"===r.toState),fs(1),Qi(i.lazyContent._attached)).subscribe({next:()=>i.lazyContent.detach(),complete:()=>this._setIsMenuOpen(!1)}):this._setIsMenuOpen(!1)):(this._setIsMenuOpen(!1),i?.lazyContent?.detach())}_initMenu(t){t.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,t.direction=this.dir,this._setMenuElevation(t),t.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0)}_setMenuElevation(t){if(t.setElevation){let i=0,r=t.parentMenu;for(;r;)i++,r=r.parentMenu;t.setElevation(i)}}_setIsMenuOpen(t){t!==this._menuOpen&&(this._menuOpen=t,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(t),this._changeDetectorRef.markForCheck())}_createOverlay(t){if(!this._overlayRef){const i=this._getOverlayConfig(t);this._subscribeToPositions(t,i.positionStrategy),this._overlayRef=this._overlay.create(i),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef}_getOverlayConfig(t){return new b1({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:t.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:t.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir})}_subscribeToPositions(t,i){t.setPositionClasses&&i.positionChanges.subscribe(r=>{const s="start"===r.connectionPair.overlayX?"after":"before",o="top"===r.connectionPair.overlayY?"below":"above";this._ngZone?this._ngZone.run(()=>t.setPositionClasses(s,o)):t.setPositionClasses(s,o)})}_setPosition(t,i){let[r,s]="before"===t.xPosition?["end","start"]:["start","end"],[o,a]="above"===t.yPosition?["bottom","top"]:["top","bottom"],[l,c]=[o,a],[u,d]=[r,s],h=0;if(this.triggersSubmenu()){if(d=r="before"===t.xPosition?"start":"end",s=u="end"===r?"start":"end",this._parentMaterialMenu){if(null==this._parentInnerPadding){const f=this._parentMaterialMenu.items.first;this._parentInnerPadding=f?f._getHostElement().offsetTop:0}h="bottom"===o?this._parentInnerPadding:-this._parentInnerPadding}}else t.overlapTrigger||(l="top"===o?"bottom":"top",c="top"===a?"bottom":"top");i.withPositions([{originX:r,originY:l,overlayX:u,overlayY:o,offsetY:h},{originX:s,originY:l,overlayX:d,overlayY:o,offsetY:h},{originX:r,originY:c,overlayX:u,overlayY:a,offsetY:-h},{originX:s,originY:c,overlayX:d,overlayY:a,offsetY:-h}])}_menuClosingActions(){const t=this._overlayRef.backdropClick(),i=this._overlayRef.detachments();return Os(t,this._parentMaterialMenu?this._parentMaterialMenu.closed:Ri(),this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe(li(o=>o!==this._menuItemInstance),li(()=>this._menuOpen)):Ri(),i)}_handleMousedown(t){yv(t)||(this._openedBy=0===t.button?"mouse":void 0,this.triggersSubmenu()&&t.preventDefault())}_handleKeydown(t){const i=t.keyCode;(13===i||32===i)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(39===i&&"ltr"===this.dir||37===i&&"rtl"===this.dir)&&(this._openedBy="keyboard",this.openMenu())}_handleClick(t){this.triggersSubmenu()?(t.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){!this.triggersSubmenu()||!this._parentMaterialMenu||(this._hoverSubscription=this._parentMaterialMenu._hovered().pipe(li(t=>t===this._menuItemInstance&&!t.disabled),d1(0,Pv)).subscribe(()=>{this._openedBy="mouse",this.menu instanceof zu&&this.menu._isAnimating?this.menu._animationDone.pipe(fs(1),d1(0,Pv),Qi(this._parentMaterialMenu._hovered())).subscribe(()=>this.openMenu()):this.openMenu()}))}_getPortal(t){return(!this._portal||this._portal.templateRef!==t.templateRef)&&(this._portal=new h1(t.templateRef,this._viewContainerRef)),this._portal}}return n.\u0275fac=function(t){return new(t||n)(U(ip),U(Tt),U(Kn),U(A1),U(Vv,8),U(rp,10),U(Fu,8),U($f),U(ot))},n.\u0275dir=De({type:n,hostVars:3,hostBindings:function(t,i){1&t&&pn("click",function(s){return i._handleClick(s)})("mousedown",function(s){return i._handleMousedown(s)})("keydown",function(s){return i._handleKeydown(s)}),2&t&&Pn("aria-haspopup",i.menu?"menu":null)("aria-expanded",i.menuOpen)("aria-controls",i.menuOpen?i.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:["mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:["matMenuTriggerFor","menu"],menuData:["matMenuTriggerData","menuData"],restoreFocus:["matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"}}),n})(),hW=(()=>{class n extends dW{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=nn(n)))(i||n)}}(),n.\u0275dir=De({type:n,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-mdc-menu-trigger"],exportAs:["matMenuTrigger"],features:[Xe]}),n})(),fW=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=wn({type:n}),n.\u0275inj=hn({providers:[uW],imports:[Qy,Sv,Gr,Zj,kv,Gr]}),n})();class Pl extends wt{constructor(e=1/0,t=1/0,i=gv){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:o}=this;t||(i.push(e),!r&&i.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:i,_buffer:r}=this,s=r.slice();for(let o=0;o<s.length&&!e.closed;o+=i?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:i,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<i.length&&i.splice(0,i.length-s),!r){const o=t.now();let a=0;for(let l=1;l<i.length&&i[l]<=o;l+=2)a=l;a&&i.splice(0,a+1)}}}const I1={box:"content-box",scroll:!1,offsetSize:!1,debounce:{scroll:50,resize:0},emitInZone:!0,emitInitialResult:!1},Uv=new he("NgxResizeOptions",{factory:()=>I1});function pW(n={}){return{provide:Uv,useValue:{...I1,...n}}}let mW=(()=>{class n{constructor(t,i,r,s){this.host=t,this.zone=i,this.document=r,this.resizeOptions=s,this.ngxResizeOptions={},this.ngxResize=new It}ngOnInit(){const t={...this.resizeOptions,...this.ngxResizeOptions};this.sub=function R1({debounce:n,scroll:e,offsetSize:t,box:i,emitInZone:r,emitInitialResult:s},o,a,l){const c=a.defaultView,u=!!c?.ResizeObserver;let d,h,f=[];const p=new Pl,m=F1(o,c,a.body),g=n?"number"==typeof n?n:n.scroll:null,y=n?"number"==typeof n?n:n.resize:null,v=_=>function PL(...n){return bw(n)}(Hf(_??0),Qi(p));return new Lt(_=>{if(u){if(s){const[b]=P1(o,c,t,[]);_.next(b)}return l.runOutsideAngular(()=>{const b=M=>{f=M;const[C,x]=P1(o,c,t,M);r?l.run(()=>{_.next(C)}):_.next(C),_W(h||{},x)||(h=x)},w=()=>{b(f)};d=new ResizeObserver(b),d.observe(o,{box:i}),e&&(m&&m.forEach(M=>{qo(M,"scroll",{capture:!0,passive:!0}).pipe(v(g)).subscribe(w)}),qo(c,"scroll",{capture:!0,passive:!0}).pipe(v(g)).subscribe(w)),qo(c,"resize").pipe(v(y)).subscribe(w)}),()=>{d&&(d.unobserve(o),d.disconnect()),p.next(),p.complete()}}_.error("[ngx-resize] your browser does not support ResizeObserver. Please consider using a polyfill")}).pipe(Hf(g??0),Tc({connector:()=>new Pl(1)}))}(t,this.host.nativeElement,this.document,this.zone).subscribe(this.ngxResize)}ngOnDestroy(){this.sub?.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(U(Tt),U(ot),U(at),U(Uv))},n.\u0275dir=De({type:n,selectors:[["","ngxResize",""]],inputs:{ngxResizeOptions:"ngxResizeOptions"},outputs:{ngxResize:"ngxResize"},standalone:!0}),n})();function P1(n,e,t,i){const{left:r,top:s,width:o,height:a,bottom:l,right:c,x:u,y:d}=n.getBoundingClientRect(),h={left:r,top:s,width:o,height:a,bottom:l,right:c,x:u,y:d};return n instanceof HTMLElement&&t&&(h.height=n.offsetHeight,h.width=n.offsetWidth),Object.freeze(h),[{entries:i,dpr:e.devicePixelRatio,...h},h]}function F1(n,e,t){const i=[];if(!n||!e||n===t)return i;const{overflow:r,overflowX:s,overflowY:o}=e.getComputedStyle(n);return[r,s,o].some(a=>"auto"===a||"scroll"===a)&&i.push(n),[...i,...F1(n.parentElement,e,t)]}const gW=["x","y","top","bottom","left","right","width","height"],_W=(n,e)=>gW.every(t=>n[t]===e[t]);function Yo(n){return!!n&&(n instanceof Lt||st(n.lift)&&st(n.subscribe))}function O1(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function Hu(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){O1(s,i,r,o,a,"next",l)}function a(l){O1(s,i,r,o,a,"throw",l)}o(void 0)})}}const op="149",vW={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},bW={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},L1=0,zv=1,N1=2,xW=3,wW=0,Hv=1,Gv=2,Fl=3,jr=0,xi=1,Wr=2,MW=2,ps=0,Ko=1,jv=2,Wv=3,$v=4,k1=5,Zo=100,B1=101,V1=102,qv=103,Xv=104,U1=200,z1=201,H1=202,G1=203,Yv=204,Kv=205,j1=206,W1=207,$1=208,q1=209,X1=210,Y1=0,K1=1,Z1=2,ap=3,J1=4,Q1=5,eI=6,tI=7,Gu=0,nI=1,iI=2,vr=0,rI=1,sI=2,oI=3,Zv=4,aI=5,lp=300,qs=301,Xs=302,ju=303,Wu=304,Ol=306,Ys=1e3,zn=1001,Ll=1002,sn=1003,$u=1004,SW=1004,Nl=1005,EW=1005,Jt=1006,cp=1007,CW=1007,$r=1008,DW=1008,Ks=1009,lI=1010,cI=1011,Jv=1012,uI=1013,Zs=1014,ms=1015,kl=1016,dI=1017,hI=1018,Jo=1020,fI=1021,Pi=1023,pI=1024,mI=1025,Js=1026,Qo=1027,gI=1028,_I=1029,yI=1030,vI=1031,bI=1033,up=33776,dp=33777,hp=33778,fp=33779,Qv=35840,eb=35841,tb=35842,nb=35843,xI=36196,ib=37492,rb=37496,sb=37808,ob=37809,ab=37810,lb=37811,cb=37812,ub=37813,db=37814,hb=37815,fb=37816,pb=37817,mb=37818,gb=37819,_b=37820,yb=37821,pp=36492,wI=36283,vb=36284,bb=36285,xb=36286,MI=2200,SI=2201,EI=2202,Bl=2300,ea=2301,mp=2302,ta=2400,na=2401,qu=2402,gp=2500,wb=2501,CI=0,Mb=1,_p=2,gs=3e3,mt=3001,DI=3200,AI=3201,Qs=0,TI=1,AW="",br="srgb",Vl="srgb-linear",TW=0,yp=7680,IW=7681,RW=7682,PW=7683,FW=34055,OW=34056,LW=5386,NW=512,kW=513,BW=514,VW=515,UW=516,zW=517,HW=518,II=519,Xu=35044,GW=35048,jW=35040,WW=35045,$W=35049,qW=35041,XW=35046,YW=35050,KW=35042,ZW="100",Sb="300 es",vp=1035;class _s{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Jn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let RI=1234567;const ia=Math.PI/180,Yu=180/Math.PI;function Fi(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Jn[255&n]+Jn[n>>8&255]+Jn[n>>16&255]+Jn[n>>24&255]+"-"+Jn[255&e]+Jn[e>>8&255]+"-"+Jn[e>>16&15|64]+Jn[e>>24&255]+"-"+Jn[63&t|128]+Jn[t>>8&255]+"-"+Jn[t>>16&255]+Jn[t>>24&255]+Jn[255&i]+Jn[i>>8&255]+Jn[i>>16&255]+Jn[i>>24&255]).toLowerCase()}function un(n,e,t){return Math.max(e,Math.min(t,n))}function Eb(n,e){return(n%e+e)%e}function Ku(n,e,t){return(1-t)*n+t*e}function Cb(n){return 0==(n&n-1)&&0!==n}function PI(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function bp(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function ys(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Bt(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}var Db=Object.freeze({__proto__:null,DEG2RAD:ia,RAD2DEG:Yu,ceilPowerOfTwo:PI,clamp:un,damp:function e6(n,e,t,i){return Ku(n,e,1-Math.exp(-t*i))},degToRad:function l6(n){return n*ia},denormalize:ys,euclideanModulo:Eb,floorPowerOfTwo:bp,generateUUID:Fi,inverseLerp:function QW(n,e,t){return n!==e?(t-n)/(e-n):0},isPowerOfTwo:Cb,lerp:Ku,mapLinear:function JW(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)},normalize:Bt,pingpong:function t6(n,e=1){return e-Math.abs(Eb(n,2*e)-e)},radToDeg:function c6(n){return n*Yu},randFloat:function s6(n,e){return n+Math.random()*(e-n)},randFloatSpread:function o6(n){return n*(.5-Math.random())},randInt:function r6(n,e){return n+Math.floor(Math.random()*(e-n+1))},seededRandom:function a6(n){void 0!==n&&(RI=n);let e=RI+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},setQuaternionFromProperEuler:function u6(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+i)/2),u=o((e+i)/2),d=s((e-i)/2),h=o((e-i)/2),f=s((i-e)/2),p=o((i-e)/2);switch(r){case"XYX":n.set(a*u,l*d,l*h,a*c);break;case"YZY":n.set(l*h,a*u,l*d,a*c);break;case"ZXZ":n.set(l*d,l*h,a*u,a*c);break;case"XZX":n.set(a*u,l*p,l*f,a*c);break;case"YXY":n.set(l*f,a*u,l*p,a*c);break;case"ZYZ":n.set(l*p,l*f,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},smootherstep:function i6(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*n*(n*(6*n-15)+10)},smoothstep:function n6(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*(3-2*n)}});class ee{constructor(e=0,t=0){ee.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ci{constructor(){ci.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,i,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],d=i[7],h=i[2],f=i[5],p=i[8],m=r[0],g=r[3],y=r[6],v=r[1],_=r[4],b=r[7],w=r[2],M=r[5],C=r[8];return s[0]=o*m+a*v+l*w,s[3]=o*g+a*_+l*M,s[6]=o*y+a*b+l*C,s[1]=c*m+u*v+d*w,s[4]=c*g+u*_+d*M,s[7]=c*y+u*b+d*C,s[2]=h*m+f*v+p*w,s[5]=h*g+f*_+p*M,s[8]=h*y+f*b+p*C,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,h=a*l-u*s,f=c*s-o*l,p=t*d+i*h+r*f;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=d*m,e[1]=(r*c-u*i)*m,e[2]=(a*i-r*o)*m,e[3]=h*m,e[4]=(u*t-r*l)*m,e[5]=(r*s-a*t)*m,e[6]=f*m,e[7]=(i*l-c*t)*m,e[8]=(o*t-i*s)*m,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(Ab.makeScale(e,t)),this}rotate(e){return this.premultiply(Ab.makeRotation(-e)),this}translate(e,t){return this.premultiply(Ab.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const Ab=new ci;function FI(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const d6={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Ul(n,e){return new d6[n](e)}function Zu(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function ra(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function xp(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}const Tb={[br]:{[Vl]:ra},[Vl]:{[br]:xp}},yn={legacyMode:!0,get workingColorSpace(){return Vl},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(this.legacyMode||e===t||!e||!t)return n;if(Tb[e]&&void 0!==Tb[e][t]){const i=Tb[e][t];return n.r=i(n.r),n.g=i(n.g),n.b=i(n.b),n}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}},OI={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Cn={r:0,g:0,b:0},xr={h:0,s:0,l:0},wp={h:0,s:0,l:0};function Ib(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}function Mp(n,e){return e.r=n.r,e.g=n.g,e.b=n.b,e}let zl,me=(()=>{class n{constructor(t,i,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===i&&void 0===r?this.set(t):this.setRGB(t,i,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,i=br){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,yn.toWorkingColorSpace(this,i),this}setRGB(t,i,r,s=yn.workingColorSpace){return this.r=t,this.g=i,this.b=r,yn.toWorkingColorSpace(this,s),this}setHSL(t,i,r,s=yn.workingColorSpace){if(t=Eb(t,1),i=un(i,0,1),r=un(r,0,1),0===i)this.r=this.g=this.b=r;else{const o=r<=.5?r*(1+i):r+i-r*i,a=2*r-o;this.r=Ib(a,o,t+1/3),this.g=Ib(a,o,t),this.b=Ib(a,o,t-1/3)}return yn.toWorkingColorSpace(this,s),this}setStyle(t,i=br){function r(o){void 0!==o&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let s;if(s=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let o;const l=s[2];switch(s[1]){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(255,parseInt(o[1],10))/255,this.g=Math.min(255,parseInt(o[2],10))/255,this.b=Math.min(255,parseInt(o[3],10))/255,yn.toWorkingColorSpace(this,i),r(o[4]),this;if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(100,parseInt(o[1],10))/100,this.g=Math.min(100,parseInt(o[2],10))/100,this.b=Math.min(100,parseInt(o[3],10))/100,yn.toWorkingColorSpace(this,i),r(o[4]),this;break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l)){const c=parseFloat(o[1])/360,u=parseFloat(o[2])/100,d=parseFloat(o[3])/100;return r(o[4]),this.setHSL(c,u,d,i)}}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(t)){const o=s[1],a=o.length;if(3===a)return this.r=parseInt(o.charAt(0)+o.charAt(0),16)/255,this.g=parseInt(o.charAt(1)+o.charAt(1),16)/255,this.b=parseInt(o.charAt(2)+o.charAt(2),16)/255,yn.toWorkingColorSpace(this,i),this;if(6===a)return this.r=parseInt(o.charAt(0)+o.charAt(1),16)/255,this.g=parseInt(o.charAt(2)+o.charAt(3),16)/255,this.b=parseInt(o.charAt(4)+o.charAt(5),16)/255,yn.toWorkingColorSpace(this,i),this}return t&&t.length>0?this.setColorName(t,i):this}setColorName(t,i=br){const r=OI[t.toLowerCase()];return void 0!==r?this.setHex(r,i):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=ra(t.r),this.g=ra(t.g),this.b=ra(t.b),this}copyLinearToSRGB(t){return this.r=xp(t.r),this.g=xp(t.g),this.b=xp(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=br){return yn.fromWorkingColorSpace(Mp(this,Cn),t),un(255*Cn.r,0,255)<<16^un(255*Cn.g,0,255)<<8^un(255*Cn.b,0,255)<<0}getHexString(t=br){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,i=yn.workingColorSpace){yn.fromWorkingColorSpace(Mp(this,Cn),i);const r=Cn.r,s=Cn.g,o=Cn.b,a=Math.max(r,s,o),l=Math.min(r,s,o);let c,u;const d=(l+a)/2;if(l===a)c=0,u=0;else{const h=a-l;switch(u=d<=.5?h/(a+l):h/(2-a-l),a){case r:c=(s-o)/h+(s<o?6:0);break;case s:c=(o-r)/h+2;break;case o:c=(r-s)/h+4}c/=6}return t.h=c,t.s=u,t.l=d,t}getRGB(t,i=yn.workingColorSpace){return yn.fromWorkingColorSpace(Mp(this,Cn),i),t.r=Cn.r,t.g=Cn.g,t.b=Cn.b,t}getStyle(t=br){return yn.fromWorkingColorSpace(Mp(this,Cn),t),t!==br?`color(${t} ${Cn.r} ${Cn.g} ${Cn.b})`:`rgb(${255*Cn.r|0},${255*Cn.g|0},${255*Cn.b|0})`}offsetHSL(t,i,r){return this.getHSL(xr),xr.h+=t,xr.s+=i,xr.l+=r,this.setHSL(xr.h,xr.s,xr.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this}lerpColors(t,i,r){return this.r=t.r+(i.r-t.r)*r,this.g=t.g+(i.g-t.g)*r,this.b=t.b+(i.b-t.b)*r,this}lerpHSL(t,i){this.getHSL(xr),t.getHSL(wp);const r=Ku(xr.h,wp.h,i),s=Ku(xr.s,wp.s,i),o=Ku(xr.l,wp.l,i);return this.setHSL(r,s,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,i=0){return this.r=t[i],this.g=t[i+1],this.b=t[i+2],this}toArray(t=[],i=0){return t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t}fromBufferAttribute(t,i){return this.r=t.getX(i),this.g=t.getY(i),this.b=t.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}return n.NAMES=OI,n})();class Rb{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===zl&&(zl=Zu("canvas")),zl.width=e.width,zl.height=e.height;const i=zl.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=zl}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Zu("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*ra(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*ra(t[i]/255)):ra(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class sa{constructor(e=null){this.isSource=!0,this.uuid=Fi(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(Pb(r[o].isDataTexture?r[o].image:r[o]))}else s=Pb(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function Pb(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Rb.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let h6=0,Hn=(()=>{class n extends _s{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=zn,s=zn,o=Jt,a=$r,l=Pi,c=Ks,u=n.DEFAULT_ANISOTROPY,d=gs){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:h6++}),this.uuid=Fi(),this.name="",this.source=new sa(t),this.mipmaps=[],this.mapping=i,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new ee(0,0),this.repeat=new ee(1,1),this.center=new ee(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ci,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==lp)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Ys:t.x=t.x-Math.floor(t.x);break;case zn:t.x=t.x<0?0:1;break;case Ll:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Ys:t.y=t.y-Math.floor(t.y);break;case zn:t.y=t.y<0?0:1;break;case Ll:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=lp,n.DEFAULT_ANISOTROPY=1,n})();class Rt{constructor(e=0,t=0,i=0,r=1){Rt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],u=l[4],d=l[8],h=l[1],f=l[5],p=l[9],m=l[2],g=l[6],y=l[10];if(Math.abs(u-h)<.01&&Math.abs(d-m)<.01&&Math.abs(p-g)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+m)<.1&&Math.abs(p+g)<.1&&Math.abs(c+f+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const _=(c+1)/2,b=(f+1)/2,w=(y+1)/2,M=(u+h)/4,C=(d+m)/4,x=(p+g)/4;return _>b&&_>w?_<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(_),r=M/i,s=C/i):b>w?b<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(b),i=M/r,s=x/r):w<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(w),i=C/s,r=x/s),this.set(i,r,s,t),this}let v=Math.sqrt((g-p)*(g-p)+(d-m)*(d-m)+(h-u)*(h-u));return Math.abs(v)<.001&&(v=1),this.x=(g-p)/v,this.y=(d-m)/v,this.z=(h-u)/v,this.w=Math.acos((c+f+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class wr extends _s{constructor(e=1,t=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Rt(0,0,e,t),this.scissorTest=!1,this.viewport=new Rt(0,0,e,t),this.texture=new Hn({width:e,height:t,depth:1},i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:Jt,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new sa(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Sp extends Hn{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=sn,this.minFilter=sn,this.wrapR=zn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class f6 extends wr{constructor(e=1,t=1,i=1){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new Sp(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class Fb extends Hn{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=sn,this.minFilter=sn,this.wrapR=zn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class p6 extends wr{constructor(e=1,t=1,i=1){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new Fb(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class m6 extends wr{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<i;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=i;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class Qn{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],u=i[r+2],d=i[r+3];const h=s[o+0],f=s[o+1],p=s[o+2],m=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=u,void(e[t+3]=d);if(1===a)return e[t+0]=h,e[t+1]=f,e[t+2]=p,void(e[t+3]=m);if(d!==m||l!==h||c!==f||u!==p){let g=1-a;const y=l*h+c*f+u*p+d*m,v=y>=0?1:-1,_=1-y*y;if(_>Number.EPSILON){const w=Math.sqrt(_),M=Math.atan2(w,y*v);g=Math.sin(g*M)/w,a=Math.sin(a*M)/w}const b=a*v;if(l=l*g+h*b,c=c*g+f*b,u=u*g+p*b,d=d*g+m*b,g===1-a){const w=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=w,c*=w,u*=w,d*=w}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],d=s[o],h=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*d+l*f-c*h,e[t+1]=l*p+u*h+c*d-a*f,e[t+2]=c*p+u*f+a*h-l*d,e[t+3]=u*p-a*d-l*h-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),d=a(s/2),h=l(i/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=h*u*d+c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d-h*f*p;break;case"YXZ":this._x=h*u*d+c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d+h*f*p;break;case"ZXY":this._x=h*u*d-c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d-h*f*p;break;case"ZYX":this._x=h*u*d-c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d+h*f*p;break;case"YZX":this._x=h*u*d+c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d-h*f*p;break;case"XZY":this._x=h*u*d-c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d+h*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],d=t[10],h=i+a+d;if(h>0){const f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(i>a&&i>d){const f=2*Math.sqrt(1+i-a-d);this._w=(u-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>d){const f=2*Math.sqrt(1+a-i-d);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+d-i-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(un(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=i*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-i*c,this._z=s*u+o*c+i*l-r*a,this._w=o*u-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),d=Math.sin((1-t)*u)/c,h=Math.sin(t*u)/c;return this._w=o*d+this._w*h,this._x=i*d+this._x*h,this._y=r*d+this._y*h,this._z=s*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class D{constructor(e=0,t=0,i=0){D.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(LI.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(LI.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*i,u=l*i+a*t-s*r,d=l*r+s*i-o*t,h=-s*t-o*i-a*r;return this.x=c*l+h*-s+u*-a-d*-o,this.y=u*l+h*-o+d*-s-c*-a,this.z=d*l+h*-a+c*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return Ob.copy(this).projectOnVector(e),this.sub(Ob)}reflect(e){return this.sub(Ob.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(un(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Ob=new D,LI=new Qn;class eo{constructor(e=new D(1/0,1/0,1/0),t=new D(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.length;l<c;l+=3){const u=e[l],d=e[l+1],h=e[l+2];u<t&&(t=u),d<i&&(i=d),h<r&&(r=h),u>s&&(s=u),d>o&&(o=d),h>a&&(a=h)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.count;l<c;l++){const u=e.getX(l),d=e.getY(l),h=e.getZ(l);u<t&&(t=u),d<i&&(i=d),h<r&&(r=h),u>s&&(s=u),d>o&&(o=d),h>a&&(a=h)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=oa.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i)if(t&&null!=i.attributes&&void 0!==i.attributes.position){const s=i.attributes.position;for(let o=0,a=s.count;o<a;o++)oa.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(oa)}else null===i.boundingBox&&i.computeBoundingBox(),Lb.copy(i.boundingBox),Lb.applyMatrix4(e.matrixWorld),this.union(Lb);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,oa),oa.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ju),Ep.subVectors(this.max,Ju),Hl.subVectors(e.a,Ju),Gl.subVectors(e.b,Ju),jl.subVectors(e.c,Ju),to.subVectors(Gl,Hl),no.subVectors(jl,Gl),aa.subVectors(Hl,jl);let t=[0,-to.z,to.y,0,-no.z,no.y,0,-aa.z,aa.y,to.z,0,-to.x,no.z,0,-no.x,aa.z,0,-aa.x,-to.y,to.x,0,-no.y,no.x,0,-aa.y,aa.x,0];return!(!Nb(t,Hl,Gl,jl,Ep)||(t=[1,0,0,0,1,0,0,0,1],!Nb(t,Hl,Gl,jl,Ep)))&&(Cp.crossVectors(to,no),t=[Cp.x,Cp.y,Cp.z],Nb(t,Hl,Gl,jl,Ep))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return oa.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(oa).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(vs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),vs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),vs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),vs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),vs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),vs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),vs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),vs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(vs)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const vs=[new D,new D,new D,new D,new D,new D,new D,new D],oa=new D,Lb=new eo,Hl=new D,Gl=new D,jl=new D,to=new D,no=new D,aa=new D,Ju=new D,Ep=new D,Cp=new D,la=new D;function Nb(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){la.fromArray(n,s);const a=r.x*Math.abs(la.x)+r.y*Math.abs(la.y)+r.z*Math.abs(la.z),l=e.dot(la),c=t.dot(la),u=i.dot(la);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const g6=new eo,Qu=new D,kb=new D;class io{constructor(e=new D,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):g6.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Qu.subVectors(e,this.center);const t=Qu.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(Qu,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(kb.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Qu.copy(e.center).add(kb)),this.expandByPoint(Qu.copy(e.center).sub(kb))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const bs=new D,Bb=new D,Dp=new D,ro=new D,Vb=new D,Ap=new D,Ub=new D;class ed{constructor(e=new D,t=new D(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,bs)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=bs.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(bs.copy(this.direction).multiplyScalar(t).add(this.origin),bs.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){Bb.copy(e).add(t).multiplyScalar(.5),Dp.copy(t).sub(e).normalize(),ro.copy(this.origin).sub(Bb);const s=.5*e.distanceTo(t),o=-this.direction.dot(Dp),a=ro.dot(this.direction),l=-ro.dot(Dp),c=ro.lengthSq(),u=Math.abs(1-o*o);let d,h,f,p;if(u>0)if(d=o*l-a,h=o*a-l,p=s*u,d>=0)if(h>=-p)if(h<=p){const m=1/u;d*=m,h*=m,f=d*(d+o*h+2*a)+h*(o*d+h+2*l)+c}else h=s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h=-s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h<=-p?(d=Math.max(0,-(-o*s+a)),h=d>0?-s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c):h<=p?(d=0,h=Math.min(Math.max(-s,-l),s),f=h*(h+2*l)+c):(d=Math.max(0,-(o*s+a)),h=d>0?s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c);else h=o>0?-s:s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;return i&&i.copy(this.direction).multiplyScalar(d).add(this.origin),r&&r.copy(Dp).multiplyScalar(h).add(Bb),f}intersectSphere(e,t){bs.subVectors(e.center,this.origin);const i=bs.dot(this.direction),r=bs.dot(bs)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return a<0&&l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return c>=0?(i=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(i=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),u>=0?(s=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-h.z)*d,l=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,l=(e.min.z-h.z)*d),i>l||a>r)||((a>i||i!=i)&&(i=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,bs)}intersectTriangle(e,t,i,r,s){Vb.subVectors(t,e),Ap.subVectors(i,e),Ub.crossVectors(Vb,Ap);let a,o=this.direction.dot(Ub);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}ro.subVectors(this.origin,e);const l=a*this.direction.dot(Ap.crossVectors(ro,Ap));if(l<0)return null;const c=a*this.direction.dot(Vb.cross(ro));if(c<0||l+c>o)return null;const u=-a*ro.dot(Ub);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class He{constructor(){He.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,i,r,s,o,a,l,c,u,d,h,f,p,m,g){const y=this.elements;return y[0]=e,y[4]=t,y[8]=i,y[12]=r,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=c,y[6]=u,y[10]=d,y[14]=h,y[3]=f,y[7]=p,y[11]=m,y[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new He).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/Wl.setFromMatrixColumn(e,0).length(),s=1/Wl.setFromMatrixColumn(e,1).length(),o=1/Wl.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if("XYZ"===e.order){const h=o*u,f=o*d,p=a*u,m=a*d;t[0]=l*u,t[4]=-l*d,t[8]=c,t[1]=f+p*c,t[5]=h-m*c,t[9]=-a*l,t[2]=m-h*c,t[6]=p+f*c,t[10]=o*l}else if("YXZ"===e.order){const h=l*u,f=l*d,p=c*u,m=c*d;t[0]=h+m*a,t[4]=p*a-f,t[8]=o*c,t[1]=o*d,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=m+h*a,t[10]=o*l}else if("ZXY"===e.order){const h=l*u,f=l*d,p=c*u,m=c*d;t[0]=h-m*a,t[4]=-o*d,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=m-h*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const h=o*u,f=o*d,p=a*u,m=a*d;t[0]=l*u,t[4]=p*c-f,t[8]=h*c+m,t[1]=l*d,t[5]=m*c+h,t[9]=f*c-p,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const h=o*l,f=o*c,p=a*l,m=a*c;t[0]=l*u,t[4]=m-h*d,t[8]=p*d+f,t[1]=d,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*d+p,t[10]=h-m*d}else if("XZY"===e.order){const h=o*l,f=o*c,p=a*l,m=a*c;t[0]=l*u,t[4]=-d,t[8]=c*u,t[1]=h*d+m,t[5]=o*u,t[9]=f*d-p,t[2]=p*d-f,t[6]=a*u,t[10]=m*d+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(_6,e,y6)}lookAt(e,t,i){const r=this.elements;return Oi.subVectors(e,t),0===Oi.lengthSq()&&(Oi.z=1),Oi.normalize(),so.crossVectors(i,Oi),0===so.lengthSq()&&(1===Math.abs(i.z)?Oi.x+=1e-4:Oi.z+=1e-4,Oi.normalize(),so.crossVectors(i,Oi)),so.normalize(),Tp.crossVectors(Oi,so),r[0]=so.x,r[4]=Tp.x,r[8]=Oi.x,r[1]=so.y,r[5]=Tp.y,r[9]=Oi.y,r[2]=so.z,r[6]=Tp.z,r[10]=Oi.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],u=i[1],d=i[5],h=i[9],f=i[13],p=i[2],m=i[6],g=i[10],y=i[14],v=i[3],_=i[7],b=i[11],w=i[15],M=r[0],C=r[4],x=r[8],S=r[12],I=r[1],L=r[5],k=r[9],P=r[13],R=r[2],j=r[6],O=r[10],G=r[14],N=r[3],$=r[7],Y=r[11],pe=r[15];return s[0]=o*M+a*I+l*R+c*N,s[4]=o*C+a*L+l*j+c*$,s[8]=o*x+a*k+l*O+c*Y,s[12]=o*S+a*P+l*G+c*pe,s[1]=u*M+d*I+h*R+f*N,s[5]=u*C+d*L+h*j+f*$,s[9]=u*x+d*k+h*O+f*Y,s[13]=u*S+d*P+h*G+f*pe,s[2]=p*M+m*I+g*R+y*N,s[6]=p*C+m*L+g*j+y*$,s[10]=p*x+m*k+g*O+y*Y,s[14]=p*S+m*P+g*G+y*pe,s[3]=v*M+_*I+b*R+w*N,s[7]=v*C+_*L+b*j+w*$,s[11]=v*x+_*k+b*O+w*Y,s[15]=v*S+_*P+b*G+w*pe,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],d=e[6],h=e[10],f=e[14];return e[3]*(+s*l*d-r*c*d-s*a*h+i*c*h+r*a*f-i*l*f)+e[7]*(+t*l*f-t*c*h+s*o*h-r*o*f+r*c*u-s*l*u)+e[11]*(+t*c*d-t*a*f-s*o*d+i*o*f+s*a*u-i*c*u)+e[15]*(-r*a*u-t*l*d+t*a*h+r*o*d-i*o*h+i*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],f=e[11],p=e[12],m=e[13],g=e[14],y=e[15],v=d*g*c-m*h*c+m*l*f-a*g*f-d*l*y+a*h*y,_=p*h*c-u*g*c-p*l*f+o*g*f+u*l*y-o*h*y,b=u*m*c-p*d*c+p*a*f-o*m*f-u*a*y+o*d*y,w=p*d*l-u*m*l-p*a*h+o*m*h+u*a*g-o*d*g,M=t*v+i*_+r*b+s*w;if(0===M)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const C=1/M;return e[0]=v*C,e[1]=(m*h*s-d*g*s-m*r*f+i*g*f+d*r*y-i*h*y)*C,e[2]=(a*g*s-m*l*s+m*r*c-i*g*c-a*r*y+i*l*y)*C,e[3]=(d*l*s-a*h*s-d*r*c+i*h*c+a*r*f-i*l*f)*C,e[4]=_*C,e[5]=(u*g*s-p*h*s+p*r*f-t*g*f-u*r*y+t*h*y)*C,e[6]=(p*l*s-o*g*s-p*r*c+t*g*c+o*r*y-t*l*y)*C,e[7]=(o*h*s-u*l*s+u*r*c-t*h*c-o*r*f+t*l*f)*C,e[8]=b*C,e[9]=(p*d*s-u*m*s-p*i*f+t*m*f+u*i*y-t*d*y)*C,e[10]=(o*m*s-p*a*s+p*i*c-t*m*c-o*i*y+t*a*y)*C,e[11]=(u*a*s-o*d*s-u*i*c+t*d*c+o*i*f-t*a*f)*C,e[12]=w*C,e[13]=(u*m*r-p*d*r+p*i*h-t*m*h-u*i*g+t*d*g)*C,e[14]=(p*a*r-o*m*r-p*i*l+t*m*l+o*i*g-t*a*g)*C,e[15]=(o*d*r-u*a*r+u*i*l-t*d*l-o*i*h+t*a*h)*C,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,d=a+a,h=s*c,f=s*u,p=s*d,m=o*u,g=o*d,y=a*d,v=l*c,_=l*u,b=l*d,w=i.x,M=i.y,C=i.z;return r[0]=(1-(m+y))*w,r[1]=(f+b)*w,r[2]=(p-_)*w,r[3]=0,r[4]=(f-b)*M,r[5]=(1-(h+y))*M,r[6]=(g+v)*M,r[7]=0,r[8]=(p+_)*C,r[9]=(g-v)*C,r[10]=(1-(h+m))*C,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=Wl.set(r[0],r[1],r[2]).length();const o=Wl.set(r[4],r[5],r[6]).length(),a=Wl.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Mr.copy(this);const c=1/s,u=1/o,d=1/a;return Mr.elements[0]*=c,Mr.elements[1]*=c,Mr.elements[2]*=c,Mr.elements[4]*=u,Mr.elements[5]*=u,Mr.elements[6]*=u,Mr.elements[8]*=d,Mr.elements[9]*=d,Mr.elements[10]*=d,t.setFromRotationMatrix(Mr),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o){const a=this.elements,c=2*s/(i-r),u=(t+e)/(t-e),d=(i+r)/(i-r),h=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=2*s/(t-e),a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=d,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,i,r,s,o){const a=this.elements,l=1/(t-e),c=1/(i-r),u=1/(o-s),d=(t+e)*l,h=(i+r)*c,f=(o+s)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-d,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Wl=new D,Mr=new He,_6=new D(0,0,0),y6=new D(1,1,1),so=new D,Tp=new D,Oi=new D,NI=new He,kI=new Qn;let BI=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],u=s[5],d=s[9],h=s[2],f=s[6],p=s[10];switch(i){case"XYZ":this._y=Math.asin(un(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-un(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(un(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-un(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(un(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(l,p));break;case"XZY":this._z=Math.asin(-un(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-d,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return NI.makeRotationFromQuaternion(t),this.setFromRotationMatrix(NI,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return kI.setFromEuler(this),this.setFromQuaternion(kI,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class ca{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let v6=0;const VI=new D,$l=new Qn,xs=new He,Ip=new D,td=new D,b6=new D,x6=new Qn,UI=new D(1,0,0),zI=new D(0,1,0),HI=new D(0,0,1),w6={type:"added"},GI={type:"removed"};let Vt=(()=>{class n extends _s{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:v6++}),this.uuid=Fi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new D,i=new BI,r=new Qn,s=new D(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new He},normalMatrix:{value:new ci}}),this.matrix=new He,this.matrixWorld=new He,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new ca,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return $l.setFromAxisAngle(t,i),this.quaternion.multiply($l),this}rotateOnWorldAxis(t,i){return $l.setFromAxisAngle(t,i),this.quaternion.premultiply($l),this}rotateX(t){return this.rotateOnAxis(UI,t)}rotateY(t){return this.rotateOnAxis(zI,t)}rotateZ(t){return this.rotateOnAxis(HI,t)}translateOnAxis(t,i){return VI.copy(t).applyQuaternion(this.quaternion),this.position.add(VI.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(UI,t)}translateY(t){return this.translateOnAxis(zI,t)}translateZ(t){return this.translateOnAxis(HI,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(xs.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?Ip.copy(t):Ip.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),td.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?xs.lookAt(td,Ip,this.up):xs.lookAt(Ip,td,this.up),this.quaternion.setFromRotationMatrix(xs),s&&(xs.extractRotation(s.matrixWorld),$l.setFromRotationMatrix(xs),this.quaternion.premultiply($l.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(w6)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(GI)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const i=this.children[t];i.parent=null,i.dispatchEvent(GI)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),xs.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),xs.multiply(t.parent.matrixWorld)),t.applyMatrix4(xs),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getObjectsByProperty(t,i){let r=[];this[t]===i&&r.push(this);for(let s=0,o=this.children.length;s<o;s++){const a=this.children[s].getObjectsByProperty(t,i);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(td,t,b6),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(td,x6,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++){const o=i[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const s=this.children;for(let o=0,a=s.length;o<a;o++){const l=s[o];!0===l.matrixWorldAutoUpdate&&l.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const s={};function o(l,c){return void 0===l[c.uuid]&&(l[c.uuid]=c.toJSON(t)),c.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const c=l.shapes;if(Array.isArray(c))for(let u=0,d=c.length;u<d;u++)o(t.shapes,c[u]);else o(t.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let c=0,u=this.material.length;c<u;c++)l.push(o(t.materials,this.material[c]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++)s.animations.push(o(t.animations,this.animations[l]))}if(i){const l=a(t.geometries),c=a(t.materials),u=a(t.textures),d=a(t.images),h=a(t.shapes),f=a(t.skeletons),p=a(t.animations),m=a(t.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),h.length>0&&(r.shapes=h),f.length>0&&(r.skeletons=f),p.length>0&&(r.animations=p),m.length>0&&(r.nodes=m)}return r.object=s,r;function a(l){const c=[];for(const u in l){const d=l[u];delete d.metadata,c.push(d)}return c}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new D(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const Sr=new D,ws=new D,zb=new D,Ms=new D,ql=new D,Xl=new D,jI=new D,Hb=new D,Gb=new D,jb=new D;class er{constructor(e=new D,t=new D,i=new D){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Sr.subVectors(e,t),r.cross(Sr);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){Sr.subVectors(r,t),ws.subVectors(i,t),zb.subVectors(e,t);const o=Sr.dot(Sr),a=Sr.dot(ws),l=Sr.dot(zb),c=ws.dot(ws),u=ws.dot(zb),d=o*c-a*a;if(0===d)return s.set(-2,-1,-1);const h=1/d,f=(c*l-a*u)*h,p=(o*u-a*l)*h;return s.set(1-f-p,p,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Ms),Ms.x>=0&&Ms.y>=0&&Ms.x+Ms.y<=1}static getUV(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,Ms),l.set(0,0),l.addScaledVector(s,Ms.x),l.addScaledVector(o,Ms.y),l.addScaledVector(a,Ms.z),l}static isFrontFacing(e,t,i,r){return Sr.subVectors(i,t),ws.subVectors(e,t),Sr.cross(ws).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Sr.subVectors(this.c,this.b),ws.subVectors(this.a,this.b),.5*Sr.cross(ws).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return er.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return er.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return er.getUV(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return er.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return er.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;ql.subVectors(r,i),Xl.subVectors(s,i),Hb.subVectors(e,i);const l=ql.dot(Hb),c=Xl.dot(Hb);if(l<=0&&c<=0)return t.copy(i);Gb.subVectors(e,r);const u=ql.dot(Gb),d=Xl.dot(Gb);if(u>=0&&d<=u)return t.copy(r);const h=l*d-u*c;if(h<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(i).addScaledVector(ql,o);jb.subVectors(e,s);const f=ql.dot(jb),p=Xl.dot(jb);if(p>=0&&f<=p)return t.copy(s);const m=f*c-l*p;if(m<=0&&c>=0&&p<=0)return a=c/(c-p),t.copy(i).addScaledVector(Xl,a);const g=u*p-f*d;if(g<=0&&d-u>=0&&f-p>=0)return jI.subVectors(s,r),a=(d-u)/(d-u+(f-p)),t.copy(r).addScaledVector(jI,a);const y=1/(g+m+h);return o=m*y,a=h*y,t.copy(i).addScaledVector(ql,o).addScaledVector(Xl,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let M6=0;class Dn extends _s{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:M6++}),this.uuid=Fi(),this.name="",this.type="Material",this.blending=Ko,this.side=jr,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Yv,this.blendDst=Kv,this.blendEquation=Zo,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ap,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=II,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=yp,this.stencilZFail=yp,this.stencilZPass=yp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Ko&&(i.blending=this.blending),this.side!==jr&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(i.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class Li extends Dn{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new me(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Gu,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const vn=new D,Rp=new ee;class Dt{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=Xu,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)Rp.fromBufferAttribute(this,t),Rp.applyMatrix3(e),this.setXY(t,Rp.x,Rp.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)vn.fromBufferAttribute(this,t),vn.applyMatrix3(e),this.setXYZ(t,vn.x,vn.y,vn.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)vn.fromBufferAttribute(this,t),vn.applyMatrix4(e),this.setXYZ(t,vn.x,vn.y,vn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)vn.fromBufferAttribute(this,t),vn.applyNormalMatrix(e),this.setXYZ(t,vn.x,vn.y,vn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)vn.fromBufferAttribute(this,t),vn.transformDirection(e),this.setXYZ(t,vn.x,vn.y,vn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ys(t,this.array)),t}setX(e,t){return this.normalized&&(t=Bt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ys(t,this.array)),t}setY(e,t){return this.normalized&&(t=Bt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ys(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Bt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ys(t,this.array)),t}setW(e,t){return this.normalized&&(t=Bt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Bt(t,this.array),i=Bt(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Bt(t,this.array),i=Bt(i,this.array),r=Bt(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Bt(t,this.array),i=Bt(i,this.array),r=Bt(r,this.array),s=Bt(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Xu&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class S6 extends Dt{constructor(e,t,i){super(new Int8Array(e),t,i)}}class E6 extends Dt{constructor(e,t,i){super(new Uint8Array(e),t,i)}}class C6 extends Dt{constructor(e,t,i){super(new Uint8ClampedArray(e),t,i)}}class D6 extends Dt{constructor(e,t,i){super(new Int16Array(e),t,i)}}class Wb extends Dt{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class A6 extends Dt{constructor(e,t,i){super(new Int32Array(e),t,i)}}class $b extends Dt{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class T6 extends Dt{constructor(e,t,i){super(new Uint16Array(e),t,i),this.isFloat16BufferAttribute=!0}}class Ee extends Dt{constructor(e,t,i){super(new Float32Array(e),t,i)}}class I6 extends Dt{constructor(e,t,i){super(new Float64Array(e),t,i)}}let R6=0;const tr=new He,qb=new Vt,Yl=new D,Ni=new eo,nd=new eo,Fn=new D;class et extends _s{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:R6++}),this.uuid=Fi(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(FI(e)?$b:Wb)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new ci).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return tr.makeRotationFromQuaternion(e),this.applyMatrix4(tr),this}rotateX(e){return tr.makeRotationX(e),this.applyMatrix4(tr),this}rotateY(e){return tr.makeRotationY(e),this.applyMatrix4(tr),this}rotateZ(e){return tr.makeRotationZ(e),this.applyMatrix4(tr),this}translate(e,t,i){return tr.makeTranslation(e,t,i),this.applyMatrix4(tr),this}scale(e,t,i){return tr.makeScale(e,t,i),this.applyMatrix4(tr),this}lookAt(e){return qb.lookAt(e),qb.updateMatrix(),this.applyMatrix4(qb.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Yl).negate(),this.translate(Yl.x,Yl.y,Yl.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ee(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new eo);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new D(-1/0,-1/0,-1/0),new D(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)Ni.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(Fn.addVectors(this.boundingBox.min,Ni.min),this.boundingBox.expandByPoint(Fn),Fn.addVectors(this.boundingBox.max,Ni.max),this.boundingBox.expandByPoint(Fn)):(this.boundingBox.expandByPoint(Ni.min),this.boundingBox.expandByPoint(Ni.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new io);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new D,1/0);if(e){const i=this.boundingSphere.center;if(Ni.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)nd.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(Fn.addVectors(Ni.min,nd.min),Ni.expandByPoint(Fn),Fn.addVectors(Ni.max,nd.max),Ni.expandByPoint(Fn)):(Ni.expandByPoint(nd.min),Ni.expandByPoint(nd.max));Ni.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Fn.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Fn));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)Fn.fromBufferAttribute(a,c),l&&(Yl.fromBufferAttribute(e,c),Fn.add(Yl)),r=Math.max(r,i.distanceToSquared(Fn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Dt(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let I=0;I<a;I++)c[I]=new D,u[I]=new D;const d=new D,h=new D,f=new D,p=new ee,m=new ee,g=new ee,y=new D,v=new D;function _(I,L,k){d.fromArray(r,3*I),h.fromArray(r,3*L),f.fromArray(r,3*k),p.fromArray(o,2*I),m.fromArray(o,2*L),g.fromArray(o,2*k),h.sub(d),f.sub(d),m.sub(p),g.sub(p);const P=1/(m.x*g.y-g.x*m.y);isFinite(P)&&(y.copy(h).multiplyScalar(g.y).addScaledVector(f,-m.y).multiplyScalar(P),v.copy(f).multiplyScalar(m.x).addScaledVector(h,-g.x).multiplyScalar(P),c[I].add(y),c[L].add(y),c[k].add(y),u[I].add(v),u[L].add(v),u[k].add(v))}let b=this.groups;0===b.length&&(b=[{start:0,count:i.length}]);for(let I=0,L=b.length;I<L;++I){const k=b[I],P=k.start;for(let j=P,O=P+k.count;j<O;j+=3)_(i[j+0],i[j+1],i[j+2])}const w=new D,M=new D,C=new D,x=new D;function S(I){C.fromArray(s,3*I),x.copy(C);const L=c[I];w.copy(L),w.sub(C.multiplyScalar(C.dot(L))).normalize(),M.crossVectors(x,L);const P=M.dot(u[I])<0?-1:1;l[4*I]=w.x,l[4*I+1]=w.y,l[4*I+2]=w.z,l[4*I+3]=P}for(let I=0,L=b.length;I<L;++I){const k=b[I],P=k.start;for(let j=P,O=P+k.count;j<O;j+=3)S(i[j+0]),S(i[j+1]),S(i[j+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new Dt(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let h=0,f=i.count;h<f;h++)i.setXYZ(h,0,0,0);const r=new D,s=new D,o=new D,a=new D,l=new D,c=new D,u=new D,d=new D;if(e)for(let h=0,f=e.count;h<f;h+=3){const p=e.getX(h+0),m=e.getX(h+1),g=e.getX(h+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,m),o.fromBufferAttribute(t,g),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,m),c.fromBufferAttribute(i,g),a.add(u),l.add(u),c.add(u),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(m,l.x,l.y,l.z),i.setXYZ(g,c.x,c.y,c.z)}else for(let h=0,f=t.count;h<f;h+=3)r.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Fn.fromBufferAttribute(e,t),Fn.normalize(),e.setXYZ(t,Fn.x,Fn.y,Fn.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,d=a.normalized,h=new c.constructor(l.length*u);let f=0,p=0;for(let m=0,g=l.length;m<g;m++){f=a.isInterleavedBufferAttribute?l[m]*a.data.stride+a.offset:l[m]*u;for(let y=0;y<u;y++)h[p++]=c[f++]}return new Dt(h,u,d)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new et,i=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,d=c.length;u<d;u++){const f=e(c[u],i);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,h=c.length;d<h;d++)u.push(c[d].toJSON(e.data));u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const u=[],d=s[c];for(let h=0,f=d.length;h<f;h++)u.push(d[h].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const d=o[c];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const WI=new He,Kl=new ed,Xb=new io,id=new D,rd=new D,sd=new D,Yb=new D,Pp=new D,Fp=new ee,Op=new ee,Lp=new ee,Kb=new D,Np=new D;class On extends Vt{constructor(e=new et,t=new Li){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){Pp.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l];0!==u&&(Yb.fromBufferAttribute(s[l],e),Pp.addScaledVector(o?Yb:Yb.sub(t),u))}t.add(Pp)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===i.boundingSphere&&i.computeBoundingSphere(),Xb.copy(i.boundingSphere),Xb.applyMatrix4(s),!1===e.ray.intersectsSphere(Xb))||(WI.copy(s).invert(),Kl.copy(e.ray).applyMatrix4(WI),null!==i.boundingBox&&!1===Kl.intersectsBox(i.boundingBox)))return;let o;const a=i.index,l=i.attributes.position,c=i.attributes.uv,u=i.attributes.uv2,d=i.groups,h=i.drawRange;if(null!==a)if(Array.isArray(r))for(let f=0,p=d.length;f<p;f++){const m=d[f],g=r[m.materialIndex];for(let _=Math.max(m.start,h.start),b=Math.min(a.count,Math.min(m.start+m.count,h.start+h.count));_<b;_+=3){const w=a.getX(_),M=a.getX(_+1),C=a.getX(_+2);o=kp(this,g,e,Kl,c,u,w,M,C),o&&(o.faceIndex=Math.floor(_/3),o.face.materialIndex=m.materialIndex,t.push(o))}}else for(let m=Math.max(0,h.start),g=Math.min(a.count,h.start+h.count);m<g;m+=3){const y=a.getX(m),v=a.getX(m+1),_=a.getX(m+2);o=kp(this,r,e,Kl,c,u,y,v,_),o&&(o.faceIndex=Math.floor(m/3),t.push(o))}else if(void 0!==l)if(Array.isArray(r))for(let f=0,p=d.length;f<p;f++){const m=d[f],g=r[m.materialIndex];for(let _=Math.max(m.start,h.start),b=Math.min(l.count,Math.min(m.start+m.count,h.start+h.count));_<b;_+=3)o=kp(this,g,e,Kl,c,u,_,_+1,_+2),o&&(o.faceIndex=Math.floor(_/3),o.face.materialIndex=m.materialIndex,t.push(o))}else for(let m=Math.max(0,h.start),g=Math.min(l.count,h.start+h.count);m<g;m+=3)o=kp(this,r,e,Kl,c,u,m,m+1,m+2),o&&(o.faceIndex=Math.floor(m/3),t.push(o))}}function kp(n,e,t,i,r,s,o,a,l){n.getVertexPosition(o,id),n.getVertexPosition(a,rd),n.getVertexPosition(l,sd);const c=function P6(n,e,t,i,r,s,o,a){let l;if(l=e.side===xi?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,e.side===jr,a),null===l)return null;Np.copy(a),Np.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(Np);return c<t.near||c>t.far?null:{distance:c,point:Np.clone(),object:n}}(n,e,t,i,id,rd,sd,Kb);if(c){r&&(Fp.fromBufferAttribute(r,o),Op.fromBufferAttribute(r,a),Lp.fromBufferAttribute(r,l),c.uv=er.getUV(Kb,id,rd,sd,Fp,Op,Lp,new ee)),s&&(Fp.fromBufferAttribute(s,o),Op.fromBufferAttribute(s,a),Lp.fromBufferAttribute(s,l),c.uv2=er.getUV(Kb,id,rd,sd,Fp,Op,Lp,new ee));const u={a:o,b:a,c:l,normal:new D,materialIndex:0};er.getNormal(id,rd,sd,u.normal),c.face=u}return c}class oo extends et{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],d=[];let h=0,f=0;function p(m,g,y,v,_,b,w,M,C,x,S){const I=b/C,L=w/x,k=b/2,P=w/2,R=M/2,j=C+1,O=x+1;let G=0,N=0;const $=new D;for(let Y=0;Y<O;Y++){const pe=Y*L-P;for(let B=0;B<j;B++)$[m]=(B*I-k)*v,$[g]=pe*_,$[y]=R,c.push($.x,$.y,$.z),$[m]=0,$[g]=0,$[y]=M>0?1:-1,u.push($.x,$.y,$.z),d.push(B/C),d.push(1-Y/x),G+=1}for(let Y=0;Y<x;Y++)for(let pe=0;pe<C;pe++){const te=h+pe+j*(Y+1),ne=h+(pe+1)+j*(Y+1),ce=h+(pe+1)+j*Y;l.push(h+pe+j*Y,te,ce),l.push(te,ne,ce),N+=6}a.addGroup(f,N,S),f+=N,h+=G}p("z","y","x",-1,-1,i,t,e,o,s,0),p("z","y","x",1,-1,i,t,-e,o,s,1),p("x","z","y",1,1,e,i,t,r,o,2),p("x","z","y",1,-1,e,i,-t,r,o,3),p("x","y","z",1,-1,e,t,i,r,s,4),p("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new Ee(c,3)),this.setAttribute("normal",new Ee(u,3)),this.setAttribute("uv",new Ee(d,2))}static fromJSON(e){return new oo(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Zl(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];e[t][i]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function ui(n){const e={};for(let t=0;t<n.length;t++){const i=Zl(n[t]);for(const r in i)e[r]=i[r]}return e}function $I(n){return null===n.getRenderTarget()&&n.outputEncoding===mt?br:Vl}const qI={clone:Zl,merge:ui};class qr extends Dn{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Zl(e.uniforms),this.uniformsGroups=function F6(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class Bp extends Vt{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new He,this.projectionMatrix=new He,this.projectionMatrixInverse=new He}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class An extends Bp{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Yu*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*ia*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Yu*Math.atan(Math.tan(.5*ia*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*ia*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class XI extends Vt{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i;const r=new An(-90,1,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);const s=new An(-90,1,e,t);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),this.add(s);const o=new An(-90,1,e,t);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(0,1,0),this.add(o);const a=new An(-90,1,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);const l=new An(-90,1,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,1),this.add(l);const c=new An(-90,1,e,t);c.layers=this.layers,c.up.set(0,1,0),c.lookAt(0,0,-1),this.add(c)}update(e,t){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget,[r,s,o,a,l,c]=this.children,u=e.getRenderTarget(),d=e.toneMapping,h=e.xr.enabled;e.toneMapping=vr,e.xr.enabled=!1;const f=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,s),e.setRenderTarget(i,2),e.render(t,o),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,l),i.texture.generateMipmaps=f,e.setRenderTarget(i,5),e.render(t,c),e.setRenderTarget(u),e.toneMapping=d,e.xr.enabled=h,i.texture.needsPMREMUpdate=!0}}class od extends Hn{constructor(e,t,i,r,s,o,a,l,c,u){super(e=void 0!==e?e:[],t=void 0!==t?t:qs,i,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class YI extends wr{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1};this.texture=new od([i,i,i,i,i,i],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Jt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new oo(5,5,5),s=new qr({name:"CubemapFromEquirect",uniforms:Zl(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:xi,blending:ps});s.uniforms.tEquirect.value=t;const o=new On(r,s),a=t.minFilter;return t.minFilter===$r&&(t.minFilter=Jt),new XI(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const Zb=new D,N6=new D,k6=new ci;class ao{constructor(e=new D(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=Zb.subVectors(i,t).cross(N6.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const i=e.delta(Zb),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(i).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||k6.getNormalMatrix(e),r=this.coplanarPoint(Zb).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const ec=new io,Vp=new D;class Up{constructor(e=new ao,t=new ao,i=new ao,r=new ao,s=new ao,o=new ao){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],u=i[6],d=i[7],h=i[8],f=i[9],p=i[10],m=i[11],g=i[12],y=i[13],v=i[14],_=i[15];return t[0].setComponents(a-r,d-l,m-h,_-g).normalize(),t[1].setComponents(a+r,d+l,m+h,_+g).normalize(),t[2].setComponents(a+s,d+c,m+f,_+y).normalize(),t[3].setComponents(a-s,d-c,m-f,_-y).normalize(),t[4].setComponents(a-o,d-u,m-p,_-v).normalize(),t[5].setComponents(a+o,d+u,m+p,_+v).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),ec.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(ec)}intersectsSprite(e){return ec.center.set(0,0,0),ec.radius=.7071067811865476,ec.applyMatrix4(e.matrixWorld),this.intersectsSphere(ec)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Vp.x=r.normal.x>0?e.max.x:e.min.x,Vp.y=r.normal.y>0?e.max.y:e.min.y,Vp.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Vp)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function KI(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function B6(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);u&&(n.deleteBuffer(u.buffer),i.delete(c))},update:function l(c,u){if(c.isGLBufferAttribute){const h=i.get(c);return void((!h||h.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const d=i.get(c);void 0===d?i.set(c,function r(c,u){const d=c.array,h=c.usage,f=n.createBuffer();let p;if(n.bindBuffer(u,f),n.bufferData(u,d,h),c.onUploadCallback(),d instanceof Float32Array)p=5126;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");p=5131}else p=5123;else if(d instanceof Int16Array)p=5122;else if(d instanceof Uint32Array)p=5125;else if(d instanceof Int32Array)p=5124;else if(d instanceof Int8Array)p=5120;else if(d instanceof Uint8Array)p=5121;else{if(!(d instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);p=5121}return{buffer:f,type:p,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version}}(c,u)):d.version<c.version&&(function s(c,u,d){const h=u.array,f=u.updateRange;n.bindBuffer(d,c),-1===f.count?n.bufferSubData(d,0,h):(t?n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()}(d.buffer,c,u),d.version=c.version)}}}class tc extends et{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,d=e/a,h=t/l,f=[],p=[],m=[],g=[];for(let y=0;y<u;y++){const v=y*h-o;for(let _=0;_<c;_++)p.push(_*d-s,-v,0),m.push(0,0,1),g.push(_/a),g.push(1-y/l)}for(let y=0;y<l;y++)for(let v=0;v<a;v++){const b=v+c*(y+1),w=v+1+c*(y+1),M=v+1+c*y;f.push(v+c*y,b,M),f.push(b,w,M)}this.setIndex(f),this.setAttribute("position",new Ee(p,3)),this.setAttribute("normal",new Ee(m,3)),this.setAttribute("uv",new Ee(g,2))}static fromJSON(e){return new tc(e.width,e.height,e.widthSegments,e.heightSegments)}}const tt={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},fe={common:{diffuse:{value:new me(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ci},uv2Transform:{value:new ci},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ee(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new me(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new me(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ci}},sprite:{diffuse:{value:new me(16777215)},opacity:{value:1},center:{value:new ee(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ci}}},Er={basic:{uniforms:ui([fe.common,fe.specularmap,fe.envmap,fe.aomap,fe.lightmap,fe.fog]),vertexShader:tt.meshbasic_vert,fragmentShader:tt.meshbasic_frag},lambert:{uniforms:ui([fe.common,fe.specularmap,fe.envmap,fe.aomap,fe.lightmap,fe.emissivemap,fe.bumpmap,fe.normalmap,fe.displacementmap,fe.fog,fe.lights,{emissive:{value:new me(0)}}]),vertexShader:tt.meshlambert_vert,fragmentShader:tt.meshlambert_frag},phong:{uniforms:ui([fe.common,fe.specularmap,fe.envmap,fe.aomap,fe.lightmap,fe.emissivemap,fe.bumpmap,fe.normalmap,fe.displacementmap,fe.fog,fe.lights,{emissive:{value:new me(0)},specular:{value:new me(1118481)},shininess:{value:30}}]),vertexShader:tt.meshphong_vert,fragmentShader:tt.meshphong_frag},standard:{uniforms:ui([fe.common,fe.envmap,fe.aomap,fe.lightmap,fe.emissivemap,fe.bumpmap,fe.normalmap,fe.displacementmap,fe.roughnessmap,fe.metalnessmap,fe.fog,fe.lights,{emissive:{value:new me(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:tt.meshphysical_vert,fragmentShader:tt.meshphysical_frag},toon:{uniforms:ui([fe.common,fe.aomap,fe.lightmap,fe.emissivemap,fe.bumpmap,fe.normalmap,fe.displacementmap,fe.gradientmap,fe.fog,fe.lights,{emissive:{value:new me(0)}}]),vertexShader:tt.meshtoon_vert,fragmentShader:tt.meshtoon_frag},matcap:{uniforms:ui([fe.common,fe.bumpmap,fe.normalmap,fe.displacementmap,fe.fog,{matcap:{value:null}}]),vertexShader:tt.meshmatcap_vert,fragmentShader:tt.meshmatcap_frag},points:{uniforms:ui([fe.points,fe.fog]),vertexShader:tt.points_vert,fragmentShader:tt.points_frag},dashed:{uniforms:ui([fe.common,fe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:tt.linedashed_vert,fragmentShader:tt.linedashed_frag},depth:{uniforms:ui([fe.common,fe.displacementmap]),vertexShader:tt.depth_vert,fragmentShader:tt.depth_frag},normal:{uniforms:ui([fe.common,fe.bumpmap,fe.normalmap,fe.displacementmap,{opacity:{value:1}}]),vertexShader:tt.meshnormal_vert,fragmentShader:tt.meshnormal_frag},sprite:{uniforms:ui([fe.sprite,fe.fog]),vertexShader:tt.sprite_vert,fragmentShader:tt.sprite_frag},background:{uniforms:{uvTransform:{value:new ci},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:tt.background_vert,fragmentShader:tt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:tt.backgroundCube_vert,fragmentShader:tt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:tt.cube_vert,fragmentShader:tt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:tt.equirect_vert,fragmentShader:tt.equirect_frag},distanceRGBA:{uniforms:ui([fe.common,fe.displacementmap,{referencePosition:{value:new D},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:tt.distanceRGBA_vert,fragmentShader:tt.distanceRGBA_frag},shadow:{uniforms:ui([fe.lights,fe.fog,{color:{value:new me(0)},opacity:{value:1}}]),vertexShader:tt.shadow_vert,fragmentShader:tt.shadow_frag}};Er.physical={uniforms:ui([Er.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ee(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new me(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ee},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new me(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new me(1,1,1)},specularColorMap:{value:null}}]),vertexShader:tt.meshphysical_vert,fragmentShader:tt.meshphysical_frag};const zp={r:0,b:0,g:0};function k9(n,e,t,i,r,s,o){const a=new me(0);let c,u,l=!0===s?0:1,d=null,h=0,f=null;function m(g,y){g.getRGB(zp,$I(n)),i.buffers.color.setClear(zp.r,zp.g,zp.b,y,o)}return{getClearColor:function(){return a},setClearColor:function(g,y=1){a.set(g),l=y,m(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,m(a,l)},render:function p(g,y){let v=!1,_=!0===y.isScene?y.background:null;_&&_.isTexture&&(_=(y.backgroundBlurriness>0?t:e).get(_));const b=n.xr,w=b.getSession&&b.getSession();w&&"additive"===w.environmentBlendMode&&(_=null),null===_?m(a,l):_&&_.isColor&&(m(_,1),v=!0),(n.autoClear||v)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),_&&(_.isCubeTexture||_.mapping===Ol)?(void 0===u&&(u=new On(new oo(1,1,1),new qr({name:"BackgroundCubeMaterial",uniforms:Zl(Er.backgroundCube.uniforms),vertexShader:Er.backgroundCube.vertexShader,fragmentShader:Er.backgroundCube.fragmentShader,side:xi,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(M,C,x){this.matrixWorld.copyPosition(x.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=_,u.material.uniforms.flipEnvMap.value=_.isCubeTexture&&!1===_.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=y.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,u.material.toneMapped=_.encoding!==mt,(d!==_||h!==_.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,d=_,h=_.version,f=n.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null)):_&&_.isTexture&&(void 0===c&&(c=new On(new tc(2,2),new qr({name:"BackgroundMaterial",uniforms:Zl(Er.background.uniforms),vertexShader:Er.background.vertexShader,fragmentShader:Er.background.fragmentShader,side:jr,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=_,c.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,c.material.toneMapped=_.encoding!==mt,!0===_.matrixAutoUpdate&&_.updateMatrix(),c.material.uniforms.uvTransform.value.copy(_.matrix),(d!==_||h!==_.version||f!==n.toneMapping)&&(c.material.needsUpdate=!0,d=_,h=_.version,f=n.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}}}function B9(n,e,t,i){const r=n.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=g(null);let c=l,u=!1;function f(R){return i.isWebGL2?n.bindVertexArray(R):s.bindVertexArrayOES(R)}function p(R){return i.isWebGL2?n.deleteVertexArray(R):s.deleteVertexArrayOES(R)}function g(R){const j=[],O=[],G=[];for(let N=0;N<r;N++)j[N]=0,O[N]=0,G[N]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:j,enabledAttributes:O,attributeDivisors:G,object:R,attributes:{},index:null}}function _(){const R=c.newAttributes;for(let j=0,O=R.length;j<O;j++)R[j]=0}function b(R){w(R,0)}function w(R,j){const G=c.enabledAttributes,N=c.attributeDivisors;c.newAttributes[R]=1,0===G[R]&&(n.enableVertexAttribArray(R),G[R]=1),N[R]!==j&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](R,j),N[R]=j)}function M(){const R=c.newAttributes,j=c.enabledAttributes;for(let O=0,G=j.length;O<G;O++)j[O]!==R[O]&&(n.disableVertexAttribArray(O),j[O]=0)}function C(R,j,O,G,N,$){!0!==i.isWebGL2||5124!==O&&5125!==O?n.vertexAttribPointer(R,j,O,G,N,$):n.vertexAttribIPointer(R,j,O,N,$)}function k(){P(),u=!0,c!==l&&(c=l,f(c.object))}function P(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function d(R,j,O,G,N){let $=!1;if(o){const Y=function m(R,j,O){const G=!0===O.wireframe;let N=a[R.id];void 0===N&&(N={},a[R.id]=N);let $=N[j.id];void 0===$&&($={},N[j.id]=$);let Y=$[G];return void 0===Y&&(Y=g(function h(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),$[G]=Y),Y}(G,O,j);c!==Y&&(c=Y,f(c.object)),$=function y(R,j,O,G){const N=c.attributes,$=j.attributes;let Y=0;const pe=O.getAttributes();for(const B in pe)if(pe[B].location>=0){const ne=N[B];let ce=$[B];if(void 0===ce&&("instanceMatrix"===B&&R.instanceMatrix&&(ce=R.instanceMatrix),"instanceColor"===B&&R.instanceColor&&(ce=R.instanceColor)),void 0===ne||ne.attribute!==ce||ce&&ne.data!==ce.data)return!0;Y++}return c.attributesNum!==Y||c.index!==G}(R,G,O,N),$&&function v(R,j,O,G){const N={},$=j.attributes;let Y=0;const pe=O.getAttributes();for(const B in pe)if(pe[B].location>=0){let ne=$[B];void 0===ne&&("instanceMatrix"===B&&R.instanceMatrix&&(ne=R.instanceMatrix),"instanceColor"===B&&R.instanceColor&&(ne=R.instanceColor));const ce={};ce.attribute=ne,ne&&ne.data&&(ce.data=ne.data),N[B]=ce,Y++}c.attributes=N,c.attributesNum=Y,c.index=G}(R,G,O,N)}else{const Y=!0===j.wireframe;(c.geometry!==G.id||c.program!==O.id||c.wireframe!==Y)&&(c.geometry=G.id,c.program=O.id,c.wireframe=Y,$=!0)}null!==N&&t.update(N,34963),($||u)&&(u=!1,function x(R,j,O,G){if(!1===i.isWebGL2&&(R.isInstancedMesh||G.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;_();const N=G.attributes,$=O.getAttributes(),Y=j.defaultAttributeValues;for(const pe in $){const B=$[pe];if(B.location>=0){let te=N[pe];if(void 0===te&&("instanceMatrix"===pe&&R.instanceMatrix&&(te=R.instanceMatrix),"instanceColor"===pe&&R.instanceColor&&(te=R.instanceColor)),void 0!==te){const ne=te.normalized,ce=te.itemSize,z=t.get(te);if(void 0===z)continue;const ve=z.buffer,_e=z.type,be=z.bytesPerElement;if(te.isInterleavedBufferAttribute){const le=te.data,qe=le.stride,Q=te.offset;if(le.isInstancedInterleavedBuffer){for(let J=0;J<B.locationSize;J++)w(B.location+J,le.meshPerAttribute);!0!==R.isInstancedMesh&&void 0===G._maxInstanceCount&&(G._maxInstanceCount=le.meshPerAttribute*le.count)}else for(let J=0;J<B.locationSize;J++)b(B.location+J);n.bindBuffer(34962,ve);for(let J=0;J<B.locationSize;J++)C(B.location+J,ce/B.locationSize,_e,ne,qe*be,(Q+ce/B.locationSize*J)*be)}else{if(te.isInstancedBufferAttribute){for(let le=0;le<B.locationSize;le++)w(B.location+le,te.meshPerAttribute);!0!==R.isInstancedMesh&&void 0===G._maxInstanceCount&&(G._maxInstanceCount=te.meshPerAttribute*te.count)}else for(let le=0;le<B.locationSize;le++)b(B.location+le);n.bindBuffer(34962,ve);for(let le=0;le<B.locationSize;le++)C(B.location+le,ce/B.locationSize,_e,ne,ce*be,ce/B.locationSize*le*be)}}else if(void 0!==Y){const ne=Y[pe];if(void 0!==ne)switch(ne.length){case 2:n.vertexAttrib2fv(B.location,ne);break;case 3:n.vertexAttrib3fv(B.location,ne);break;case 4:n.vertexAttrib4fv(B.location,ne);break;default:n.vertexAttrib1fv(B.location,ne)}}}}M()}(R,j,O,G),null!==N&&n.bindBuffer(34963,t.get(N).buffer))},reset:k,resetDefaultState:P,dispose:function S(){k();for(const R in a){const j=a[R];for(const O in j){const G=j[O];for(const N in G)p(G[N].object),delete G[N];delete j[O]}delete a[R]}},releaseStatesOfGeometry:function I(R){if(void 0===a[R.id])return;const j=a[R.id];for(const O in j){const G=j[O];for(const N in G)p(G[N].object),delete G[N];delete j[O]}delete a[R.id]},releaseStatesOfProgram:function L(R){for(const j in a){const O=a[j];if(void 0===O[R.id])continue;const G=O[R.id];for(const N in G)p(G[N].object),delete G[N];delete O[R.id]}},initAttributes:_,enableAttribute:b,disableUnusedAttributes:M}}function V9(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,u){n.drawArrays(s,c,u),t.update(u,s,1)},this.renderInstances=function l(c,u,d){if(0===d)return;let h,f;if(r)h=n,f="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===h)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[f](s,c,u,d),t.update(u,s,d)}}function U9(n,e,t){let i;function s(C){if("highp"===C){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";C="mediump"}return"mediump"===C&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,d=n.getParameter(34930),h=n.getParameter(35660),f=n.getParameter(3379),p=n.getParameter(34076),m=n.getParameter(34921),g=n.getParameter(36347),y=n.getParameter(36348),v=n.getParameter(36349),_=h>0,b=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const C=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:p,maxAttributes:m,maxVertexUniforms:g,maxVaryings:y,maxFragmentUniforms:v,vertexTextures:_,floatFragmentTextures:b,floatVertexTextures:_&&b,maxSamples:o?n.getParameter(36183):0}}function z9(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new ao,a=new ci,l={value:null,needsUpdate:!1};function u(d,h,f,p){const m=null!==d?d.length:0;let g=null;if(0!==m){if(g=l.value,!0!==p||null===g){const y=f+4*m,v=h.matrixWorldInverse;a.getNormalMatrix(v),(null===g||g.length<y)&&(g=new Float32Array(y));for(let _=0,b=f;_!==m;++_,b+=4)o.copy(d[_]).applyMatrix4(v,a),o.normal.toArray(g,b),g[b+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=m,e.numIntersection=0,g}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){const f=0!==d.length||h||0!==i||r;return r=h,i=d.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,h){t=u(d,h,0)},this.setState=function(d,h,f){const p=d.clippingPlanes,m=d.clipIntersection,g=d.clipShadows,y=n.get(d);if(!r||null===p||0===p.length||s&&!g)s?u(null):function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const v=s?0:i,_=4*v;let b=y.clippingState||null;l.value=b,b=u(p,h,_,f);for(let w=0;w!==_;++w)b[w]=t[w];y.clippingState=b,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=v}}}function H9(n){let e=new WeakMap;function t(o,a){return a===ju?o.mapping=qs:a===Wu&&(o.mapping=Xs),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(a===ju||a===Wu){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new YI(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class nc extends Bp{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const ZI=[.125,.215,.35,.446,.526,.582],Jb=new nc,JI=new me;let Qb=null;const da=(1+Math.sqrt(5))/2,rc=1/da,QI=[new D(1,1,1),new D(-1,1,1),new D(1,1,-1),new D(-1,1,-1),new D(0,da,rc),new D(0,da,-rc),new D(rc,0,da),new D(-rc,0,da),new D(da,rc,0),new D(-da,rc,0)];class e0{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){Qb=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=nR(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=tR(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Qb),e.scissorTest=!1,Hp(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===qs||e.mapping===Xs?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),Qb=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Jt,minFilter:Jt,generateMipmaps:!1,type:kl,format:Pi,encoding:gs,depthBuffer:!1},r=eR(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=eR(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function G9(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+ZI.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-4?l=ZI[o-n+4-1]:0===o&&(l=0),i.push(l);const c=1/(a-2),u=-c,d=1+c,h=[u,u,d,u,d,d,u,u,d,d,u,d],f=6,p=6,m=3,g=2,y=1,v=new Float32Array(m*p*f),_=new Float32Array(g*p*f),b=new Float32Array(y*p*f);for(let M=0;M<f;M++){const C=M%3*2/3-1,x=M>2?0:-1;v.set([C,x,0,C+2/3,x,0,C+2/3,x+1,0,C,x,0,C+2/3,x+1,0,C,x+1,0],m*p*M),_.set(h,g*p*M),b.set([M,M,M,M,M,M],y*p*M)}const w=new et;w.setAttribute("position",new Dt(v,m)),w.setAttribute("uv",new Dt(_,g)),w.setAttribute("faceIndex",new Dt(b,y)),e.push(w),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function j9(n,e,t){const i=new Float32Array(20),r=new D(0,1,0);return new qr({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:ps,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new On(this._lodPlanes[0],e);this._renderer.compile(t,Jb)}_sceneToCubeUV(e,t,i,r){const a=new An(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,h=u.toneMapping;u.getClearColor(JI),u.toneMapping=vr,u.autoClear=!1;const f=new Li({name:"PMREM.Background",side:xi,depthWrite:!1,depthTest:!1}),p=new On(new oo,f);let m=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,m=!0):(f.color.copy(JI),m=!0);for(let y=0;y<6;y++){const v=y%3;0===v?(a.up.set(0,l[y],0),a.lookAt(c[y],0,0)):1===v?(a.up.set(0,0,l[y]),a.lookAt(0,c[y],0)):(a.up.set(0,l[y],0),a.lookAt(0,0,c[y]));const _=this._cubeSize;Hp(r,v*_,y>2?_:0,_,_),u.setRenderTarget(r),m&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=h,u.autoClear=d,e.background=g}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===qs||e.mapping===Xs;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=nR()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=tR());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new On(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;Hp(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,Jb)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,QI[(r-1)%QI.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const d=new On(this._lodPlanes[r],c),h=c.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,m=s/p,g=isFinite(s)?1+Math.floor(3*m):20;g>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const y=[];let v=0;for(let C=0;C<20;++C){const x=C/m,S=Math.exp(-x*x/2);y.push(S),0===C?v+=S:C<g&&(v+=2*S)}for(let C=0;C<y.length;C++)y[C]=y[C]/v;h.envMap.value=e.texture,h.samples.value=g,h.weights.value=y,h.latitudinal.value="latitudinal"===o,a&&(h.poleAxis.value=a);const{_lodMax:_}=this;h.dTheta.value=p,h.mipInt.value=_-i;const b=this._sizeLods[r];Hp(t,3*b*(r>_-4?r-_+4:0),4*(this._cubeSize-b),3*b,2*b),l.setRenderTarget(t),l.render(d,Jb)}}function eR(n,e,t){const i=new wr(n,e,t);return i.texture.mapping=Ol,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Hp(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function tR(){return new qr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:ps,depthTest:!1,depthWrite:!1})}function nR(){return new qr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:ps,depthTest:!1,depthWrite:!1})}function W9(n){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping,c=l===ju||l===Wu,u=l===qs||l===Xs;if(c||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let d=e.get(a);return null===t&&(t=new e0(n)),d=c?t.fromEquirectangular(a,d):t.fromCubemap(a,d),e.set(a,d),d.texture}if(e.has(a))return e.get(a).texture;{const d=a.image;if(c&&d&&d.height>0||u&&d&&function r(a){let l=0;for(let u=0;u<6;u++)void 0!==a[u]&&l++;return 6===l}(d)){null===t&&(t=new e0(n));const h=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function $9(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function q9(n,e,t,i){const r={},s=new WeakMap;function o(d){const h=d.target;null!==h.index&&e.remove(h.index);for(const p in h.attributes)e.remove(h.attributes[p]);h.removeEventListener("dispose",o),delete r[h.id];const f=s.get(h);f&&(e.remove(f),s.delete(h)),i.releaseStatesOfGeometry(h),!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount,t.memory.geometries--}function c(d){const h=[],f=d.index,p=d.attributes.position;let m=0;if(null!==f){const v=f.array;m=f.version;for(let _=0,b=v.length;_<b;_+=3){const w=v[_+0],M=v[_+1],C=v[_+2];h.push(w,M,M,C,C,w)}}else{m=p.version;for(let _=0,b=p.array.length/3-1;_<b;_+=3){const w=_+0,M=_+1,C=_+2;h.push(w,M,M,C,C,w)}}const g=new(FI(h)?$b:Wb)(h,1);g.version=m;const y=s.get(d);y&&e.remove(y),s.set(d,g)}return{get:function a(d,h){return!0===r[h.id]||(h.addEventListener("dispose",o),r[h.id]=!0,t.memory.geometries++),h},update:function l(d){const h=d.attributes;for(const p in h)e.update(h[p],34962);const f=d.morphAttributes;for(const p in f){const m=f[p];for(let g=0,y=m.length;g<y;g++)e.update(m[g],34962)}},getWireframeAttribute:function u(d){const h=s.get(d);if(h){const f=d.index;null!==f&&h.version<f.version&&c(d)}else c(d);return s.get(d)}}}function X9(n,e,t,i){const r=i.isWebGL2;let s,a,l;this.setMode=function o(h){s=h},this.setIndex=function c(h){a=h.type,l=h.bytesPerElement},this.render=function u(h,f){n.drawElements(s,f,a,h*l),t.update(f,s,1)},this.renderInstances=function d(h,f,p){if(0===p)return;let m,g;if(r)m=n,g="drawElementsInstanced";else if(m=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",null===m)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");m[g](s,f,a,h*l,p),t.update(f,s,p)}}function Y9(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function K9(n,e){return n[0]-e[0]}function Z9(n,e){return Math.abs(e[1])-Math.abs(n[1])}function J9(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new Rt,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,u,d,h){const f=c.morphTargetInfluences;if(!0===e.isWebGL2){const p=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,m=void 0!==p?p.length:0;let g=s.get(u);if(void 0===g||g.count!==m){let j=function(){P.dispose(),s.delete(u),u.removeEventListener("dispose",j)};void 0!==g&&g.texture.dispose();const _=void 0!==u.morphAttributes.position,b=void 0!==u.morphAttributes.normal,w=void 0!==u.morphAttributes.color,M=u.morphAttributes.position||[],C=u.morphAttributes.normal||[],x=u.morphAttributes.color||[];let S=0;!0===_&&(S=1),!0===b&&(S=2),!0===w&&(S=3);let I=u.attributes.position.count*S,L=1;I>e.maxTextureSize&&(L=Math.ceil(I/e.maxTextureSize),I=e.maxTextureSize);const k=new Float32Array(I*L*4*m),P=new Sp(k,I,L,m);P.type=ms,P.needsUpdate=!0;const R=4*S;for(let O=0;O<m;O++){const G=M[O],N=C[O],$=x[O],Y=I*L*4*O;for(let pe=0;pe<G.count;pe++){const B=pe*R;!0===_&&(o.fromBufferAttribute(G,pe),k[Y+B+0]=o.x,k[Y+B+1]=o.y,k[Y+B+2]=o.z,k[Y+B+3]=0),!0===b&&(o.fromBufferAttribute(N,pe),k[Y+B+4]=o.x,k[Y+B+5]=o.y,k[Y+B+6]=o.z,k[Y+B+7]=0),!0===w&&(o.fromBufferAttribute($,pe),k[Y+B+8]=o.x,k[Y+B+9]=o.y,k[Y+B+10]=o.z,k[Y+B+11]=4===$.itemSize?o.w:1)}}g={count:m,texture:P,size:new ee(I,L)},s.set(u,g),u.addEventListener("dispose",j)}let y=0;for(let _=0;_<f.length;_++)y+=f[_];const v=u.morphTargetsRelative?1:1-y;h.getUniforms().setValue(n,"morphTargetBaseInfluence",v),h.getUniforms().setValue(n,"morphTargetInfluences",f),h.getUniforms().setValue(n,"morphTargetsTexture",g.texture,t),h.getUniforms().setValue(n,"morphTargetsTextureSize",g.size)}else{const p=void 0===f?0:f.length;let m=i[u.id];if(void 0===m||m.length!==p){m=[];for(let b=0;b<p;b++)m[b]=[b,0];i[u.id]=m}for(let b=0;b<p;b++){const w=m[b];w[0]=b,w[1]=f[b]}m.sort(Z9);for(let b=0;b<8;b++)b<p&&m[b][1]?(a[b][0]=m[b][0],a[b][1]=m[b][1]):(a[b][0]=Number.MAX_SAFE_INTEGER,a[b][1]=0);a.sort(K9);const g=u.morphAttributes.position,y=u.morphAttributes.normal;let v=0;for(let b=0;b<8;b++){const w=a[b],M=w[0],C=w[1];M!==Number.MAX_SAFE_INTEGER&&C?(g&&u.getAttribute("morphTarget"+b)!==g[M]&&u.setAttribute("morphTarget"+b,g[M]),y&&u.getAttribute("morphNormal"+b)!==y[M]&&u.setAttribute("morphNormal"+b,y[M]),r[b]=C,v+=C):(g&&!0===u.hasAttribute("morphTarget"+b)&&u.deleteAttribute("morphTarget"+b),y&&!0===u.hasAttribute("morphNormal"+b)&&u.deleteAttribute("morphNormal"+b),r[b]=0)}const _=u.morphTargetsRelative?1:1-v;h.getUniforms().setValue(n,"morphTargetBaseInfluence",_),h.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function Q9(n,e,t,i){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=i.render.frame,d=e.get(l,l.geometry);return r.get(d)!==c&&(e.update(d),r.set(d,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),null!==l.instanceColor&&t.update(l.instanceColor,34962)),d},dispose:function o(){r=new WeakMap}}}const iR=new Hn,rR=new Sp,sR=new Fb,oR=new od,aR=[],lR=[],cR=new Float32Array(16),uR=new Float32Array(9),dR=new Float32Array(4);function sc(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=aR[r];if(void 0===s&&(s=new Float32Array(r),aR[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Tn(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function In(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function Gp(n,e){let t=lR[e];void 0===t&&(t=new Int32Array(e),lR[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function eq(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function tq(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Tn(t,e))return;n.uniform2fv(this.addr,e),In(t,e)}}function nq(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Tn(t,e))return;n.uniform3fv(this.addr,e),In(t,e)}}function iq(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Tn(t,e))return;n.uniform4fv(this.addr,e),In(t,e)}}function rq(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Tn(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),In(t,e)}else{if(Tn(t,i))return;dR.set(i),n.uniformMatrix2fv(this.addr,!1,dR),In(t,i)}}function sq(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Tn(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),In(t,e)}else{if(Tn(t,i))return;uR.set(i),n.uniformMatrix3fv(this.addr,!1,uR),In(t,i)}}function oq(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Tn(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),In(t,e)}else{if(Tn(t,i))return;cR.set(i),n.uniformMatrix4fv(this.addr,!1,cR),In(t,i)}}function aq(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function lq(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Tn(t,e))return;n.uniform2iv(this.addr,e),In(t,e)}}function cq(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Tn(t,e))return;n.uniform3iv(this.addr,e),In(t,e)}}function uq(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Tn(t,e))return;n.uniform4iv(this.addr,e),In(t,e)}}function dq(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function hq(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Tn(t,e))return;n.uniform2uiv(this.addr,e),In(t,e)}}function fq(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Tn(t,e))return;n.uniform3uiv(this.addr,e),In(t,e)}}function pq(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Tn(t,e))return;n.uniform4uiv(this.addr,e),In(t,e)}}function mq(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||iR,r)}function gq(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||sR,r)}function _q(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||oR,r)}function yq(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||rR,r)}function bq(n,e){n.uniform1fv(this.addr,e)}function xq(n,e){const t=sc(e,this.size,2);n.uniform2fv(this.addr,t)}function wq(n,e){const t=sc(e,this.size,3);n.uniform3fv(this.addr,t)}function Mq(n,e){const t=sc(e,this.size,4);n.uniform4fv(this.addr,t)}function Sq(n,e){const t=sc(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function Eq(n,e){const t=sc(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function Cq(n,e){const t=sc(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function Dq(n,e){n.uniform1iv(this.addr,e)}function Aq(n,e){n.uniform2iv(this.addr,e)}function Tq(n,e){n.uniform3iv(this.addr,e)}function Iq(n,e){n.uniform4iv(this.addr,e)}function Rq(n,e){n.uniform1uiv(this.addr,e)}function Pq(n,e){n.uniform2uiv(this.addr,e)}function Fq(n,e){n.uniform3uiv(this.addr,e)}function Oq(n,e){n.uniform4uiv(this.addr,e)}function Lq(n,e,t){const i=this.cache,r=e.length,s=Gp(t,r);Tn(i,s)||(n.uniform1iv(this.addr,s),In(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||iR,s[o])}function Nq(n,e,t){const i=this.cache,r=e.length,s=Gp(t,r);Tn(i,s)||(n.uniform1iv(this.addr,s),In(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||sR,s[o])}function kq(n,e,t){const i=this.cache,r=e.length,s=Gp(t,r);Tn(i,s)||(n.uniform1iv(this.addr,s),In(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||oR,s[o])}function Bq(n,e,t){const i=this.cache,r=e.length,s=Gp(t,r);Tn(i,s)||(n.uniform1iv(this.addr,s),In(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||rR,s[o])}class Uq{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function vq(n){switch(n){case 5126:return eq;case 35664:return tq;case 35665:return nq;case 35666:return iq;case 35674:return rq;case 35675:return sq;case 35676:return oq;case 5124:case 35670:return aq;case 35667:case 35671:return lq;case 35668:case 35672:return cq;case 35669:case 35673:return uq;case 5125:return dq;case 36294:return hq;case 36295:return fq;case 36296:return pq;case 35678:case 36198:case 36298:case 36306:case 35682:return mq;case 35679:case 36299:case 36307:return gq;case 35680:case 36300:case 36308:case 36293:return _q;case 36289:case 36303:case 36311:case 36292:return yq}}(t.type)}}class zq{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function Vq(n){switch(n){case 5126:return bq;case 35664:return xq;case 35665:return wq;case 35666:return Mq;case 35674:return Sq;case 35675:return Eq;case 35676:return Cq;case 5124:case 35670:return Dq;case 35667:case 35671:return Aq;case 35668:case 35672:return Tq;case 35669:case 35673:return Iq;case 5125:return Rq;case 36294:return Pq;case 36295:return Fq;case 36296:return Oq;case 35678:case 36198:case 36298:case 36306:case 35682:return Lq;case 35679:case 36299:case 36307:return Nq;case 35680:case 36300:case 36308:case 36293:return kq;case 36289:case 36303:case 36311:case 36292:return Bq}}(t.type)}}class Hq{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const n0=/(\w+)(\])?(\[|\.)?/g;function hR(n,e){n.seq.push(e),n.map[e.id]=e}function Gq(n,e,t){const i=n.name,r=i.length;for(n0.lastIndex=0;;){const s=n0.exec(i);let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&n0.lastIndex+2===r){hR(t,void 0===c?new Uq(a,n,e):new zq(a,n,e));break}{let d=t.map[a];void 0===d&&(d=new Hq(a),hR(t,d)),t=d}}}class jp{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,35718);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);Gq(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function fR(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let jq=0;function pR(n,e,t){const i=n.getShaderParameter(e,35713),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function Wq(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function qq(n,e){const t=function $q(n){switch(n){case gs:return["Linear","( value )"];case mt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function Xq(n,e){let t;switch(e){case rI:t="Linear";break;case sI:t="Reinhard";break;case oI:t="OptimizedCineon";break;case Zv:t="ACESFilmic";break;case aI:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function ad(n){return""!==n}function mR(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function gR(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Jq=/^[ \t]*#include +<([\w\d./]+)>/gm;function r0(n){return n.replace(Jq,Qq)}function Qq(n,e){const t=tt[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return r0(t)}const e7=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function _R(n){return n.replace(e7,t7)}function t7(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function yR(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function a7(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function n7(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===Hv?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===Gv?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Fl&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function i7(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case qs:case Xs:e="ENVMAP_TYPE_CUBE";break;case Ol:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function r7(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===Xs&&(e="ENVMAP_MODE_REFRACTION"),e}(t),d=function s7(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Gu:e="ENVMAP_BLENDING_MULTIPLY";break;case nI:e="ENVMAP_BLENDING_MIX";break;case iI:e="ENVMAP_BLENDING_ADD"}return e}(t),h=function o7(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),f=t.isWebGL2?"":function Yq(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ad).join("\n")}(t),p=function Kq(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),m=r.createProgram();let g,y,v=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(g=[p].filter(ad).join("\n"),g.length>0&&(g+="\n"),y=[f,p].filter(ad).join("\n"),y.length>0&&(y+="\n")):(g=[yR(t),"#define SHADER_NAME "+t.shaderName,p,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ad).join("\n"),y=[f,yR(t),"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==vr?"#define TONE_MAPPING":"",t.toneMapping!==vr?tt.tonemapping_pars_fragment:"",t.toneMapping!==vr?Xq("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",tt.encodings_pars_fragment,qq("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(ad).join("\n")),o=r0(o),o=mR(o,t),o=gR(o,t),a=r0(a),a=mR(a,t),a=gR(a,t),o=_R(o),a=_R(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(v="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,y=["#define varying in",t.glslVersion===Sb?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Sb?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const b=v+y+a,w=fR(r,35633,v+g+o),M=fR(r,35632,b);if(r.attachShader(m,w),r.attachShader(m,M),void 0!==t.index0AttributeName?r.bindAttribLocation(m,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),n.debug.checkShaderErrors){const S=r.getProgramInfoLog(m).trim(),I=r.getShaderInfoLog(w).trim(),L=r.getShaderInfoLog(M).trim();let k=!0,P=!0;if(!1===r.getProgramParameter(m,35714)){k=!1;const R=pR(r,w,"vertex"),j=pR(r,M,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,35715)+"\n\nProgram Info Log: "+S+"\n"+R+"\n"+j)}else""!==S?console.warn("THREE.WebGLProgram: Program Info Log:",S):(""===I||""===L)&&(P=!1);P&&(this.diagnostics={runnable:k,programLog:S,vertexShader:{log:I,prefix:g},fragmentShader:{log:L,prefix:y}})}let C,x;return r.deleteShader(w),r.deleteShader(M),this.getUniforms=function(){return void 0===C&&(C=new jp(r,m)),C},this.getAttributes=function(){return void 0===x&&(x=function Zq(n,e){const t={},i=n.getProgramParameter(e,35721);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;35674===s.type&&(a=2),35675===s.type&&(a=3),35676===s.type&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,m)),x},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.name=t.shaderName,this.id=jq++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=w,this.fragmentShader=M,this}let l7=0;class c7{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new u7(e),t.set(e,i)),i}}class u7{constructor(e){this.id=l7++,this.code=e,this.usedTimes=0}}function d7(n,e,t,i,r,s,o){const a=new ca,l=new c7,c=[],u=r.isWebGL2,d=r.logarithmicDepthBuffer,h=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function m(x,S,I,L,k){const P=L.fog,R=k.geometry,O=(x.isMeshStandardMaterial?t:e).get(x.envMap||(x.isMeshStandardMaterial?L.environment:null)),G=O&&O.mapping===Ol?O.image.height:null,N=p[x.type];null!==x.precision&&(f=r.getMaxPrecision(x.precision),f!==x.precision&&console.warn("THREE.WebGLProgram.getParameters:",x.precision,"not supported, using",f,"instead."));const $=R.morphAttributes.position||R.morphAttributes.normal||R.morphAttributes.color,Y=void 0!==$?$.length:0;let B,te,ne,ce,pe=0;if(void 0!==R.morphAttributes.position&&(pe=1),void 0!==R.morphAttributes.normal&&(pe=2),void 0!==R.morphAttributes.color&&(pe=3),N){const qe=Er[N];B=qe.vertexShader,te=qe.fragmentShader}else B=x.vertexShader,te=x.fragmentShader,l.update(x),ne=l.getVertexShaderID(x),ce=l.getFragmentShaderID(x);const z=n.getRenderTarget(),_e=x.clearcoat>0,be=x.iridescence>0;return{isWebGL2:u,shaderID:N,shaderName:x.type,vertexShader:B,fragmentShader:te,defines:x.defines,customVertexShaderID:ne,customFragmentShaderID:ce,isRawShaderMaterial:!0===x.isRawShaderMaterial,glslVersion:x.glslVersion,precision:f,instancing:!0===k.isInstancedMesh,instancingColor:!0===k.isInstancedMesh&&null!==k.instanceColor,supportsVertexTextures:h,outputEncoding:null===z?n.outputEncoding:!0===z.isXRRenderTarget?z.texture.encoding:gs,map:!!x.map,matcap:!!x.matcap,envMap:!!O,envMapMode:O&&O.mapping,envMapCubeUVHeight:G,lightMap:!!x.lightMap,aoMap:!!x.aoMap,emissiveMap:!!x.emissiveMap,bumpMap:!!x.bumpMap,normalMap:!!x.normalMap,objectSpaceNormalMap:x.normalMapType===TI,tangentSpaceNormalMap:x.normalMapType===Qs,decodeVideoTexture:!!x.map&&!0===x.map.isVideoTexture&&x.map.encoding===mt,clearcoat:_e,clearcoatMap:_e&&!!x.clearcoatMap,clearcoatRoughnessMap:_e&&!!x.clearcoatRoughnessMap,clearcoatNormalMap:_e&&!!x.clearcoatNormalMap,iridescence:be,iridescenceMap:be&&!!x.iridescenceMap,iridescenceThicknessMap:be&&!!x.iridescenceThicknessMap,displacementMap:!!x.displacementMap,roughnessMap:!!x.roughnessMap,metalnessMap:!!x.metalnessMap,specularMap:!!x.specularMap,specularIntensityMap:!!x.specularIntensityMap,specularColorMap:!!x.specularColorMap,opaque:!1===x.transparent&&x.blending===Ko,alphaMap:!!x.alphaMap,alphaTest:x.alphaTest>0,gradientMap:!!x.gradientMap,sheen:x.sheen>0,sheenColorMap:!!x.sheenColorMap,sheenRoughnessMap:!!x.sheenRoughnessMap,transmission:x.transmission>0,transmissionMap:!!x.transmissionMap,thicknessMap:!!x.thicknessMap,combine:x.combine,vertexTangents:!!x.normalMap&&!!R.attributes.tangent,vertexColors:x.vertexColors,vertexAlphas:!0===x.vertexColors&&!!R.attributes.color&&4===R.attributes.color.itemSize,vertexUvs:!!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatMap||x.clearcoatRoughnessMap||x.clearcoatNormalMap||x.iridescenceMap||x.iridescenceThicknessMap||x.displacementMap||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheenColorMap||x.sheenRoughnessMap),uvsVertexOnly:!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatNormalMap||x.iridescenceMap||x.iridescenceThicknessMap||x.transmission>0||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheen>0||x.sheenColorMap||x.sheenRoughnessMap||!x.displacementMap),fog:!!P,useFog:!0===x.fog,fogExp2:P&&P.isFogExp2,flatShading:!!x.flatShading,sizeAttenuation:x.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===k.isSkinnedMesh,morphTargets:void 0!==R.morphAttributes.position,morphNormals:void 0!==R.morphAttributes.normal,morphColors:void 0!==R.morphAttributes.color,morphTargetsCount:Y,morphTextureStride:pe,numDirLights:S.directional.length,numPointLights:S.point.length,numSpotLights:S.spot.length,numSpotLightMaps:S.spotLightMap.length,numRectAreaLights:S.rectArea.length,numHemiLights:S.hemi.length,numDirLightShadows:S.directionalShadowMap.length,numPointLightShadows:S.pointShadowMap.length,numSpotLightShadows:S.spotShadowMap.length,numSpotLightShadowsWithMaps:S.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:x.dithering,shadowMapEnabled:n.shadowMap.enabled&&I.length>0,shadowMapType:n.shadowMap.type,toneMapping:x.toneMapped?n.toneMapping:vr,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:x.premultipliedAlpha,doubleSided:x.side===Wr,flipSided:x.side===xi,useDepthPacking:!!x.depthPacking,depthPacking:x.depthPacking||0,index0AttributeName:x.index0AttributeName,extensionDerivatives:x.extensions&&x.extensions.derivatives,extensionFragDepth:x.extensions&&x.extensions.fragDepth,extensionDrawBuffers:x.extensions&&x.extensions.drawBuffers,extensionShaderTextureLOD:x.extensions&&x.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:x.customProgramCacheKey()}},getProgramCacheKey:function g(x){const S=[];if(x.shaderID?S.push(x.shaderID):(S.push(x.customVertexShaderID),S.push(x.customFragmentShaderID)),void 0!==x.defines)for(const I in x.defines)S.push(I),S.push(x.defines[I]);return!1===x.isRawShaderMaterial&&(function y(x,S){x.push(S.precision),x.push(S.outputEncoding),x.push(S.envMapMode),x.push(S.envMapCubeUVHeight),x.push(S.combine),x.push(S.vertexUvs),x.push(S.fogExp2),x.push(S.sizeAttenuation),x.push(S.morphTargetsCount),x.push(S.morphAttributeCount),x.push(S.numDirLights),x.push(S.numPointLights),x.push(S.numSpotLights),x.push(S.numSpotLightMaps),x.push(S.numHemiLights),x.push(S.numRectAreaLights),x.push(S.numDirLightShadows),x.push(S.numPointLightShadows),x.push(S.numSpotLightShadows),x.push(S.numSpotLightShadowsWithMaps),x.push(S.shadowMapType),x.push(S.toneMapping),x.push(S.numClippingPlanes),x.push(S.numClipIntersection),x.push(S.depthPacking)}(S,x),function v(x,S){a.disableAll(),S.isWebGL2&&a.enable(0),S.supportsVertexTextures&&a.enable(1),S.instancing&&a.enable(2),S.instancingColor&&a.enable(3),S.map&&a.enable(4),S.matcap&&a.enable(5),S.envMap&&a.enable(6),S.lightMap&&a.enable(7),S.aoMap&&a.enable(8),S.emissiveMap&&a.enable(9),S.bumpMap&&a.enable(10),S.normalMap&&a.enable(11),S.objectSpaceNormalMap&&a.enable(12),S.tangentSpaceNormalMap&&a.enable(13),S.clearcoat&&a.enable(14),S.clearcoatMap&&a.enable(15),S.clearcoatRoughnessMap&&a.enable(16),S.clearcoatNormalMap&&a.enable(17),S.iridescence&&a.enable(18),S.iridescenceMap&&a.enable(19),S.iridescenceThicknessMap&&a.enable(20),S.displacementMap&&a.enable(21),S.specularMap&&a.enable(22),S.roughnessMap&&a.enable(23),S.metalnessMap&&a.enable(24),S.gradientMap&&a.enable(25),S.alphaMap&&a.enable(26),S.alphaTest&&a.enable(27),S.vertexColors&&a.enable(28),S.vertexAlphas&&a.enable(29),S.vertexUvs&&a.enable(30),S.vertexTangents&&a.enable(31),S.uvsVertexOnly&&a.enable(32),x.push(a.mask),a.disableAll(),S.fog&&a.enable(0),S.useFog&&a.enable(1),S.flatShading&&a.enable(2),S.logarithmicDepthBuffer&&a.enable(3),S.skinning&&a.enable(4),S.morphTargets&&a.enable(5),S.morphNormals&&a.enable(6),S.morphColors&&a.enable(7),S.premultipliedAlpha&&a.enable(8),S.shadowMapEnabled&&a.enable(9),S.physicallyCorrectLights&&a.enable(10),S.doubleSided&&a.enable(11),S.flipSided&&a.enable(12),S.useDepthPacking&&a.enable(13),S.dithering&&a.enable(14),S.specularIntensityMap&&a.enable(15),S.specularColorMap&&a.enable(16),S.transmission&&a.enable(17),S.transmissionMap&&a.enable(18),S.thicknessMap&&a.enable(19),S.sheen&&a.enable(20),S.sheenColorMap&&a.enable(21),S.sheenRoughnessMap&&a.enable(22),S.decodeVideoTexture&&a.enable(23),S.opaque&&a.enable(24),x.push(a.mask)}(S,x),S.push(n.outputEncoding)),S.push(x.customProgramCacheKey),S.join()},getUniforms:function _(x){const S=p[x.type];let I;return I=S?qI.clone(Er[S].uniforms):x.uniforms,I},acquireProgram:function b(x,S){let I;for(let L=0,k=c.length;L<k;L++){const P=c[L];if(P.cacheKey===S){I=P,++I.usedTimes;break}}return void 0===I&&(I=new a7(n,S,x,s),c.push(I)),I},releaseProgram:function w(x){if(0==--x.usedTimes){const S=c.indexOf(x);c[S]=c[c.length-1],c.pop(),x.destroy()}},releaseShaderCache:function M(x){l.remove(x)},programs:c,dispose:function C(){l.dispose()}}}function h7(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function f7(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function vR(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function bR(){const n=[];let e=0;const t=[],i=[],r=[];function o(d,h,f,p,m,g){let y=n[e];return void 0===y?(y={id:d.id,object:d,geometry:h,material:f,groupOrder:p,renderOrder:d.renderOrder,z:m,group:g},n[e]=y):(y.id=d.id,y.object=d,y.geometry=h,y.material=f,y.groupOrder=p,y.renderOrder=d.renderOrder,y.z=m,y.group=g),e++,y}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(d,h,f,p,m,g){const y=o(d,h,f,p,m,g);f.transmission>0?i.push(y):!0===f.transparent?r.push(y):t.push(y)},unshift:function l(d,h,f,p,m,g){const y=o(d,h,f,p,m,g);f.transmission>0?i.unshift(y):!0===f.transparent?r.unshift(y):t.unshift(y)},finish:function u(){for(let d=e,h=n.length;d<h;d++){const f=n[d];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function c(d,h){t.length>1&&t.sort(d||f7),i.length>1&&i.sort(h||vR),r.length>1&&r.sort(h||vR)}}}function p7(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new bR,n.set(i,[o])):r>=s.length?(o=new bR,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function m7(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new D,color:new me};break;case"SpotLight":t={position:new D,direction:new D,color:new me,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new D,color:new me,distance:0,decay:0};break;case"HemisphereLight":t={direction:new D,skyColor:new me,groundColor:new me};break;case"RectAreaLight":t={color:new me,position:new D,halfWidth:new D,halfHeight:new D}}return n[e.id]=t,t}}}let _7=0;function y7(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function v7(n,e){const t=new m7,i=function g7(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ee};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ee,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)r.probe.push(new D);const s=new D,o=new He,a=new He;return{setup:function l(u,d){let h=0,f=0,p=0;for(let L=0;L<9;L++)r.probe[L].set(0,0,0);let m=0,g=0,y=0,v=0,_=0,b=0,w=0,M=0,C=0,x=0;u.sort(y7);const S=!0!==d?Math.PI:1;for(let L=0,k=u.length;L<k;L++){const P=u[L],R=P.color,j=P.intensity,O=P.distance,G=P.shadow&&P.shadow.map?P.shadow.map.texture:null;if(P.isAmbientLight)h+=R.r*j*S,f+=R.g*j*S,p+=R.b*j*S;else if(P.isLightProbe)for(let N=0;N<9;N++)r.probe[N].addScaledVector(P.sh.coefficients[N],j);else if(P.isDirectionalLight){const N=t.get(P);if(N.color.copy(P.color).multiplyScalar(P.intensity*S),P.castShadow){const $=P.shadow,Y=i.get(P);Y.shadowBias=$.bias,Y.shadowNormalBias=$.normalBias,Y.shadowRadius=$.radius,Y.shadowMapSize=$.mapSize,r.directionalShadow[m]=Y,r.directionalShadowMap[m]=G,r.directionalShadowMatrix[m]=P.shadow.matrix,b++}r.directional[m]=N,m++}else if(P.isSpotLight){const N=t.get(P);N.position.setFromMatrixPosition(P.matrixWorld),N.color.copy(R).multiplyScalar(j*S),N.distance=O,N.coneCos=Math.cos(P.angle),N.penumbraCos=Math.cos(P.angle*(1-P.penumbra)),N.decay=P.decay,r.spot[y]=N;const $=P.shadow;if(P.map&&(r.spotLightMap[C]=P.map,C++,$.updateMatrices(P),P.castShadow&&x++),r.spotLightMatrix[y]=$.matrix,P.castShadow){const Y=i.get(P);Y.shadowBias=$.bias,Y.shadowNormalBias=$.normalBias,Y.shadowRadius=$.radius,Y.shadowMapSize=$.mapSize,r.spotShadow[y]=Y,r.spotShadowMap[y]=G,M++}y++}else if(P.isRectAreaLight){const N=t.get(P);N.color.copy(R).multiplyScalar(j),N.halfWidth.set(.5*P.width,0,0),N.halfHeight.set(0,.5*P.height,0),r.rectArea[v]=N,v++}else if(P.isPointLight){const N=t.get(P);if(N.color.copy(P.color).multiplyScalar(P.intensity*S),N.distance=P.distance,N.decay=P.decay,P.castShadow){const $=P.shadow,Y=i.get(P);Y.shadowBias=$.bias,Y.shadowNormalBias=$.normalBias,Y.shadowRadius=$.radius,Y.shadowMapSize=$.mapSize,Y.shadowCameraNear=$.camera.near,Y.shadowCameraFar=$.camera.far,r.pointShadow[g]=Y,r.pointShadowMap[g]=G,r.pointShadowMatrix[g]=P.shadow.matrix,w++}r.point[g]=N,g++}else if(P.isHemisphereLight){const N=t.get(P);N.skyColor.copy(P.color).multiplyScalar(j*S),N.groundColor.copy(P.groundColor).multiplyScalar(j*S),r.hemi[_]=N,_++}}v>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=fe.LTC_FLOAT_1,r.rectAreaLTC2=fe.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=fe.LTC_HALF_1,r.rectAreaLTC2=fe.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=f,r.ambient[2]=p;const I=r.hash;(I.directionalLength!==m||I.pointLength!==g||I.spotLength!==y||I.rectAreaLength!==v||I.hemiLength!==_||I.numDirectionalShadows!==b||I.numPointShadows!==w||I.numSpotShadows!==M||I.numSpotMaps!==C)&&(r.directional.length=m,r.spot.length=y,r.rectArea.length=v,r.point.length=g,r.hemi.length=_,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=w,r.pointShadowMap.length=w,r.spotShadow.length=M,r.spotShadowMap.length=M,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=w,r.spotLightMatrix.length=M+C-x,r.spotLightMap.length=C,r.numSpotLightShadowsWithMaps=x,I.directionalLength=m,I.pointLength=g,I.spotLength=y,I.rectAreaLength=v,I.hemiLength=_,I.numDirectionalShadows=b,I.numPointShadows=w,I.numSpotShadows=M,I.numSpotMaps=C,r.version=_7++)},setupView:function c(u,d){let h=0,f=0,p=0,m=0,g=0;const y=d.matrixWorldInverse;for(let v=0,_=u.length;v<_;v++){const b=u[v];if(b.isDirectionalLight){const w=r.directional[h];w.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(y),h++}else if(b.isSpotLight){const w=r.spot[p];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(y),w.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(y),p++}else if(b.isRectAreaLight){const w=r.rectArea[m];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(y),a.identity(),o.copy(b.matrixWorld),o.premultiply(y),a.extractRotation(o),w.halfWidth.set(.5*b.width,0,0),w.halfHeight.set(0,.5*b.height,0),w.halfWidth.applyMatrix4(a),w.halfHeight.applyMatrix4(a),m++}else if(b.isPointLight){const w=r.point[f];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(y),f++}else if(b.isHemisphereLight){const w=r.hemi[g];w.direction.setFromMatrixPosition(b.matrixWorld),w.direction.transformDirection(y),g++}}},state:r}}function xR(n,e){const t=new v7(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function l(d){t.setup(i,d)},setupLightsView:function c(d){t.setupView(i,d)},pushLight:function o(d){i.push(d)},pushShadow:function a(d){r.push(d)}}}function b7(n,e){let t=new WeakMap;return{get:function i(s,o=0){const a=t.get(s);let l;return void 0===a?(l=new xR(n,e),t.set(s,[l])):o>=a.length?(l=new xR(n,e),a.push(l)):l=a[o],l},dispose:function r(){t=new WeakMap}}}class s0 extends Dn{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=DI,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class o0 extends Dn{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new D,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const x7="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",w7="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function M7(n,e,t){let i=new Up;const r=new ee,s=new ee,o=new Rt,a=new s0({depthPacking:AI}),l=new o0,c={},u=t.maxTextureSize,d={[jr]:xi,[xi]:jr,[Wr]:Wr},h=new qr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ee},radius:{value:4}},vertexShader:x7,fragmentShader:w7}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const p=new et;p.setAttribute("position",new Dt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new On(p,h),g=this;function y(b,w){const M=e.update(m);h.defines.VSM_SAMPLES!==b.blurSamples&&(h.defines.VSM_SAMPLES=b.blurSamples,f.defines.VSM_SAMPLES=b.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),null===b.mapPass&&(b.mapPass=new wr(r.x,r.y)),h.uniforms.shadow_pass.value=b.map.texture,h.uniforms.resolution.value=b.mapSize,h.uniforms.radius.value=b.radius,n.setRenderTarget(b.mapPass),n.clear(),n.renderBufferDirect(w,null,M,h,m,null),f.uniforms.shadow_pass.value=b.mapPass.texture,f.uniforms.resolution.value=b.mapSize,f.uniforms.radius.value=b.radius,n.setRenderTarget(b.map),n.clear(),n.renderBufferDirect(w,null,M,f,m,null)}function v(b,w,M,C,x,S){let I=null;const L=!0===M.isPointLight?b.customDistanceMaterial:b.customDepthMaterial;if(void 0!==L)I=L;else if(I=!0===M.isPointLight?l:a,n.localClippingEnabled&&!0===w.clipShadows&&Array.isArray(w.clippingPlanes)&&0!==w.clippingPlanes.length||w.displacementMap&&0!==w.displacementScale||w.alphaMap&&w.alphaTest>0||w.map&&w.alphaTest>0){const k=I.uuid,P=w.uuid;let R=c[k];void 0===R&&(R={},c[k]=R);let j=R[P];void 0===j&&(j=I.clone(),R[P]=j),I=j}return I.visible=w.visible,I.wireframe=w.wireframe,I.side=S===Fl?null!==w.shadowSide?w.shadowSide:w.side:null!==w.shadowSide?w.shadowSide:d[w.side],I.alphaMap=w.alphaMap,I.alphaTest=w.alphaTest,I.map=w.map,I.clipShadows=w.clipShadows,I.clippingPlanes=w.clippingPlanes,I.clipIntersection=w.clipIntersection,I.displacementMap=w.displacementMap,I.displacementScale=w.displacementScale,I.displacementBias=w.displacementBias,I.wireframeLinewidth=w.wireframeLinewidth,I.linewidth=w.linewidth,!0===M.isPointLight&&!0===I.isMeshDistanceMaterial&&(I.referencePosition.setFromMatrixPosition(M.matrixWorld),I.nearDistance=C,I.farDistance=x),I}function _(b,w,M,C,x){if(!1===b.visible)return;if(b.layers.test(w.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&x===Fl)&&(!b.frustumCulled||i.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(M.matrixWorldInverse,b.matrixWorld);const L=e.update(b),k=b.material;if(Array.isArray(k)){const P=L.groups;for(let R=0,j=P.length;R<j;R++){const O=P[R],G=k[O.materialIndex];if(G&&G.visible){const N=v(b,G,C,M.near,M.far,x);n.renderBufferDirect(M,null,L,N,b,O)}}}else if(k.visible){const P=v(b,k,C,M.near,M.far,x);n.renderBufferDirect(M,null,L,P,b,null)}}const I=b.children;for(let L=0,k=I.length;L<k;L++)_(I[L],w,M,C,x)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Hv,this.render=function(b,w,M){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===b.length)return;const C=n.getRenderTarget(),x=n.getActiveCubeFace(),S=n.getActiveMipmapLevel(),I=n.state;I.setBlending(ps),I.buffers.color.setClear(1,1,1,1),I.buffers.depth.setTest(!0),I.setScissorTest(!1);for(let L=0,k=b.length;L<k;L++){const P=b[L],R=P.shadow;if(void 0===R){console.warn("THREE.WebGLShadowMap:",P,"has no shadow.");continue}if(!1===R.autoUpdate&&!1===R.needsUpdate)continue;r.copy(R.mapSize);const j=R.getFrameExtents();r.multiply(j),s.copy(R.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/j.x),r.x=s.x*j.x,R.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/j.y),r.y=s.y*j.y,R.mapSize.y=s.y)),null===R.map&&(R.map=new wr(r.x,r.y,this.type!==Fl?{minFilter:sn,magFilter:sn}:{}),R.map.texture.name=P.name+".shadowMap",R.camera.updateProjectionMatrix()),n.setRenderTarget(R.map),n.clear();const O=R.getViewportCount();for(let G=0;G<O;G++){const N=R.getViewport(G);o.set(s.x*N.x,s.y*N.y,s.x*N.z,s.y*N.w),I.viewport(o),R.updateMatrices(P,G),i=R.getFrustum(),_(w,M,R.camera,P,this.type)}!0!==R.isPointLightShadow&&this.type===Fl&&y(R,M),R.needsUpdate=!1}g.needsUpdate=!1,n.setRenderTarget(C,x,S)}}function S7(n,e,t){const i=t.isWebGL2,a=new function r(){let F=!1;const q=new Rt;let oe=null;const Se=new Rt(0,0,0,0);return{setMask:function(Ie){oe!==Ie&&!F&&(n.colorMask(Ie,Ie,Ie,Ie),oe=Ie)},setLocked:function(Ie){F=Ie},setClear:function(Ie,At,Nn,ti,Ra){!0===Ra&&(Ie*=ti,At*=ti,Nn*=ti),q.set(Ie,At,Nn,ti),!1===Se.equals(q)&&(n.clearColor(Ie,At,Nn,ti),Se.copy(q))},reset:function(){F=!1,oe=null,Se.set(-1,0,0,0)}}},l=new function s(){let F=!1,q=null,oe=null,Se=null;return{setTest:function(Ie){Ie?ve(2929):_e(2929)},setMask:function(Ie){q!==Ie&&!F&&(n.depthMask(Ie),q=Ie)},setFunc:function(Ie){if(oe!==Ie){switch(Ie){case Y1:n.depthFunc(512);break;case K1:n.depthFunc(519);break;case Z1:n.depthFunc(513);break;case ap:n.depthFunc(515);break;case J1:n.depthFunc(514);break;case Q1:n.depthFunc(518);break;case eI:n.depthFunc(516);break;case tI:n.depthFunc(517);break;default:n.depthFunc(515)}oe=Ie}},setLocked:function(Ie){F=Ie},setClear:function(Ie){Se!==Ie&&(n.clearDepth(Ie),Se=Ie)},reset:function(){F=!1,q=null,oe=null,Se=null}}},c=new function o(){let F=!1,q=null,oe=null,Se=null,Ie=null,At=null,Nn=null,ti=null,Ra=null;return{setTest:function(Yt){F||(Yt?ve(2960):_e(2960))},setMask:function(Yt){q!==Yt&&!F&&(n.stencilMask(Yt),q=Yt)},setFunc:function(Yt,Rs,or){(oe!==Yt||Se!==Rs||Ie!==or)&&(n.stencilFunc(Yt,Rs,or),oe=Yt,Se=Rs,Ie=or)},setOp:function(Yt,Rs,or){(At!==Yt||Nn!==Rs||ti!==or)&&(n.stencilOp(Yt,Rs,or),At=Yt,Nn=Rs,ti=or)},setLocked:function(Yt){F=Yt},setClear:function(Yt){Ra!==Yt&&(n.clearStencil(Yt),Ra=Yt)},reset:function(){F=!1,q=null,oe=null,Se=null,Ie=null,At=null,Nn=null,ti=null,Ra=null}}},u=new WeakMap,d=new WeakMap;let h={},f={},p=new WeakMap,m=[],g=null,y=!1,v=null,_=null,b=null,w=null,M=null,C=null,x=null,S=!1,I=null,L=null,k=null,P=null,R=null;const j=n.getParameter(35661);let O=!1,G=0;const N=n.getParameter(7938);-1!==N.indexOf("WebGL")?(G=parseFloat(/^WebGL (\d)/.exec(N)[1]),O=G>=1):-1!==N.indexOf("OpenGL ES")&&(G=parseFloat(/^OpenGL ES (\d)/.exec(N)[1]),O=G>=2);let $=null,Y={};const pe=n.getParameter(3088),B=n.getParameter(2978),te=(new Rt).fromArray(pe),ne=(new Rt).fromArray(B);function ce(F,q,oe){const Se=new Uint8Array(4),Ie=n.createTexture();n.bindTexture(F,Ie),n.texParameteri(F,10241,9728),n.texParameteri(F,10240,9728);for(let At=0;At<oe;At++)n.texImage2D(q+At,0,6408,1,1,0,6408,5121,Se);return Ie}const z={};function ve(F){!0!==h[F]&&(n.enable(F),h[F]=!0)}function _e(F){!1!==h[F]&&(n.disable(F),h[F]=!1)}z[3553]=ce(3553,3553,1),z[34067]=ce(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),ve(2929),l.setFunc(ap),ge(!1),Ye(zv),ve(2884),de(ps);const Q={[Zo]:32774,[B1]:32778,[V1]:32779};if(i)Q[qv]=32775,Q[Xv]=32776;else{const F=e.get("EXT_blend_minmax");null!==F&&(Q[qv]=F.MIN_EXT,Q[Xv]=F.MAX_EXT)}const J={[U1]:0,[z1]:1,[H1]:768,[Yv]:770,[X1]:776,[$1]:774,[j1]:772,[G1]:769,[Kv]:771,[q1]:775,[W1]:773};function de(F,q,oe,Se,Ie,At,Nn,ti){if(F!==ps){if(!1===y&&(ve(3042),y=!0),F===k1)Ie=Ie||q,At=At||oe,Nn=Nn||Se,(q!==_||Ie!==M)&&(n.blendEquationSeparate(Q[q],Q[Ie]),_=q,M=Ie),(oe!==b||Se!==w||At!==C||Nn!==x)&&(n.blendFuncSeparate(J[oe],J[Se],J[At],J[Nn]),b=oe,w=Se,C=At,x=Nn),v=F,S=!1;else if(F!==v||ti!==S){if((_!==Zo||M!==Zo)&&(n.blendEquation(32774),_=Zo,M=Zo),ti)switch(F){case Ko:n.blendFuncSeparate(1,771,1,771);break;case jv:n.blendFunc(1,1);break;case Wv:n.blendFuncSeparate(0,769,0,1);break;case $v:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",F)}else switch(F){case Ko:n.blendFuncSeparate(770,771,1,771);break;case jv:n.blendFunc(770,1);break;case Wv:n.blendFuncSeparate(0,769,0,1);break;case $v:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",F)}b=null,w=null,C=null,x=null,v=F,S=ti}}else!0===y&&(_e(3042),y=!1)}function ge(F){I!==F&&(n.frontFace(F?2304:2305),I=F)}function Ye(F){F!==L1?(ve(2884),F!==L&&n.cullFace(F===zv?1029:F===N1?1028:1032)):_e(2884),L=F}function Re(F,q,oe){F?(ve(32823),(P!==q||R!==oe)&&(n.polygonOffset(q,oe),P=q,R=oe)):_e(32823)}return{buffers:{color:a,depth:l,stencil:c},enable:ve,disable:_e,bindFramebuffer:function be(F,q){return f[F]!==q&&(n.bindFramebuffer(F,q),f[F]=q,i&&(36009===F&&(f[36160]=q),36160===F&&(f[36009]=q)),!0)},drawBuffers:function le(F,q){let oe=m,Se=!1;if(F)if(oe=p.get(q),void 0===oe&&(oe=[],p.set(q,oe)),F.isWebGLMultipleRenderTargets){const Ie=F.texture;if(oe.length!==Ie.length||36064!==oe[0]){for(let At=0,Nn=Ie.length;At<Nn;At++)oe[At]=36064+At;oe.length=Ie.length,Se=!0}}else 36064!==oe[0]&&(oe[0]=36064,Se=!0);else 1029!==oe[0]&&(oe[0]=1029,Se=!0);Se&&(t.isWebGL2?n.drawBuffers(oe):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(oe))},useProgram:function qe(F){return g!==F&&(n.useProgram(F),g=F,!0)},setBlending:de,setMaterial:function Ae(F,q){F.side===Wr?_e(2884):ve(2884);let oe=F.side===xi;q&&(oe=!oe),ge(oe),F.blending===Ko&&!1===F.transparent?de(ps):de(F.blending,F.blendEquation,F.blendSrc,F.blendDst,F.blendEquationAlpha,F.blendSrcAlpha,F.blendDstAlpha,F.premultipliedAlpha),l.setFunc(F.depthFunc),l.setTest(F.depthTest),l.setMask(F.depthWrite),a.setMask(F.colorWrite);const Se=F.stencilWrite;c.setTest(Se),Se&&(c.setMask(F.stencilWriteMask),c.setFunc(F.stencilFunc,F.stencilRef,F.stencilFuncMask),c.setOp(F.stencilFail,F.stencilZFail,F.stencilZPass)),Re(F.polygonOffset,F.polygonOffsetFactor,F.polygonOffsetUnits),!0===F.alphaToCoverage?ve(32926):_e(32926)},setFlipSided:ge,setCullFace:Ye,setLineWidth:function Be(F){F!==k&&(O&&n.lineWidth(F),k=F)},setPolygonOffset:Re,setScissorTest:function $t(F){F?ve(3089):_e(3089)},activeTexture:function Pt(F){void 0===F&&(F=33984+j-1),$!==F&&(n.activeTexture(F),$=F)},bindTexture:function T(F,q,oe){void 0===oe&&(oe=null===$?33984+j-1:$);let Se=Y[oe];void 0===Se&&(Se={type:void 0,texture:void 0},Y[oe]=Se),(Se.type!==F||Se.texture!==q)&&($!==oe&&(n.activeTexture(oe),$=oe),n.bindTexture(F,q||z[F]),Se.type=F,Se.texture=q)},unbindTexture:function E(){const F=Y[$];void 0!==F&&void 0!==F.type&&(n.bindTexture(F.type,null),F.type=void 0,F.texture=void 0)},compressedTexImage2D:function W(){try{n.compressedTexImage2D.apply(n,arguments)}catch(F){console.error("THREE.WebGLState:",F)}},compressedTexImage3D:function ae(){try{n.compressedTexImage3D.apply(n,arguments)}catch(F){console.error("THREE.WebGLState:",F)}},texImage2D:function Ue(){try{n.texImage2D.apply(n,arguments)}catch(F){console.error("THREE.WebGLState:",F)}},texImage3D:function Te(){try{n.texImage3D.apply(n,arguments)}catch(F){console.error("THREE.WebGLState:",F)}},updateUBOMapping:function yt(F,q){let oe=d.get(q);void 0===oe&&(oe=new WeakMap,d.set(q,oe));let Se=oe.get(F);void 0===Se&&(Se=n.getUniformBlockIndex(q,F.name),oe.set(F,Se))},uniformBlockBinding:function Xt(F,q){const Se=d.get(q).get(F);u.get(q)!==Se&&(n.uniformBlockBinding(q,Se,F.__bindingPointIndex),u.set(q,Se))},texStorage2D:function Z(){try{n.texStorage2D.apply(n,arguments)}catch(F){console.error("THREE.WebGLState:",F)}},texStorage3D:function Pe(){try{n.texStorage3D.apply(n,arguments)}catch(F){console.error("THREE.WebGLState:",F)}},texSubImage2D:function ue(){try{n.texSubImage2D.apply(n,arguments)}catch(F){console.error("THREE.WebGLState:",F)}},texSubImage3D:function xe(){try{n.texSubImage3D.apply(n,arguments)}catch(F){console.error("THREE.WebGLState:",F)}},compressedTexSubImage2D:function Ge(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(F){console.error("THREE.WebGLState:",F)}},compressedTexSubImage3D:function we(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(F){console.error("THREE.WebGLState:",F)}},scissor:function Ve(F){!1===te.equals(F)&&(n.scissor(F.x,F.y,F.z,F.w),te.copy(F))},viewport:function Fe(F){!1===ne.equals(F)&&(n.viewport(F.x,F.y,F.z,F.w),ne.copy(F))},reset:function Ln(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),!0===i&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},$=null,Y={},f={},p=new WeakMap,m=[],g=null,y=!1,v=null,_=null,b=null,w=null,M=null,C=null,x=null,S=!1,I=null,L=null,k=null,P=null,R=null,te.set(0,0,n.canvas.width,n.canvas.height),ne.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}}}function E7(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,d=r.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let m;const g=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function v(T,E){return y?new OffscreenCanvas(T,E):Zu("canvas")}function _(T,E,W,ae){let ue=1;if((T.width>ae||T.height>ae)&&(ue=ae/Math.max(T.width,T.height)),ue<1||!0===E){if(typeof HTMLImageElement<"u"&&T instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&T instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&T instanceof ImageBitmap){const xe=E?bp:Math.floor,Ge=xe(ue*T.width),we=xe(ue*T.height);void 0===m&&(m=v(Ge,we));const Z=W?v(Ge,we):m;return Z.width=Ge,Z.height=we,Z.getContext("2d").drawImage(T,0,0,Ge,we),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+T.width+"x"+T.height+") to ("+Ge+"x"+we+")."),Z}return"data"in T&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+T.width+"x"+T.height+")."),T}return T}function b(T){return Cb(T.width)&&Cb(T.height)}function M(T,E){return T.generateMipmaps&&E&&T.minFilter!==sn&&T.minFilter!==Jt}function C(T){n.generateMipmap(T)}function x(T,E,W,ae,ue=!1){if(!1===a)return E;if(null!==T){if(void 0!==n[T])return n[T];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+T+"'")}let xe=E;return 6403===E&&(5126===W&&(xe=33326),5131===W&&(xe=33325),5121===W&&(xe=33321)),33319===E&&(5126===W&&(xe=33328),5131===W&&(xe=33327),5121===W&&(xe=33323)),6408===E&&(5126===W&&(xe=34836),5131===W&&(xe=34842),5121===W&&(xe=ae===mt&&!1===ue?35907:32856),32819===W&&(xe=32854),32820===W&&(xe=32855)),(33325===xe||33326===xe||33327===xe||33328===xe||34842===xe||34836===xe)&&e.get("EXT_color_buffer_float"),xe}function S(T,E,W){return!0===M(T,W)||T.isFramebufferTexture&&T.minFilter!==sn&&T.minFilter!==Jt?Math.log2(Math.max(E.width,E.height))+1:void 0!==T.mipmaps&&T.mipmaps.length>0?T.mipmaps.length:T.isCompressedTexture&&Array.isArray(T.image)?E.mipmaps.length:1}function I(T){return T===sn||T===$u||T===Nl?9728:9729}function L(T){const E=T.target;E.removeEventListener("dispose",L),function P(T){const E=i.get(T);if(void 0===E.__webglInit)return;const W=T.source,ae=g.get(W);if(ae){const ue=ae[E.__cacheKey];ue.usedTimes--,0===ue.usedTimes&&R(T),0===Object.keys(ae).length&&g.delete(W)}i.remove(T)}(E),E.isVideoTexture&&p.delete(E)}function k(T){const E=T.target;E.removeEventListener("dispose",k),function j(T){const E=T.texture,W=i.get(T),ae=i.get(E);if(void 0!==ae.__webglTexture&&(n.deleteTexture(ae.__webglTexture),o.memory.textures--),T.depthTexture&&T.depthTexture.dispose(),T.isWebGLCubeRenderTarget)for(let ue=0;ue<6;ue++)n.deleteFramebuffer(W.__webglFramebuffer[ue]),W.__webglDepthbuffer&&n.deleteRenderbuffer(W.__webglDepthbuffer[ue]);else{if(n.deleteFramebuffer(W.__webglFramebuffer),W.__webglDepthbuffer&&n.deleteRenderbuffer(W.__webglDepthbuffer),W.__webglMultisampledFramebuffer&&n.deleteFramebuffer(W.__webglMultisampledFramebuffer),W.__webglColorRenderbuffer)for(let ue=0;ue<W.__webglColorRenderbuffer.length;ue++)W.__webglColorRenderbuffer[ue]&&n.deleteRenderbuffer(W.__webglColorRenderbuffer[ue]);W.__webglDepthRenderbuffer&&n.deleteRenderbuffer(W.__webglDepthRenderbuffer)}if(T.isWebGLMultipleRenderTargets)for(let ue=0,xe=E.length;ue<xe;ue++){const Ge=i.get(E[ue]);Ge.__webglTexture&&(n.deleteTexture(Ge.__webglTexture),o.memory.textures--),i.remove(E[ue])}i.remove(E),i.remove(T)}(E)}function R(T){const E=i.get(T);n.deleteTexture(E.__webglTexture),delete g.get(T.source)[E.__cacheKey],o.memory.textures--}let O=0;function Y(T,E){const W=i.get(T);if(T.isVideoTexture&&function $t(T){const E=o.render.frame;p.get(T)!==E&&(p.set(T,E),T.update())}(T),!1===T.isRenderTargetTexture&&T.version>0&&W.__version!==T.version){const ae=T.image;if(null===ae)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==ae.complete)return void _e(W,T,E);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(3553,W.__webglTexture,33984+E)}const ne={[Ys]:10497,[zn]:33071,[Ll]:33648},ce={[sn]:9728,[$u]:9984,[Nl]:9986,[Jt]:9729,[cp]:9985,[$r]:9987};function z(T,E,W){if(W?(n.texParameteri(T,10242,ne[E.wrapS]),n.texParameteri(T,10243,ne[E.wrapT]),(32879===T||35866===T)&&n.texParameteri(T,32882,ne[E.wrapR]),n.texParameteri(T,10240,ce[E.magFilter]),n.texParameteri(T,10241,ce[E.minFilter])):(n.texParameteri(T,10242,33071),n.texParameteri(T,10243,33071),(32879===T||35866===T)&&n.texParameteri(T,32882,33071),(E.wrapS!==zn||E.wrapT!==zn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(T,10240,I(E.magFilter)),n.texParameteri(T,10241,I(E.minFilter)),E.minFilter!==sn&&E.minFilter!==Jt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const ae=e.get("EXT_texture_filter_anisotropic");if(E.magFilter===sn||E.minFilter!==Nl&&E.minFilter!==$r||E.type===ms&&!1===e.has("OES_texture_float_linear")||!1===a&&E.type===kl&&!1===e.has("OES_texture_half_float_linear"))return;(E.anisotropy>1||i.get(E).__currentAnisotropy)&&(n.texParameterf(T,ae.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(E.anisotropy,r.getMaxAnisotropy())),i.get(E).__currentAnisotropy=E.anisotropy)}}function ve(T,E){let W=!1;void 0===T.__webglInit&&(T.__webglInit=!0,E.addEventListener("dispose",L));const ae=E.source;let ue=g.get(ae);void 0===ue&&(ue={},g.set(ae,ue));const xe=function $(T){const E=[];return E.push(T.wrapS),E.push(T.wrapT),E.push(T.wrapR||0),E.push(T.magFilter),E.push(T.minFilter),E.push(T.anisotropy),E.push(T.internalFormat),E.push(T.format),E.push(T.type),E.push(T.generateMipmaps),E.push(T.premultiplyAlpha),E.push(T.flipY),E.push(T.unpackAlignment),E.push(T.encoding),E.join()}(E);if(xe!==T.__cacheKey){void 0===ue[xe]&&(ue[xe]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,W=!0),ue[xe].usedTimes++;const Ge=ue[T.__cacheKey];void 0!==Ge&&(ue[T.__cacheKey].usedTimes--,0===Ge.usedTimes&&R(E)),T.__cacheKey=xe,T.__webglTexture=ue[xe].texture}return W}function _e(T,E,W){let ae=3553;(E.isDataArrayTexture||E.isCompressedArrayTexture)&&(ae=35866),E.isData3DTexture&&(ae=32879);const ue=ve(T,E),xe=E.source;t.bindTexture(ae,T.__webglTexture,33984+W);const Ge=i.get(xe);if(xe.version!==Ge.__version||!0===ue){t.activeTexture(33984+W),n.pixelStorei(37440,E.flipY),n.pixelStorei(37441,E.premultiplyAlpha),n.pixelStorei(3317,E.unpackAlignment),n.pixelStorei(37443,0);const we=function w(T){return!a&&(T.wrapS!==zn||T.wrapT!==zn||T.minFilter!==sn&&T.minFilter!==Jt)}(E)&&!1===b(E.image);let Z=_(E.image,we,!1,u);Z=Pt(E,Z);const Pe=b(Z)||a,Ue=s.convert(E.format,E.encoding);let Fe,Te=s.convert(E.type),Ve=x(E.internalFormat,Ue,Te,E.encoding,E.isVideoTexture);z(ae,E,Pe);const yt=E.mipmaps,Xt=a&&!0!==E.isVideoTexture,Ln=void 0===Ge.__version||!0===ue,F=S(E,Z,Pe);if(E.isDepthTexture)Ve=6402,a?Ve=E.type===ms?36012:E.type===Zs?33190:E.type===Jo?35056:33189:E.type===ms&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),E.format===Js&&6402===Ve&&E.type!==Jv&&E.type!==Zs&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),E.type=Zs,Te=s.convert(E.type)),E.format===Qo&&6402===Ve&&(Ve=34041,E.type!==Jo&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),E.type=Jo,Te=s.convert(E.type))),Ln&&(Xt?t.texStorage2D(3553,1,Ve,Z.width,Z.height):t.texImage2D(3553,0,Ve,Z.width,Z.height,0,Ue,Te,null));else if(E.isDataTexture)if(yt.length>0&&Pe){Xt&&Ln&&t.texStorage2D(3553,F,Ve,yt[0].width,yt[0].height);for(let q=0,oe=yt.length;q<oe;q++)Fe=yt[q],Xt?t.texSubImage2D(3553,q,0,0,Fe.width,Fe.height,Ue,Te,Fe.data):t.texImage2D(3553,q,Ve,Fe.width,Fe.height,0,Ue,Te,Fe.data);E.generateMipmaps=!1}else Xt?(Ln&&t.texStorage2D(3553,F,Ve,Z.width,Z.height),t.texSubImage2D(3553,0,0,0,Z.width,Z.height,Ue,Te,Z.data)):t.texImage2D(3553,0,Ve,Z.width,Z.height,0,Ue,Te,Z.data);else if(E.isCompressedTexture)if(E.isCompressedArrayTexture){Xt&&Ln&&t.texStorage3D(35866,F,Ve,yt[0].width,yt[0].height,Z.depth);for(let q=0,oe=yt.length;q<oe;q++)Fe=yt[q],E.format!==Pi?null!==Ue?Xt?t.compressedTexSubImage3D(35866,q,0,0,0,Fe.width,Fe.height,Z.depth,Ue,Fe.data,0,0):t.compressedTexImage3D(35866,q,Ve,Fe.width,Fe.height,Z.depth,0,Fe.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Xt?t.texSubImage3D(35866,q,0,0,0,Fe.width,Fe.height,Z.depth,Ue,Te,Fe.data):t.texImage3D(35866,q,Ve,Fe.width,Fe.height,Z.depth,0,Ue,Te,Fe.data)}else{Xt&&Ln&&t.texStorage2D(3553,F,Ve,yt[0].width,yt[0].height);for(let q=0,oe=yt.length;q<oe;q++)Fe=yt[q],E.format!==Pi?null!==Ue?Xt?t.compressedTexSubImage2D(3553,q,0,0,Fe.width,Fe.height,Ue,Fe.data):t.compressedTexImage2D(3553,q,Ve,Fe.width,Fe.height,0,Fe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Xt?t.texSubImage2D(3553,q,0,0,Fe.width,Fe.height,Ue,Te,Fe.data):t.texImage2D(3553,q,Ve,Fe.width,Fe.height,0,Ue,Te,Fe.data)}else if(E.isDataArrayTexture)Xt?(Ln&&t.texStorage3D(35866,F,Ve,Z.width,Z.height,Z.depth),t.texSubImage3D(35866,0,0,0,0,Z.width,Z.height,Z.depth,Ue,Te,Z.data)):t.texImage3D(35866,0,Ve,Z.width,Z.height,Z.depth,0,Ue,Te,Z.data);else if(E.isData3DTexture)Xt?(Ln&&t.texStorage3D(32879,F,Ve,Z.width,Z.height,Z.depth),t.texSubImage3D(32879,0,0,0,0,Z.width,Z.height,Z.depth,Ue,Te,Z.data)):t.texImage3D(32879,0,Ve,Z.width,Z.height,Z.depth,0,Ue,Te,Z.data);else if(E.isFramebufferTexture){if(Ln)if(Xt)t.texStorage2D(3553,F,Ve,Z.width,Z.height);else{let q=Z.width,oe=Z.height;for(let Se=0;Se<F;Se++)t.texImage2D(3553,Se,Ve,q,oe,0,Ue,Te,null),q>>=1,oe>>=1}}else if(yt.length>0&&Pe){Xt&&Ln&&t.texStorage2D(3553,F,Ve,yt[0].width,yt[0].height);for(let q=0,oe=yt.length;q<oe;q++)Fe=yt[q],Xt?t.texSubImage2D(3553,q,0,0,Ue,Te,Fe):t.texImage2D(3553,q,Ve,Ue,Te,Fe);E.generateMipmaps=!1}else Xt?(Ln&&t.texStorage2D(3553,F,Ve,Z.width,Z.height),t.texSubImage2D(3553,0,0,0,Ue,Te,Z)):t.texImage2D(3553,0,Ve,Ue,Te,Z);M(E,Pe)&&C(ae),Ge.__version=xe.version,E.onUpdate&&E.onUpdate(E)}T.__version=E.version}function le(T,E,W,ae,ue){const xe=s.convert(W.format,W.encoding),Ge=s.convert(W.type),we=x(W.internalFormat,xe,Ge,W.encoding);i.get(E).__hasExternalTextures||(32879===ue||35866===ue?t.texImage3D(ue,0,we,E.width,E.height,E.depth,0,xe,Ge,null):t.texImage2D(ue,0,we,E.width,E.height,0,xe,Ge,null)),t.bindFramebuffer(36160,T),Re(E)?h.framebufferTexture2DMultisampleEXT(36160,ae,ue,i.get(W).__webglTexture,0,Be(E)):(3553===ue||ue>=34069&&ue<=34074)&&n.framebufferTexture2D(36160,ae,ue,i.get(W).__webglTexture,0),t.bindFramebuffer(36160,null)}function qe(T,E,W){if(n.bindRenderbuffer(36161,T),E.depthBuffer&&!E.stencilBuffer){let ae=33189;if(W||Re(E)){const ue=E.depthTexture;ue&&ue.isDepthTexture&&(ue.type===ms?ae=36012:ue.type===Zs&&(ae=33190));const xe=Be(E);Re(E)?h.renderbufferStorageMultisampleEXT(36161,xe,ae,E.width,E.height):n.renderbufferStorageMultisample(36161,xe,ae,E.width,E.height)}else n.renderbufferStorage(36161,ae,E.width,E.height);n.framebufferRenderbuffer(36160,36096,36161,T)}else if(E.depthBuffer&&E.stencilBuffer){const ae=Be(E);W&&!1===Re(E)?n.renderbufferStorageMultisample(36161,ae,35056,E.width,E.height):Re(E)?h.renderbufferStorageMultisampleEXT(36161,ae,35056,E.width,E.height):n.renderbufferStorage(36161,34041,E.width,E.height),n.framebufferRenderbuffer(36160,33306,36161,T)}else{const ae=!0===E.isWebGLMultipleRenderTargets?E.texture:[E.texture];for(let ue=0;ue<ae.length;ue++){const xe=ae[ue],Ge=s.convert(xe.format,xe.encoding),we=s.convert(xe.type),Z=x(xe.internalFormat,Ge,we,xe.encoding),Pe=Be(E);W&&!1===Re(E)?n.renderbufferStorageMultisample(36161,Pe,Z,E.width,E.height):Re(E)?h.renderbufferStorageMultisampleEXT(36161,Pe,Z,E.width,E.height):n.renderbufferStorage(36161,Z,E.width,E.height)}}n.bindRenderbuffer(36161,null)}function J(T){const E=i.get(T),W=!0===T.isWebGLCubeRenderTarget;if(T.depthTexture&&!E.__autoAllocateDepthBuffer){if(W)throw new Error("target.depthTexture not supported in Cube render targets");!function Q(T,E){if(E&&E.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,T),!E.depthTexture||!E.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(E.depthTexture).__webglTexture||E.depthTexture.image.width!==E.width||E.depthTexture.image.height!==E.height)&&(E.depthTexture.image.width=E.width,E.depthTexture.image.height=E.height,E.depthTexture.needsUpdate=!0),Y(E.depthTexture,0);const ae=i.get(E.depthTexture).__webglTexture,ue=Be(E);if(E.depthTexture.format===Js)Re(E)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,ae,0,ue):n.framebufferTexture2D(36160,36096,3553,ae,0);else{if(E.depthTexture.format!==Qo)throw new Error("Unknown depthTexture format");Re(E)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,ae,0,ue):n.framebufferTexture2D(36160,33306,3553,ae,0)}}(E.__webglFramebuffer,T)}else if(W){E.__webglDepthbuffer=[];for(let ae=0;ae<6;ae++)t.bindFramebuffer(36160,E.__webglFramebuffer[ae]),E.__webglDepthbuffer[ae]=n.createRenderbuffer(),qe(E.__webglDepthbuffer[ae],T,!1)}else t.bindFramebuffer(36160,E.__webglFramebuffer),E.__webglDepthbuffer=n.createRenderbuffer(),qe(E.__webglDepthbuffer,T,!1);t.bindFramebuffer(36160,null)}function Be(T){return Math.min(d,T.samples)}function Re(T){const E=i.get(T);return a&&T.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==E.__useRenderToTexture}function Pt(T,E){const W=T.encoding,ae=T.format,ue=T.type;return!0===T.isCompressedTexture||!0===T.isVideoTexture||T.format===vp||W!==gs&&(W===mt?!1===a?!0===e.has("EXT_sRGB")&&ae===Pi?(T.format=vp,T.minFilter=Jt,T.generateMipmaps=!1):E=Rb.sRGBToLinear(E):(ae!==Pi||ue!==Ks)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",W)),E}this.allocateTextureUnit=function N(){const T=O;return T>=l&&console.warn("THREE.WebGLTextures: Trying to use "+T+" texture units while this GPU supports only "+l),O+=1,T},this.resetTextureUnits=function G(){O=0},this.setTexture2D=Y,this.setTexture2DArray=function pe(T,E){const W=i.get(T);T.version>0&&W.__version!==T.version?_e(W,T,E):t.bindTexture(35866,W.__webglTexture,33984+E)},this.setTexture3D=function B(T,E){const W=i.get(T);T.version>0&&W.__version!==T.version?_e(W,T,E):t.bindTexture(32879,W.__webglTexture,33984+E)},this.setTextureCube=function te(T,E){const W=i.get(T);T.version>0&&W.__version!==T.version?function be(T,E,W){if(6!==E.image.length)return;const ae=ve(T,E),ue=E.source;t.bindTexture(34067,T.__webglTexture,33984+W);const xe=i.get(ue);if(ue.version!==xe.__version||!0===ae){t.activeTexture(33984+W),n.pixelStorei(37440,E.flipY),n.pixelStorei(37441,E.premultiplyAlpha),n.pixelStorei(3317,E.unpackAlignment),n.pixelStorei(37443,0);const Ge=E.isCompressedTexture||E.image[0].isCompressedTexture,we=E.image[0]&&E.image[0].isDataTexture,Z=[];for(let q=0;q<6;q++)Z[q]=Ge||we?we?E.image[q].image:E.image[q]:_(E.image[q],!1,!0,c),Z[q]=Pt(E,Z[q]);const Pe=Z[0],Ue=b(Pe)||a,Te=s.convert(E.format,E.encoding),Ve=s.convert(E.type),Fe=x(E.internalFormat,Te,Ve,E.encoding),yt=a&&!0!==E.isVideoTexture,Xt=void 0===xe.__version||!0===ae;let F,Ln=S(E,Pe,Ue);if(z(34067,E,Ue),Ge){yt&&Xt&&t.texStorage2D(34067,Ln,Fe,Pe.width,Pe.height);for(let q=0;q<6;q++){F=Z[q].mipmaps;for(let oe=0;oe<F.length;oe++){const Se=F[oe];E.format!==Pi?null!==Te?yt?t.compressedTexSubImage2D(34069+q,oe,0,0,Se.width,Se.height,Te,Se.data):t.compressedTexImage2D(34069+q,oe,Fe,Se.width,Se.height,0,Se.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):yt?t.texSubImage2D(34069+q,oe,0,0,Se.width,Se.height,Te,Ve,Se.data):t.texImage2D(34069+q,oe,Fe,Se.width,Se.height,0,Te,Ve,Se.data)}}}else{F=E.mipmaps,yt&&Xt&&(F.length>0&&Ln++,t.texStorage2D(34067,Ln,Fe,Z[0].width,Z[0].height));for(let q=0;q<6;q++)if(we){yt?t.texSubImage2D(34069+q,0,0,0,Z[q].width,Z[q].height,Te,Ve,Z[q].data):t.texImage2D(34069+q,0,Fe,Z[q].width,Z[q].height,0,Te,Ve,Z[q].data);for(let oe=0;oe<F.length;oe++){const Ie=F[oe].image[q].image;yt?t.texSubImage2D(34069+q,oe+1,0,0,Ie.width,Ie.height,Te,Ve,Ie.data):t.texImage2D(34069+q,oe+1,Fe,Ie.width,Ie.height,0,Te,Ve,Ie.data)}}else{yt?t.texSubImage2D(34069+q,0,0,0,Te,Ve,Z[q]):t.texImage2D(34069+q,0,Fe,Te,Ve,Z[q]);for(let oe=0;oe<F.length;oe++){const Se=F[oe];yt?t.texSubImage2D(34069+q,oe+1,0,0,Te,Ve,Se.image[q]):t.texImage2D(34069+q,oe+1,Fe,Te,Ve,Se.image[q])}}}M(E,Ue)&&C(34067),xe.__version=ue.version,E.onUpdate&&E.onUpdate(E)}T.__version=E.version}(W,T,E):t.bindTexture(34067,W.__webglTexture,33984+E)},this.rebindTextures=function de(T,E,W){const ae=i.get(T);void 0!==E&&le(ae.__webglFramebuffer,T,T.texture,36064,3553),void 0!==W&&J(T)},this.setupRenderTarget=function Ae(T){const E=T.texture,W=i.get(T),ae=i.get(E);T.addEventListener("dispose",k),!0!==T.isWebGLMultipleRenderTargets&&(void 0===ae.__webglTexture&&(ae.__webglTexture=n.createTexture()),ae.__version=E.version,o.memory.textures++);const ue=!0===T.isWebGLCubeRenderTarget,xe=!0===T.isWebGLMultipleRenderTargets,Ge=b(T)||a;if(ue){W.__webglFramebuffer=[];for(let we=0;we<6;we++)W.__webglFramebuffer[we]=n.createFramebuffer()}else{if(W.__webglFramebuffer=n.createFramebuffer(),xe)if(r.drawBuffers){const we=T.texture;for(let Z=0,Pe=we.length;Z<Pe;Z++){const Ue=i.get(we[Z]);void 0===Ue.__webglTexture&&(Ue.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&T.samples>0&&!1===Re(T)){const we=xe?E:[E];W.__webglMultisampledFramebuffer=n.createFramebuffer(),W.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,W.__webglMultisampledFramebuffer);for(let Z=0;Z<we.length;Z++){const Pe=we[Z];W.__webglColorRenderbuffer[Z]=n.createRenderbuffer(),n.bindRenderbuffer(36161,W.__webglColorRenderbuffer[Z]);const Ue=s.convert(Pe.format,Pe.encoding),Te=s.convert(Pe.type),Ve=x(Pe.internalFormat,Ue,Te,Pe.encoding,!0===T.isXRRenderTarget),Fe=Be(T);n.renderbufferStorageMultisample(36161,Fe,Ve,T.width,T.height),n.framebufferRenderbuffer(36160,36064+Z,36161,W.__webglColorRenderbuffer[Z])}n.bindRenderbuffer(36161,null),T.depthBuffer&&(W.__webglDepthRenderbuffer=n.createRenderbuffer(),qe(W.__webglDepthRenderbuffer,T,!0)),t.bindFramebuffer(36160,null)}}if(ue){t.bindTexture(34067,ae.__webglTexture),z(34067,E,Ge);for(let we=0;we<6;we++)le(W.__webglFramebuffer[we],T,E,36064,34069+we);M(E,Ge)&&C(34067),t.unbindTexture()}else if(xe){const we=T.texture;for(let Z=0,Pe=we.length;Z<Pe;Z++){const Ue=we[Z],Te=i.get(Ue);t.bindTexture(3553,Te.__webglTexture),z(3553,Ue,Ge),le(W.__webglFramebuffer,T,Ue,36064+Z,3553),M(Ue,Ge)&&C(3553)}t.unbindTexture()}else{let we=3553;(T.isWebGL3DRenderTarget||T.isWebGLArrayRenderTarget)&&(a?we=T.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(we,ae.__webglTexture),z(we,E,Ge),le(W.__webglFramebuffer,T,E,36064,we),M(E,Ge)&&C(we),t.unbindTexture()}T.depthBuffer&&J(T)},this.updateRenderTargetMipmap=function ge(T){const E=b(T)||a,W=!0===T.isWebGLMultipleRenderTargets?T.texture:[T.texture];for(let ae=0,ue=W.length;ae<ue;ae++){const xe=W[ae];if(M(xe,E)){const Ge=T.isWebGLCubeRenderTarget?34067:3553,we=i.get(xe).__webglTexture;t.bindTexture(Ge,we),C(Ge),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Ye(T){if(a&&T.samples>0&&!1===Re(T)){const E=T.isWebGLMultipleRenderTargets?T.texture:[T.texture],W=T.width,ae=T.height;let ue=16384;const xe=[],Ge=T.stencilBuffer?33306:36096,we=i.get(T),Z=!0===T.isWebGLMultipleRenderTargets;if(Z)for(let Pe=0;Pe<E.length;Pe++)t.bindFramebuffer(36160,we.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+Pe,36161,null),t.bindFramebuffer(36160,we.__webglFramebuffer),n.framebufferTexture2D(36009,36064+Pe,3553,null,0);t.bindFramebuffer(36008,we.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,we.__webglFramebuffer);for(let Pe=0;Pe<E.length;Pe++){xe.push(36064+Pe),T.depthBuffer&&xe.push(Ge);const Ue=void 0!==we.__ignoreDepthValues&&we.__ignoreDepthValues;if(!1===Ue&&(T.depthBuffer&&(ue|=256),T.stencilBuffer&&(ue|=1024)),Z&&n.framebufferRenderbuffer(36008,36064,36161,we.__webglColorRenderbuffer[Pe]),!0===Ue&&(n.invalidateFramebuffer(36008,[Ge]),n.invalidateFramebuffer(36009,[Ge])),Z){const Te=i.get(E[Pe]).__webglTexture;n.framebufferTexture2D(36009,36064,3553,Te,0)}n.blitFramebuffer(0,0,W,ae,0,0,W,ae,ue,9728),f&&n.invalidateFramebuffer(36008,xe)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),Z)for(let Pe=0;Pe<E.length;Pe++){t.bindFramebuffer(36160,we.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+Pe,36161,we.__webglColorRenderbuffer[Pe]);const Ue=i.get(E[Pe]).__webglTexture;t.bindFramebuffer(36160,we.__webglFramebuffer),n.framebufferTexture2D(36009,36064+Pe,3553,Ue,0)}t.bindFramebuffer(36009,we.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=J,this.setupFrameBufferTexture=le,this.useMultisampledRTT=Re}function wR(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=null){let a;if(s===Ks)return 5121;if(s===dI)return 32819;if(s===hI)return 32820;if(s===lI)return 5120;if(s===cI)return 5122;if(s===Jv)return 5123;if(s===uI)return 5124;if(s===Zs)return 5125;if(s===ms)return 5126;if(s===kl)return i?5131:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(s===fI)return 6406;if(s===Pi)return 6408;if(s===pI)return 6409;if(s===mI)return 6410;if(s===Js)return 6402;if(s===Qo)return 34041;if(s===vp)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(s===gI)return 6403;if(s===_I)return 36244;if(s===yI)return 33319;if(s===vI)return 33320;if(s===bI)return 36249;if(s===up||s===dp||s===hp||s===fp)if(o===mt){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(s===up)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===dp)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===hp)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===fp)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(s===up)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===dp)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===hp)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===fp)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(s===Qv||s===eb||s===tb||s===nb){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(s===Qv)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===eb)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===tb)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===nb)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(s===xI)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===ib||s===rb){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(s===ib)return o===mt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===rb)return o===mt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(s===sb||s===ob||s===ab||s===lb||s===cb||s===ub||s===db||s===hb||s===fb||s===pb||s===mb||s===gb||s===_b||s===yb){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(s===sb)return o===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===ob)return o===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===ab)return o===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===lb)return o===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===cb)return o===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===ub)return o===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===db)return o===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===hb)return o===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===fb)return o===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===pb)return o===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===mb)return o===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===gb)return o===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===_b)return o===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===yb)return o===mt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(s===pp){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(s===pp)return o===mt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(s===wI||s===vb||s===bb||s===xb){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(s===pp)return a.COMPRESSED_RED_RGTC1_EXT;if(s===vb)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===bb)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===xb)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===Jo?i?34042:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class MR extends An{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Ss extends Vt{constructor(){super(),this.isGroup=!0,this.type="Group"}}const C7={type:"move"};class a0{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Ss,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Ss,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new D,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new D),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Ss,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new D,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new D),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(c&&e.hand){o=!0;for(const m of e.hand.values()){const g=t.getJointPose(m,i),y=this._getHandJoint(c,m);null!==g&&(y.matrix.fromArray(g.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.jointRadius=g.radius),y.visible=null!==g}const h=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),f=.02,p=.005;c.inputState.pinching&&h>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(C7)))}return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new Ss;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class SR extends Hn{constructor(e,t,i,r,s,o,a,l,c,u){if((u=void 0!==u?u:Js)!==Js&&u!==Qo)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===Js&&(i=Zs),void 0===i&&u===Qo&&(i=Jo),super(null,r,s,o,a,l,u,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:sn,this.minFilter=void 0!==l?l:sn,this.flipY=!1,this.generateMipmaps=!1}}class D7 extends _s{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,d=null,h=null,f=null,p=null;const m=t.getContextAttributes();let g=null,y=null;const v=[],_=[],b=new Set,w=new Map,M=new An;M.layers.enable(1),M.viewport=new Rt;const C=new An;C.layers.enable(2),C.viewport=new Rt;const x=[M,C],S=new MR;S.layers.enable(1),S.layers.enable(2);let I=null,L=null;function k(B){const te=_.indexOf(B.inputSource);if(-1===te)return;const ne=v[te];void 0!==ne&&ne.dispatchEvent({type:B.type,data:B.inputSource})}function P(){r.removeEventListener("select",k),r.removeEventListener("selectstart",k),r.removeEventListener("selectend",k),r.removeEventListener("squeeze",k),r.removeEventListener("squeezestart",k),r.removeEventListener("squeezeend",k),r.removeEventListener("end",P),r.removeEventListener("inputsourceschange",R);for(let B=0;B<v.length;B++){const te=_[B];null!==te&&(_[B]=null,v[B].disconnect(te))}I=null,L=null,e.setRenderTarget(g),f=null,h=null,d=null,r=null,y=null,pe.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function R(B){for(let te=0;te<B.removed.length;te++){const ne=B.removed[te],ce=_.indexOf(ne);ce>=0&&(_[ce]=null,v[ce].disconnect(ne))}for(let te=0;te<B.added.length;te++){const ne=B.added[te];let ce=_.indexOf(ne);if(-1===ce){for(let ve=0;ve<v.length;ve++){if(ve>=_.length){_.push(ne),ce=ve;break}if(null===_[ve]){_[ve]=ne,ce=ve;break}}if(-1===ce)break}const z=v[ce];z&&z.connect(ne)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(B){let te=v[B];return void 0===te&&(te=new a0,v[B]=te),te.getTargetRaySpace()},this.getControllerGrip=function(B){let te=v[B];return void 0===te&&(te=new a0,v[B]=te),te.getGripSpace()},this.getHand=function(B){let te=v[B];return void 0===te&&(te=new a0,v[B]=te),te.getHandSpace()},this.setFramebufferScaleFactor=function(B){s=B,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(B){a=B,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(B){c=B},this.getBaseLayer=function(){return null!==h?h:f},this.getBinding=function(){return d},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=function(){var B=Hu(function*(te){if(r=te,null!==r){if(g=e.getRenderTarget(),r.addEventListener("select",k),r.addEventListener("selectstart",k),r.addEventListener("selectend",k),r.addEventListener("squeeze",k),r.addEventListener("squeezestart",k),r.addEventListener("squeezeend",k),r.addEventListener("end",P),r.addEventListener("inputsourceschange",R),!0!==m.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)f=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||m.antialias,alpha:m.alpha,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:f}),y=new wr(f.framebufferWidth,f.framebufferHeight,{format:Pi,type:Ks,encoding:e.outputEncoding,stencilBuffer:m.stencil});else{let ne=null,ce=null,z=null;m.depth&&(z=m.stencil?35056:33190,ne=m.stencil?Qo:Js,ce=m.stencil?Jo:Zs);const ve={colorFormat:32856,depthFormat:z,scaleFactor:s};d=new XRWebGLBinding(r,t),h=d.createProjectionLayer(ve),r.updateRenderState({layers:[h]}),y=new wr(h.textureWidth,h.textureHeight,{format:Pi,type:Ks,depthTexture:new SR(h.textureWidth,h.textureHeight,ce,void 0,void 0,void 0,void 0,void 0,void 0,ne),stencilBuffer:m.stencil,encoding:e.outputEncoding,samples:m.antialias?4:0}),e.properties.get(y).__ignoreDepthValues=h.ignoreDepthValues}y.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=yield r.requestReferenceSpace(a),pe.setContext(r),pe.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(te){return B.apply(this,arguments)}}();const j=new D,O=new D;function N(B,te){null===te?B.matrixWorld.copy(B.matrix):B.matrixWorld.multiplyMatrices(te.matrixWorld,B.matrix),B.matrixWorldInverse.copy(B.matrixWorld).invert()}this.updateCamera=function(B){if(null===r)return;S.near=C.near=M.near=B.near,S.far=C.far=M.far=B.far,(I!==S.near||L!==S.far)&&(r.updateRenderState({depthNear:S.near,depthFar:S.far}),I=S.near,L=S.far);const te=B.parent,ne=S.cameras;N(S,te);for(let z=0;z<ne.length;z++)N(ne[z],te);S.matrixWorld.decompose(S.position,S.quaternion,S.scale),B.matrix.copy(S.matrix),B.matrix.decompose(B.position,B.quaternion,B.scale);const ce=B.children;for(let z=0,ve=ce.length;z<ve;z++)ce[z].updateMatrixWorld(!0);2===ne.length?function G(B,te,ne){j.setFromMatrixPosition(te.matrixWorld),O.setFromMatrixPosition(ne.matrixWorld);const ce=j.distanceTo(O),z=te.projectionMatrix.elements,ve=ne.projectionMatrix.elements,_e=z[14]/(z[10]-1),be=z[14]/(z[10]+1),le=(z[9]+1)/z[5],qe=(z[9]-1)/z[5],Q=(z[8]-1)/z[0],J=(ve[8]+1)/ve[0],de=_e*Q,Ae=_e*J,ge=ce/(-Q+J),Ye=ge*-Q;te.matrixWorld.decompose(B.position,B.quaternion,B.scale),B.translateX(Ye),B.translateZ(ge),B.matrixWorld.compose(B.position,B.quaternion,B.scale),B.matrixWorldInverse.copy(B.matrixWorld).invert();const Be=_e+ge,Re=be+ge;B.projectionMatrix.makePerspective(de-Ye,Ae+(ce-Ye),le*be/Re*Be,qe*be/Re*Be,Be,Re)}(S,M,C):S.projectionMatrix.copy(M.projectionMatrix)},this.getCamera=function(){return S},this.getFoveation=function(){if(null!==h||null!==f)return l},this.setFoveation=function(B){l=B,null!==h&&(h.fixedFoveation=B),null!==f&&void 0!==f.fixedFoveation&&(f.fixedFoveation=B)},this.getPlanes=function(){return b};let $=null;const pe=new KI;pe.setAnimationLoop(function Y(B,te){if(u=te.getViewerPose(c||o),p=te,null!==u){const ne=u.views;null!==f&&(e.setRenderTargetFramebuffer(y,f.framebuffer),e.setRenderTarget(y));let ce=!1;ne.length!==S.cameras.length&&(S.cameras.length=0,ce=!0);for(let z=0;z<ne.length;z++){const ve=ne[z];let _e=null;if(null!==f)_e=f.getViewport(ve);else{const le=d.getViewSubImage(h,ve);_e=le.viewport,0===z&&(e.setRenderTargetTextures(y,le.colorTexture,h.ignoreDepthValues?void 0:le.depthStencilTexture),e.setRenderTarget(y))}let be=x[z];void 0===be&&(be=new An,be.layers.enable(z),be.viewport=new Rt,x[z]=be),be.matrix.fromArray(ve.transform.matrix),be.projectionMatrix.fromArray(ve.projectionMatrix),be.viewport.set(_e.x,_e.y,_e.width,_e.height),0===z&&S.matrix.copy(be.matrix),!0===ce&&S.cameras.push(be)}}for(let ne=0;ne<v.length;ne++){const ce=_[ne],z=v[ne];null!==ce&&void 0!==z&&z.update(ce,te,c||o)}if($&&$(B,te),te.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:te.detectedPlanes});let ne=null;for(const ce of b)te.detectedPlanes.has(ce)||(null===ne&&(ne=[]),ne.push(ce));if(null!==ne)for(const ce of ne)b.delete(ce),w.delete(ce),i.dispatchEvent({type:"planeremoved",data:ce});for(const ce of te.detectedPlanes)if(b.has(ce)){const z=w.get(ce);ce.lastChangedTime>z&&(w.set(ce,ce.lastChangedTime),i.dispatchEvent({type:"planechanged",data:ce}))}else b.add(ce),w.set(ce,te.lastChangedTime),i.dispatchEvent({type:"planeadded",data:ce})}p=null}),this.setAnimationLoop=function(B){$=B},this.dispose=function(){}}}function A7(n,e){function r(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.bumpMap&&(m.bumpMap.value=g.bumpMap,m.bumpScale.value=g.bumpScale,g.side===xi&&(m.bumpScale.value*=-1)),g.displacementMap&&(m.displacementMap.value=g.displacementMap,m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap),g.normalMap&&(m.normalMap.value=g.normalMap,m.normalScale.value.copy(g.normalScale),g.side===xi&&m.normalScale.value.negate()),g.specularMap&&(m.specularMap.value=g.specularMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);const y=e.get(g).envMap;if(y&&(m.envMap.value=y,m.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap){m.lightMap.value=g.lightMap;const b=!0!==n.physicallyCorrectLights?Math.PI:1;m.lightMapIntensity.value=g.lightMapIntensity*b}let v,_;g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity),g.map?v=g.map:g.specularMap?v=g.specularMap:g.displacementMap?v=g.displacementMap:g.normalMap?v=g.normalMap:g.bumpMap?v=g.bumpMap:g.roughnessMap?v=g.roughnessMap:g.metalnessMap?v=g.metalnessMap:g.alphaMap?v=g.alphaMap:g.emissiveMap?v=g.emissiveMap:g.clearcoatMap?v=g.clearcoatMap:g.clearcoatNormalMap?v=g.clearcoatNormalMap:g.clearcoatRoughnessMap?v=g.clearcoatRoughnessMap:g.iridescenceMap?v=g.iridescenceMap:g.iridescenceThicknessMap?v=g.iridescenceThicknessMap:g.specularIntensityMap?v=g.specularIntensityMap:g.specularColorMap?v=g.specularColorMap:g.transmissionMap?v=g.transmissionMap:g.thicknessMap?v=g.thicknessMap:g.sheenColorMap?v=g.sheenColorMap:g.sheenRoughnessMap&&(v=g.sheenRoughnessMap),void 0!==v&&(v.isWebGLRenderTarget&&(v=v.texture),!0===v.matrixAutoUpdate&&v.updateMatrix(),m.uvTransform.value.copy(v.matrix)),g.aoMap?_=g.aoMap:g.lightMap&&(_=g.lightMap),void 0!==_&&(_.isWebGLRenderTarget&&(_=_.texture),!0===_.matrixAutoUpdate&&_.updateMatrix(),m.uv2Transform.value.copy(_.matrix))}return{refreshFogUniforms:function t(m,g){g.color.getRGB(m.fogColor.value,$I(n)),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)},refreshMaterialUniforms:function i(m,g,y,v,_){g.isMeshBasicMaterial||g.isMeshLambertMaterial?r(m,g):g.isMeshToonMaterial?(r(m,g),function u(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}(m,g)):g.isMeshPhongMaterial?(r(m,g),function c(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}(m,g)):g.isMeshStandardMaterial?(r(m,g),function d(m,g){m.roughness.value=g.roughness,m.metalness.value=g.metalness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(m.envMapIntensity.value=g.envMapIntensity)}(m,g),g.isMeshPhysicalMaterial&&function h(m,g,y){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),m.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===xi&&m.clearcoatNormalScale.value.negate())),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=y.texture,m.transmissionSamplerSize.value.set(y.width,y.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap)}(m,g,_)):g.isMeshMatcapMaterial?(r(m,g),function f(m,g){g.matcap&&(m.matcap.value=g.matcap)}(m,g)):g.isMeshDepthMaterial?r(m,g):g.isMeshDistanceMaterial?(r(m,g),function p(m,g){m.referencePosition.value.copy(g.referencePosition),m.nearDistance.value=g.nearDistance,m.farDistance.value=g.farDistance}(m,g)):g.isMeshNormalMaterial?r(m,g):g.isLineBasicMaterial?(function s(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity}(m,g),g.isLineDashedMaterial&&function o(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}(m,g)):g.isPointsMaterial?function a(m,g,y,v){let _;m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*y,m.scale.value=.5*v,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest),g.map?_=g.map:g.alphaMap&&(_=g.alphaMap),void 0!==_&&(!0===_.matrixAutoUpdate&&_.updateMatrix(),m.uvTransform.value.copy(_.matrix))}(m,g,y,v):g.isSpriteMaterial?function l(m,g){let y;m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest),g.map?y=g.map:g.alphaMap&&(y=g.alphaMap),void 0!==y&&(!0===y.matrixAutoUpdate&&y.updateMatrix(),m.uvTransform.value.copy(y.matrix))}(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}}}function T7(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(35375):0;function f(v,_,b){const w=v.value;if(void 0===b[_]){if("number"==typeof w)b[_]=w;else{const M=Array.isArray(w)?w:[w],C=[];for(let x=0;x<M.length;x++)C.push(M[x].clone());b[_]=C}return!0}if("number"==typeof w){if(b[_]!==w)return b[_]=w,!0}else{const M=Array.isArray(b[_])?b[_]:[b[_]],C=Array.isArray(w)?w:[w];for(let x=0;x<M.length;x++){const S=M[x];if(!1===S.equals(C[x]))return S.copy(C[x]),!0}}return!1}function m(v){const _={boundary:0,storage:0};return"number"==typeof v?(_.boundary=4,_.storage=4):v.isVector2?(_.boundary=8,_.storage=8):v.isVector3||v.isColor?(_.boundary=16,_.storage=12):v.isVector4?(_.boundary=16,_.storage=16):v.isMatrix3?(_.boundary=48,_.storage=48):v.isMatrix4?(_.boundary=64,_.storage=64):v.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",v),_}function g(v){const _=v.target;_.removeEventListener("dispose",g);const b=o.indexOf(_.__bindingPointIndex);o.splice(b,1),n.deleteBuffer(r[_.id]),delete r[_.id],delete s[_.id]}return{bind:function l(v,_){i.uniformBlockBinding(v,_.program)},update:function c(v,_){let b=r[v.id];void 0===b&&(function p(v){const _=v.uniforms;let b=0;let M=0;for(let C=0,x=_.length;C<x;C++){const S=_[C],I={boundary:0,storage:0},L=Array.isArray(S.value)?S.value:[S.value];for(let k=0,P=L.length;k<P;k++){const j=m(L[k]);I.boundary+=j.boundary,I.storage+=j.storage}S.__data=new Float32Array(I.storage/Float32Array.BYTES_PER_ELEMENT),S.__offset=b,C>0&&(M=b%16,0!==M&&16-M-I.boundary<0&&(b+=16-M,S.__offset=b)),b+=I.storage}M=b%16,M>0&&(b+=16-M),v.__size=b,v.__cache={}}(v),b=function u(v){const _=function d(){for(let v=0;v<a;v++)if(-1===o.indexOf(v))return o.push(v),v;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();v.__bindingPointIndex=_;const b=n.createBuffer(),w=v.__size,M=v.usage;return n.bindBuffer(35345,b),n.bufferData(35345,w,M),n.bindBuffer(35345,null),n.bindBufferBase(35345,_,b),b}(v),r[v.id]=b,v.addEventListener("dispose",g)),i.updateUBOMapping(v,_.program);const M=e.render.frame;s[v.id]!==M&&(function h(v){const b=v.uniforms,w=v.__cache;n.bindBuffer(35345,r[v.id]);for(let M=0,C=b.length;M<C;M++){const x=b[M];if(!0===f(x,M,w)){const S=x.__offset,I=Array.isArray(x.value)?x.value:[x.value];let L=0;for(let k=0;k<I.length;k++){const P=I[k],R=m(P);"number"==typeof P?(x.__data[0]=P,n.bufferSubData(35345,S+L,x.__data)):P.isMatrix3?(x.__data[0]=P.elements[0],x.__data[1]=P.elements[1],x.__data[2]=P.elements[2],x.__data[3]=P.elements[0],x.__data[4]=P.elements[3],x.__data[5]=P.elements[4],x.__data[6]=P.elements[5],x.__data[7]=P.elements[0],x.__data[8]=P.elements[6],x.__data[9]=P.elements[7],x.__data[10]=P.elements[8],x.__data[11]=P.elements[0]):(P.toArray(x.__data,L),L+=R.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(35345,S,x.__data)}}n.bindBuffer(35345,null)}(v),s[v.id]=M)},dispose:function y(){for(const v in r)n.deleteBuffer(r[v]);o=[],r={},s={}}}}function Wp(n={}){this.isWebGLRenderer=!0;const e=void 0!==n.canvas?n.canvas:function I7(){const n=Zu("canvas");return n.style.display="block",n}(),t=void 0!==n.context?n.context:null,i=void 0===n.depth||n.depth,r=void 0===n.stencil||n.stencil,s=void 0!==n.antialias&&n.antialias,o=void 0===n.premultipliedAlpha||n.premultipliedAlpha,a=void 0!==n.preserveDrawingBuffer&&n.preserveDrawingBuffer,l=void 0!==n.powerPreference?n.powerPreference:"default",c=void 0!==n.failIfMajorPerformanceCaveat&&n.failIfMajorPerformanceCaveat;let u;u=null!==t?t.getContextAttributes().alpha:void 0!==n.alpha&&n.alpha;let d=null,h=null;const f=[],p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=gs,this.physicallyCorrectLights=!1,this.toneMapping=vr,this.toneMappingExposure=1;const m=this;let g=!1,y=0,v=0,_=null,b=-1,w=null;const M=new Rt,C=new Rt;let x=null,S=e.width,I=e.height,L=1,k=null,P=null;const R=new Rt(0,0,S,I),j=new Rt(0,0,S,I);let O=!1;const G=new Up;let N=!1,$=!1,Y=null;const pe=new He,B=new ee,te=new D,ne={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ce(){return null===_?L:1}let _e,be,le,qe,Q,J,de,Ae,ge,Ye,Be,Re,$t,Pt,T,E,W,ae,ue,xe,Ge,we,Z,Pe,z=t;function ve(A,H){for(let X=0;X<A.length;X++){const K=e.getContext(A[X],H);if(null!==K)return K}return null}try{const A={alpha:!0,depth:i,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${op}`),e.addEventListener("webglcontextlost",Ve,!1),e.addEventListener("webglcontextrestored",Fe,!1),e.addEventListener("webglcontextcreationerror",yt,!1),null===z){const H=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&H.shift(),z=ve(H,A),null===z)throw ve(H)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===z.getShaderPrecisionFormat&&(z.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(A){throw console.error("THREE.WebGLRenderer: "+A.message),A}function Ue(){_e=new $9(z),be=new U9(z,_e,n),_e.init(be),we=new wR(z,_e,be),le=new S7(z,_e,be),qe=new Y9,Q=new h7,J=new E7(z,_e,le,Q,be,we,qe),de=new H9(m),Ae=new W9(m),ge=new B6(z,be),Z=new B9(z,_e,ge,be),Ye=new q9(z,ge,qe,Z),Be=new Q9(z,Ye,ge,qe),ue=new J9(z,be,J),E=new z9(Q),Re=new d7(m,de,Ae,_e,be,Z,E),$t=new A7(m,Q),Pt=new p7,T=new b7(_e,be),ae=new k9(m,de,Ae,le,Be,u,o),W=new M7(m,Be,be),Pe=new T7(z,qe,be,le),xe=new V9(z,_e,qe,be),Ge=new X9(z,_e,qe,be),qe.programs=Re.programs,m.capabilities=be,m.extensions=_e,m.properties=Q,m.renderLists=Pt,m.shadowMap=W,m.state=le,m.info=qe}Ue();const Te=new D7(m,z);function Ve(A){A.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function Fe(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const A=qe.autoReset,H=W.enabled,X=W.autoUpdate,V=W.needsUpdate,K=W.type;Ue(),qe.autoReset=A,W.enabled=H,W.autoUpdate=X,W.needsUpdate=V,W.type=K}function yt(A){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",A.statusMessage)}function Xt(A){const H=A.target;H.removeEventListener("dispose",Xt),function Ln(A){(function F(A){const H=Q.get(A).programs;void 0!==H&&(H.forEach(function(X){Re.releaseProgram(X)}),A.isShaderMaterial&&Re.releaseShaderCache(A))})(A),Q.remove(A)}(H)}this.xr=Te,this.getContext=function(){return z},this.getContextAttributes=function(){return z.getContextAttributes()},this.forceContextLoss=function(){const A=_e.get("WEBGL_lose_context");A&&A.loseContext()},this.forceContextRestore=function(){const A=_e.get("WEBGL_lose_context");A&&A.restoreContext()},this.getPixelRatio=function(){return L},this.setPixelRatio=function(A){void 0!==A&&(L=A,this.setSize(S,I,!1))},this.getSize=function(A){return A.set(S,I)},this.setSize=function(A,H,X){Te.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(S=A,I=H,e.width=Math.floor(A*L),e.height=Math.floor(H*L),!1!==X&&(e.style.width=A+"px",e.style.height=H+"px"),this.setViewport(0,0,A,H))},this.getDrawingBufferSize=function(A){return A.set(S*L,I*L).floor()},this.setDrawingBufferSize=function(A,H,X){S=A,I=H,L=X,e.width=Math.floor(A*X),e.height=Math.floor(H*X),this.setViewport(0,0,A,H)},this.getCurrentViewport=function(A){return A.copy(M)},this.getViewport=function(A){return A.copy(R)},this.setViewport=function(A,H,X,V){A.isVector4?R.set(A.x,A.y,A.z,A.w):R.set(A,H,X,V),le.viewport(M.copy(R).multiplyScalar(L).floor())},this.getScissor=function(A){return A.copy(j)},this.setScissor=function(A,H,X,V){A.isVector4?j.set(A.x,A.y,A.z,A.w):j.set(A,H,X,V),le.scissor(C.copy(j).multiplyScalar(L).floor())},this.getScissorTest=function(){return O},this.setScissorTest=function(A){le.setScissorTest(O=A)},this.setOpaqueSort=function(A){k=A},this.setTransparentSort=function(A){P=A},this.getClearColor=function(A){return A.copy(ae.getClearColor())},this.setClearColor=function(){ae.setClearColor.apply(ae,arguments)},this.getClearAlpha=function(){return ae.getClearAlpha()},this.setClearAlpha=function(){ae.setClearAlpha.apply(ae,arguments)},this.clear=function(A=!0,H=!0,X=!0){let V=0;A&&(V|=16384),H&&(V|=256),X&&(V|=1024),z.clear(V)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Ve,!1),e.removeEventListener("webglcontextrestored",Fe,!1),e.removeEventListener("webglcontextcreationerror",yt,!1),Pt.dispose(),T.dispose(),Q.dispose(),de.dispose(),Ae.dispose(),Be.dispose(),Z.dispose(),Pe.dispose(),Re.dispose(),Te.dispose(),Te.removeEventListener("sessionstart",Se),Te.removeEventListener("sessionend",Ie),Y&&(Y.dispose(),Y=null),At.stop()},this.renderBufferDirect=function(A,H,X,V,K,Le){null===H&&(H=ne);const Ke=K.isMesh&&K.matrixWorld.determinant()<0,nt=function Oee(A,H,X,V,K){!0!==H.isScene&&(H=ne),J.resetTextureUnits();const Le=H.fog,nt=null===_?m.outputEncoding:!0===_.isXRRenderTarget?_.texture.encoding:gs,rt=(V.isMeshStandardMaterial?Ae:de).get(V.envMap||(V.isMeshStandardMaterial?H.environment:null)),vt=!0===V.vertexColors&&!!X.attributes.color&&4===X.attributes.color.itemSize,dt=!!V.normalMap&&!!X.attributes.tangent,ht=!!X.morphAttributes.position,bn=!!X.morphAttributes.normal,Vi=!!X.morphAttributes.color,Ps=V.toneMapped?m.toneMapping:vr,Pa=X.morphAttributes.position||X.morphAttributes.normal||X.morphAttributes.color,xn=void 0!==Pa?Pa.length:0,ft=Q.get(V),uw=h.state.lights;!0!==N||!0!==$&&A===w||E.setState(V,A,A===w&&V.id===b);let kn=!1;V.version===ft.__version?(ft.needsLights&&ft.lightsStateVersion!==uw.state.version||ft.outputEncoding!==nt||K.isInstancedMesh&&!1===ft.instancing||!K.isInstancedMesh&&!0===ft.instancing||K.isSkinnedMesh&&!1===ft.skinning||!K.isSkinnedMesh&&!0===ft.skinning||ft.envMap!==rt||!0===V.fog&&ft.fog!==Le||void 0!==ft.numClippingPlanes&&(ft.numClippingPlanes!==E.numPlanes||ft.numIntersection!==E.numIntersection)||ft.vertexAlphas!==vt||ft.vertexTangents!==dt||ft.morphTargets!==ht||ft.morphNormals!==bn||ft.morphColors!==Vi||ft.toneMapping!==Ps||!0===be.isWebGL2&&ft.morphTargetsCount!==xn)&&(kn=!0):(kn=!0,ft.__version=V.version);let Fa=ft.currentProgram;!0===kn&&(Fa=or(V,H,K));let wL=!1,eh=!1,dw=!1;const fi=Fa.getUniforms(),Oa=ft.uniforms;if(le.useProgram(Fa.program)&&(wL=!0,eh=!0,dw=!0),V.id!==b&&(b=V.id,eh=!0),wL||w!==A){if(fi.setValue(z,"projectionMatrix",A.projectionMatrix),be.logarithmicDepthBuffer&&fi.setValue(z,"logDepthBufFC",2/(Math.log(A.far+1)/Math.LN2)),w!==A&&(w=A,eh=!0,dw=!0),V.isShaderMaterial||V.isMeshPhongMaterial||V.isMeshToonMaterial||V.isMeshStandardMaterial||V.envMap){const Ui=fi.map.cameraPosition;void 0!==Ui&&Ui.setValue(z,te.setFromMatrixPosition(A.matrixWorld))}(V.isMeshPhongMaterial||V.isMeshToonMaterial||V.isMeshLambertMaterial||V.isMeshBasicMaterial||V.isMeshStandardMaterial||V.isShaderMaterial)&&fi.setValue(z,"isOrthographic",!0===A.isOrthographicCamera),(V.isMeshPhongMaterial||V.isMeshToonMaterial||V.isMeshLambertMaterial||V.isMeshBasicMaterial||V.isMeshStandardMaterial||V.isShaderMaterial||V.isShadowMaterial||K.isSkinnedMesh)&&fi.setValue(z,"viewMatrix",A.matrixWorldInverse)}if(K.isSkinnedMesh){fi.setOptional(z,K,"bindMatrix"),fi.setOptional(z,K,"bindMatrixInverse");const Ui=K.skeleton;Ui&&(be.floatVertexTextures?(null===Ui.boneTexture&&Ui.computeBoneTexture(),fi.setValue(z,"boneTexture",Ui.boneTexture,J),fi.setValue(z,"boneTextureSize",Ui.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const hw=X.morphAttributes;if((void 0!==hw.position||void 0!==hw.normal||void 0!==hw.color&&!0===be.isWebGL2)&&ue.update(K,X,V,Fa),(eh||ft.receiveShadow!==K.receiveShadow)&&(ft.receiveShadow=K.receiveShadow,fi.setValue(z,"receiveShadow",K.receiveShadow)),V.isMeshGouraudMaterial&&null!==V.envMap&&(Oa.envMap.value=rt,Oa.flipEnvMap.value=rt.isCubeTexture&&!1===rt.isRenderTargetTexture?-1:1),eh&&(fi.setValue(z,"toneMappingExposure",m.toneMappingExposure),ft.needsLights&&function Lee(A,H){A.ambientLightColor.needsUpdate=H,A.lightProbe.needsUpdate=H,A.directionalLights.needsUpdate=H,A.directionalLightShadows.needsUpdate=H,A.pointLights.needsUpdate=H,A.pointLightShadows.needsUpdate=H,A.spotLights.needsUpdate=H,A.spotLightShadows.needsUpdate=H,A.rectAreaLights.needsUpdate=H,A.hemisphereLights.needsUpdate=H}(Oa,dw),Le&&!0===V.fog&&$t.refreshFogUniforms(Oa,Le),$t.refreshMaterialUniforms(Oa,V,L,I,Y),jp.upload(z,ft.uniformsList,Oa,J)),V.isShaderMaterial&&!0===V.uniformsNeedUpdate&&(jp.upload(z,ft.uniformsList,Oa,J),V.uniformsNeedUpdate=!1),V.isSpriteMaterial&&fi.setValue(z,"center",K.center),fi.setValue(z,"modelViewMatrix",K.modelViewMatrix),fi.setValue(z,"normalMatrix",K.normalMatrix),fi.setValue(z,"modelMatrix",K.matrixWorld),V.isShaderMaterial||V.isRawShaderMaterial){const Ui=V.uniformsGroups;for(let fw=0,kee=Ui.length;fw<kee;fw++)if(be.isWebGL2){const ML=Ui[fw];Pe.update(ML,Fa),Pe.bind(ML,Fa)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Fa}(A,H,X,V,K);le.setMaterial(V,Ke);let rt=X.index,vt=1;!0===V.wireframe&&(rt=Ye.getWireframeAttribute(X),vt=2);const dt=X.drawRange,ht=X.attributes.position;let bn=dt.start*vt,Vi=(dt.start+dt.count)*vt;null!==Le&&(bn=Math.max(bn,Le.start*vt),Vi=Math.min(Vi,(Le.start+Le.count)*vt)),null!==rt?(bn=Math.max(bn,0),Vi=Math.min(Vi,rt.count)):null!=ht&&(bn=Math.max(bn,0),Vi=Math.min(Vi,ht.count));const Ps=Vi-bn;if(Ps<0||Ps===1/0)return;Z.setup(K,V,nt,X,rt);let Pa,xn=xe;if(null!==rt&&(Pa=ge.get(rt),xn=Ge,xn.setIndex(Pa)),K.isMesh)!0===V.wireframe?(le.setLineWidth(V.wireframeLinewidth*ce()),xn.setMode(1)):xn.setMode(4);else if(K.isLine){let ft=V.linewidth;void 0===ft&&(ft=1),le.setLineWidth(ft*ce()),xn.setMode(K.isLineSegments?1:K.isLineLoop?2:3)}else K.isPoints?xn.setMode(0):K.isSprite&&xn.setMode(4);if(K.isInstancedMesh)xn.renderInstances(bn,Ps,K.count);else if(X.isInstancedBufferGeometry){const uw=Math.min(X.instanceCount,void 0!==X._maxInstanceCount?X._maxInstanceCount:1/0);xn.renderInstances(bn,Ps,uw)}else xn.render(bn,Ps)},this.compile=function(A,H){function X(V,K,Le){!0===V.transparent&&V.side===Wr&&!1===V.forceSinglePass?(V.side=xi,V.needsUpdate=!0,or(V,K,Le),V.side=jr,V.needsUpdate=!0,or(V,K,Le),V.side=Wr):or(V,K,Le)}h=T.get(A),h.init(),p.push(h),A.traverseVisible(function(V){V.isLight&&V.layers.test(H.layers)&&(h.pushLight(V),V.castShadow&&h.pushShadow(V))}),h.setupLights(m.physicallyCorrectLights),A.traverse(function(V){const K=V.material;if(K)if(Array.isArray(K))for(let Le=0;Le<K.length;Le++)X(K[Le],A,V);else X(K,A,V)}),p.pop(),h=null};let q=null;function Se(){At.stop()}function Ie(){At.start()}const At=new KI;function Nn(A,H,X,V){if(!1===A.visible)return;if(A.layers.test(H.layers))if(A.isGroup)X=A.renderOrder;else if(A.isLOD)!0===A.autoUpdate&&A.update(H);else if(A.isLight)h.pushLight(A),A.castShadow&&h.pushShadow(A);else if(A.isSprite){if(!A.frustumCulled||G.intersectsSprite(A)){V&&te.setFromMatrixPosition(A.matrixWorld).applyMatrix4(pe);const Ke=Be.update(A),nt=A.material;nt.visible&&d.push(A,Ke,nt,X,te.z,null)}}else if((A.isMesh||A.isLine||A.isPoints)&&(A.isSkinnedMesh&&A.skeleton.frame!==qe.render.frame&&(A.skeleton.update(),A.skeleton.frame=qe.render.frame),!A.frustumCulled||G.intersectsObject(A))){V&&te.setFromMatrixPosition(A.matrixWorld).applyMatrix4(pe);const Ke=Be.update(A),nt=A.material;if(Array.isArray(nt)){const rt=Ke.groups;for(let vt=0,dt=rt.length;vt<dt;vt++){const ht=rt[vt],bn=nt[ht.materialIndex];bn&&bn.visible&&d.push(A,Ke,bn,X,te.z,ht)}}else nt.visible&&d.push(A,Ke,nt,X,te.z,null)}const Le=A.children;for(let Ke=0,nt=Le.length;Ke<nt;Ke++)Nn(Le[Ke],H,X,V)}function ti(A,H,X,V){const K=A.opaque,Le=A.transmissive,Ke=A.transparent;h.setupLightsView(X),!0===N&&E.setGlobalState(m.clippingPlanes,X),Le.length>0&&function Ra(A,H,X){const V=be.isWebGL2;null===Y&&(Y=new wr(1,1,{generateMipmaps:!0,type:_e.has("EXT_color_buffer_half_float")?kl:Ks,minFilter:$r,samples:V&&!0===s?4:0})),m.getDrawingBufferSize(B),V?Y.setSize(B.x,B.y):Y.setSize(bp(B.x),bp(B.y));const K=m.getRenderTarget();m.setRenderTarget(Y),m.clear();const Le=m.toneMapping;m.toneMapping=vr,Yt(A,H,X),m.toneMapping=Le,J.updateMultisampleRenderTarget(Y),J.updateRenderTargetMipmap(Y),m.setRenderTarget(K)}(K,H,X),V&&le.viewport(M.copy(V)),K.length>0&&Yt(K,H,X),Le.length>0&&Yt(Le,H,X),Ke.length>0&&Yt(Ke,H,X),le.buffers.depth.setTest(!0),le.buffers.depth.setMask(!0),le.buffers.color.setMask(!0),le.setPolygonOffset(!1)}function Yt(A,H,X){const V=!0===H.isScene?H.overrideMaterial:null;for(let K=0,Le=A.length;K<Le;K++){const Ke=A[K],nt=Ke.object,rt=Ke.geometry,vt=null===V?Ke.material:V,dt=Ke.group;nt.layers.test(X.layers)&&Rs(nt,H,X,rt,vt,dt)}}function Rs(A,H,X,V,K,Le){A.onBeforeRender(m,H,X,V,K,Le),A.modelViewMatrix.multiplyMatrices(X.matrixWorldInverse,A.matrixWorld),A.normalMatrix.getNormalMatrix(A.modelViewMatrix),K.onBeforeRender(m,H,X,V,A,Le),!0===K.transparent&&K.side===Wr&&!1===K.forceSinglePass?(K.side=xi,K.needsUpdate=!0,m.renderBufferDirect(X,H,V,K,A,Le),K.side=jr,K.needsUpdate=!0,m.renderBufferDirect(X,H,V,K,A,Le),K.side=Wr):m.renderBufferDirect(X,H,V,K,A,Le),A.onAfterRender(m,H,X,V,K,Le)}function or(A,H,X){!0!==H.isScene&&(H=ne);const V=Q.get(A),K=h.state.lights,Ke=K.state.version,nt=Re.getParameters(A,K.state,h.state.shadowsArray,H,X),rt=Re.getProgramCacheKey(nt);let vt=V.programs;V.environment=A.isMeshStandardMaterial?H.environment:null,V.fog=H.fog,V.envMap=(A.isMeshStandardMaterial?Ae:de).get(A.envMap||V.environment),void 0===vt&&(A.addEventListener("dispose",Xt),vt=new Map,V.programs=vt);let dt=vt.get(rt);if(void 0!==dt){if(V.currentProgram===dt&&V.lightsStateVersion===Ke)return xL(A,nt),dt}else nt.uniforms=Re.getUniforms(A),A.onBuild(X,nt,m),A.onBeforeCompile(nt,m),dt=Re.acquireProgram(nt,rt),vt.set(rt,dt),V.uniforms=nt.uniforms;const ht=V.uniforms;(!A.isShaderMaterial&&!A.isRawShaderMaterial||!0===A.clipping)&&(ht.clippingPlanes=E.uniform),xL(A,nt),V.needsLights=function Nee(A){return A.isMeshLambertMaterial||A.isMeshToonMaterial||A.isMeshPhongMaterial||A.isMeshStandardMaterial||A.isShadowMaterial||A.isShaderMaterial&&!0===A.lights}(A),V.lightsStateVersion=Ke,V.needsLights&&(ht.ambientLightColor.value=K.state.ambient,ht.lightProbe.value=K.state.probe,ht.directionalLights.value=K.state.directional,ht.directionalLightShadows.value=K.state.directionalShadow,ht.spotLights.value=K.state.spot,ht.spotLightShadows.value=K.state.spotShadow,ht.rectAreaLights.value=K.state.rectArea,ht.ltc_1.value=K.state.rectAreaLTC1,ht.ltc_2.value=K.state.rectAreaLTC2,ht.pointLights.value=K.state.point,ht.pointLightShadows.value=K.state.pointShadow,ht.hemisphereLights.value=K.state.hemi,ht.directionalShadowMap.value=K.state.directionalShadowMap,ht.directionalShadowMatrix.value=K.state.directionalShadowMatrix,ht.spotShadowMap.value=K.state.spotShadowMap,ht.spotLightMatrix.value=K.state.spotLightMatrix,ht.spotLightMap.value=K.state.spotLightMap,ht.pointShadowMap.value=K.state.pointShadowMap,ht.pointShadowMatrix.value=K.state.pointShadowMatrix);const bn=dt.getUniforms(),Vi=jp.seqWithValue(bn.seq,ht);return V.currentProgram=dt,V.uniformsList=Vi,dt}function xL(A,H){const X=Q.get(A);X.outputEncoding=H.outputEncoding,X.instancing=H.instancing,X.skinning=H.skinning,X.morphTargets=H.morphTargets,X.morphNormals=H.morphNormals,X.morphColors=H.morphColors,X.morphTargetsCount=H.morphTargetsCount,X.numClippingPlanes=H.numClippingPlanes,X.numIntersection=H.numClipIntersection,X.vertexAlphas=H.vertexAlphas,X.vertexTangents=H.vertexTangents,X.toneMapping=H.toneMapping}At.setAnimationLoop(function oe(A){q&&q(A)}),typeof self<"u"&&At.setContext(self),this.setAnimationLoop=function(A){q=A,Te.setAnimationLoop(A),null===A?At.stop():At.start()},Te.addEventListener("sessionstart",Se),Te.addEventListener("sessionend",Ie),this.render=function(A,H){if(void 0===H||!0===H.isCamera){if(!0!==g){if(!0===A.matrixWorldAutoUpdate&&A.updateMatrixWorld(),null===H.parent&&!0===H.matrixWorldAutoUpdate&&H.updateMatrixWorld(),!0===Te.enabled&&!0===Te.isPresenting&&(!0===Te.cameraAutoUpdate&&Te.updateCamera(H),H=Te.getCamera()),!0===A.isScene&&A.onBeforeRender(m,A,H,_),h=T.get(A,p.length),h.init(),p.push(h),pe.multiplyMatrices(H.projectionMatrix,H.matrixWorldInverse),G.setFromProjectionMatrix(pe),$=this.localClippingEnabled,N=E.init(this.clippingPlanes,$),d=Pt.get(A,f.length),d.init(),f.push(d),Nn(A,H,0,m.sortObjects),d.finish(),!0===m.sortObjects&&d.sort(k,P),!0===N&&E.beginShadows(),W.render(h.state.shadowsArray,A,H),!0===N&&E.endShadows(),!0===this.info.autoReset&&this.info.reset(),ae.render(d,A),h.setupLights(m.physicallyCorrectLights),H.isArrayCamera){const V=H.cameras;for(let K=0,Le=V.length;K<Le;K++){const Ke=V[K];ti(d,A,Ke,Ke.viewport)}}else ti(d,A,H);null!==_&&(J.updateMultisampleRenderTarget(_),J.updateRenderTargetMipmap(_)),!0===A.isScene&&A.onAfterRender(m,A,H),Z.resetDefaultState(),b=-1,w=null,p.pop(),h=p.length>0?p[p.length-1]:null,f.pop(),d=f.length>0?f[f.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return v},this.getRenderTarget=function(){return _},this.setRenderTargetTextures=function(A,H,X){Q.get(A.texture).__webglTexture=H,Q.get(A.depthTexture).__webglTexture=X;const V=Q.get(A);V.__hasExternalTextures=!0,V.__hasExternalTextures&&(V.__autoAllocateDepthBuffer=void 0===X,V.__autoAllocateDepthBuffer||!0===_e.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),V.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(A,H){const X=Q.get(A);X.__webglFramebuffer=H,X.__useDefaultFramebuffer=void 0===H},this.setRenderTarget=function(A,H=0,X=0){_=A,y=H,v=X;let V=!0,K=null,Le=!1,Ke=!1;if(A){const rt=Q.get(A);void 0!==rt.__useDefaultFramebuffer?(le.bindFramebuffer(36160,null),V=!1):void 0===rt.__webglFramebuffer?J.setupRenderTarget(A):rt.__hasExternalTextures&&J.rebindTextures(A,Q.get(A.texture).__webglTexture,Q.get(A.depthTexture).__webglTexture);const vt=A.texture;(vt.isData3DTexture||vt.isDataArrayTexture||vt.isCompressedArrayTexture)&&(Ke=!0);const dt=Q.get(A).__webglFramebuffer;A.isWebGLCubeRenderTarget?(K=dt[H],Le=!0):K=be.isWebGL2&&A.samples>0&&!1===J.useMultisampledRTT(A)?Q.get(A).__webglMultisampledFramebuffer:dt,M.copy(A.viewport),C.copy(A.scissor),x=A.scissorTest}else M.copy(R).multiplyScalar(L).floor(),C.copy(j).multiplyScalar(L).floor(),x=O;if(le.bindFramebuffer(36160,K)&&be.drawBuffers&&V&&le.drawBuffers(A,K),le.viewport(M),le.scissor(C),le.setScissorTest(x),Le){const rt=Q.get(A.texture);z.framebufferTexture2D(36160,36064,34069+H,rt.__webglTexture,X)}else if(Ke){const rt=Q.get(A.texture);z.framebufferTextureLayer(36160,36064,rt.__webglTexture,X||0,H||0)}b=-1},this.readRenderTargetPixels=function(A,H,X,V,K,Le,Ke){if(!A||!A.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let nt=Q.get(A).__webglFramebuffer;if(A.isWebGLCubeRenderTarget&&void 0!==Ke&&(nt=nt[Ke]),nt){le.bindFramebuffer(36160,nt);try{const rt=A.texture,vt=rt.format,dt=rt.type;if(vt!==Pi&&we.convert(vt)!==z.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ht=dt===kl&&(_e.has("EXT_color_buffer_half_float")||be.isWebGL2&&_e.has("EXT_color_buffer_float"));if(!(dt===Ks||we.convert(dt)===z.getParameter(35738)||dt===ms&&(be.isWebGL2||_e.has("OES_texture_float")||_e.has("WEBGL_color_buffer_float"))||ht))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");H>=0&&H<=A.width-V&&X>=0&&X<=A.height-K&&z.readPixels(H,X,V,K,we.convert(vt),we.convert(dt),Le)}finally{const rt=null!==_?Q.get(_).__webglFramebuffer:null;le.bindFramebuffer(36160,rt)}}},this.copyFramebufferToTexture=function(A,H,X=0){const V=Math.pow(2,-X),K=Math.floor(H.image.width*V),Le=Math.floor(H.image.height*V);J.setTexture2D(H,0),z.copyTexSubImage2D(3553,X,0,0,A.x,A.y,K,Le),le.unbindTexture()},this.copyTextureToTexture=function(A,H,X,V=0){const K=H.image.width,Le=H.image.height,Ke=we.convert(X.format),nt=we.convert(X.type);J.setTexture2D(X,0),z.pixelStorei(37440,X.flipY),z.pixelStorei(37441,X.premultiplyAlpha),z.pixelStorei(3317,X.unpackAlignment),H.isDataTexture?z.texSubImage2D(3553,V,A.x,A.y,K,Le,Ke,nt,H.image.data):H.isCompressedTexture?z.compressedTexSubImage2D(3553,V,A.x,A.y,H.mipmaps[0].width,H.mipmaps[0].height,Ke,H.mipmaps[0].data):z.texSubImage2D(3553,V,A.x,A.y,Ke,nt,H.image),0===V&&X.generateMipmaps&&z.generateMipmap(3553),le.unbindTexture()},this.copyTextureToTexture3D=function(A,H,X,V,K=0){if(m.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Le=A.max.x-A.min.x+1,Ke=A.max.y-A.min.y+1,nt=A.max.z-A.min.z+1,rt=we.convert(V.format),vt=we.convert(V.type);let dt;if(V.isData3DTexture)J.setTexture3D(V,0),dt=32879;else{if(!V.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");J.setTexture2DArray(V,0),dt=35866}z.pixelStorei(37440,V.flipY),z.pixelStorei(37441,V.premultiplyAlpha),z.pixelStorei(3317,V.unpackAlignment);const ht=z.getParameter(3314),bn=z.getParameter(32878),Vi=z.getParameter(3316),Ps=z.getParameter(3315),Pa=z.getParameter(32877),xn=X.isCompressedTexture?X.mipmaps[0]:X.image;z.pixelStorei(3314,xn.width),z.pixelStorei(32878,xn.height),z.pixelStorei(3316,A.min.x),z.pixelStorei(3315,A.min.y),z.pixelStorei(32877,A.min.z),X.isDataTexture||X.isData3DTexture?z.texSubImage3D(dt,K,H.x,H.y,H.z,Le,Ke,nt,rt,vt,xn.data):X.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),z.compressedTexSubImage3D(dt,K,H.x,H.y,H.z,Le,Ke,nt,rt,xn.data)):z.texSubImage3D(dt,K,H.x,H.y,H.z,Le,Ke,nt,rt,vt,xn),z.pixelStorei(3314,ht),z.pixelStorei(32878,bn),z.pixelStorei(3316,Vi),z.pixelStorei(3315,Ps),z.pixelStorei(32877,Pa),0===K&&V.generateMipmaps&&z.generateMipmap(dt),le.unbindTexture()},this.initTexture=function(A){A.isCubeTexture?J.setTextureCube(A,0):A.isData3DTexture?J.setTexture3D(A,0):A.isDataArrayTexture||A.isCompressedArrayTexture?J.setTexture2DArray(A,0):J.setTexture2D(A,0),le.unbindTexture()},this.resetState=function(){y=0,v=0,_=null,le.reset(),Z.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class ER extends Wp{}ER.prototype.isWebGL1Renderer=!0;class $p{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new me(e),this.density=t}clone(){return new $p(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class qp{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new me(e),this.near=t,this.far=i}clone(){return new qp(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class Xp extends Vt{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class ld{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Xu,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Fi()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Fi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Fi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const di=new D;class lo{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)di.fromBufferAttribute(this,t),di.applyMatrix4(e),this.setXYZ(t,di.x,di.y,di.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)di.fromBufferAttribute(this,t),di.applyNormalMatrix(e),this.setXYZ(t,di.x,di.y,di.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)di.fromBufferAttribute(this,t),di.transformDirection(e),this.setXYZ(t,di.x,di.y,di.z);return this}setX(e,t){return this.normalized&&(t=Bt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Bt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Bt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Bt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ys(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ys(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ys(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ys(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Bt(t,this.array),i=Bt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Bt(t,this.array),i=Bt(i,this.array),r=Bt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Bt(t,this.array),i=Bt(i,this.array),r=Bt(r,this.array),s=Bt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Dt(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new lo(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class l0 extends Dn{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new me(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let oc;const cd=new D,ac=new D,lc=new D,cc=new ee,ud=new ee,CR=new He,Yp=new D,dd=new D,Kp=new D,DR=new ee,c0=new ee,AR=new ee;class TR extends Vt{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",void 0===oc){oc=new et;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new ld(t,5);oc.setIndex([0,1,2,0,2,3]),oc.setAttribute("position",new lo(i,3,0,!1)),oc.setAttribute("uv",new lo(i,2,3,!1))}this.geometry=oc,this.material=void 0!==e?e:new l0,this.center=new ee(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ac.setFromMatrixScale(this.matrixWorld),CR.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),lc.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&ac.multiplyScalar(-lc.z);const i=this.material.rotation;let r,s;0!==i&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;Zp(Yp.set(-.5,-.5,0),lc,o,ac,r,s),Zp(dd.set(.5,-.5,0),lc,o,ac,r,s),Zp(Kp.set(.5,.5,0),lc,o,ac,r,s),DR.set(0,0),c0.set(1,0),AR.set(1,1);let a=e.ray.intersectTriangle(Yp,dd,Kp,!1,cd);if(null===a&&(Zp(dd.set(-.5,.5,0),lc,o,ac,r,s),c0.set(0,1),a=e.ray.intersectTriangle(Yp,Kp,dd,!1,cd),null===a))return;const l=e.ray.origin.distanceTo(cd);l<e.near||l>e.far||t.push({distance:l,point:cd.clone(),uv:er.getUV(cd,Yp,dd,Kp,DR,c0,AR,new ee),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function Zp(n,e,t,i,r,s){cc.subVectors(n,t).addScalar(.5).multiply(i),void 0!==r?(ud.x=s*cc.x-r*cc.y,ud.y=r*cc.x+s*cc.y):ud.copy(cc),n.copy(e),n.x+=ud.x,n.y+=ud.y,n.applyMatrix4(CR)}const Jp=new D,IR=new D;class RR extends Vt{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let i=0,r=t.length;i<r;i++){const s=t[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,i=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let i,r;for(i=1,r=t.length;i<r;i++){let s=t[i].distance;if(t[i].object.visible&&(s-=s*t[i].hysteresis),e<s)break}return t[i-1].object}return null}raycast(e,t){if(this.levels.length>0){Jp.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(Jp);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Jp.setFromMatrixPosition(e.matrixWorld),IR.setFromMatrixPosition(this.matrixWorld);const i=Jp.distanceTo(IR)/e.zoom;let r,s;for(t[0].object.visible=!0,r=1,s=t.length;r<s;r++){let o=t[r].distance;if(t[r].object.visible&&(o-=o*t[r].hysteresis),!(i>=o))break;t[r-1].object.visible=!1,t[r].object.visible=!0}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const o=i[r];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const PR=new D,FR=new Rt,OR=new Rt,R7=new D,LR=new He;class u0 extends On{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new He,this.bindMatrixInverse=new He}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Rt,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const i=this.skeleton,r=this.geometry;FR.fromBufferAttribute(r.attributes.skinIndex,e),OR.fromBufferAttribute(r.attributes.skinWeight,e),PR.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=OR.getComponent(s);if(0!==o){const a=FR.getComponent(s);LR.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(R7.copy(PR).applyMatrix4(LR),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Qp extends Vt{constructor(){super(),this.isBone=!0,this.type="Bone"}}class uc extends Hn{constructor(e=null,t=1,i=1,r,s,o,a,l,c=sn,u=sn,d,h){super(null,o,a,l,c,u,r,s,d,h),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const NR=new He,P7=new He;class hd{constructor(e=[],t=[]){this.uuid=Fi(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new He)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new He;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)NR.multiplyMatrices(e[s]?e[s].matrixWorld:P7,t[s]),NR.toArray(i,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new hd(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=PI(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new uc(t,e,e,Pi,ms);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new Qp),this.bones.push(o),this.boneInverses.push((new He).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class dc extends Dt{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const kR=new He,BR=new He,em=[],F7=new He,fd=new On;class d0 extends On{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new dc(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1;for(let r=0;r<i;r++)this.setMatrixAt(r,F7)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(fd.geometry=this.geometry,fd.material=this.material,void 0!==fd.material)for(let s=0;s<r;s++){this.getMatrixAt(s,kR),BR.multiplyMatrices(i,kR),fd.matrixWorld=BR,fd.raycast(e,em);for(let o=0,a=em.length;o<a;o++){const l=em[o];l.instanceId=s,l.object=this,t.push(l)}em.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new dc(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class ei extends Dn{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new me(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const VR=new D,UR=new D,zR=new He,h0=new ed,tm=new io;class Es extends Vt{constructor(e=new et,t=new ei){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)VR.fromBufferAttribute(t,r-1),UR.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=VR.distanceTo(UR);e.setAttribute("lineDistance",new Ee(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),tm.copy(i.boundingSphere),tm.applyMatrix4(r),tm.radius+=s,!1===e.ray.intersectsSphere(tm))return;zR.copy(r).invert(),h0.copy(e.ray).applyMatrix4(zR);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new D,u=new D,d=new D,h=new D,f=this.isLineSegments?2:1,p=i.index,g=i.attributes.position;if(null!==p)for(let _=Math.max(0,o.start),b=Math.min(p.count,o.start+o.count)-1;_<b;_+=f){const w=p.getX(_),M=p.getX(_+1);if(c.fromBufferAttribute(g,w),u.fromBufferAttribute(g,M),h0.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const x=e.ray.origin.distanceTo(h);x<e.near||x>e.far||t.push({distance:x,point:d.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}else for(let _=Math.max(0,o.start),b=Math.min(g.count,o.start+o.count)-1;_<b;_+=f){if(c.fromBufferAttribute(g,_),u.fromBufferAttribute(g,_+1),h0.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(h);M<e.near||M>e.far||t.push({distance:M,point:d.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const HR=new D,GR=new D;class Cr extends Es{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)HR.fromBufferAttribute(t,r),GR.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+HR.distanceTo(GR);e.setAttribute("lineDistance",new Ee(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class f0 extends Es{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class nm extends Dn{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new me(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const jR=new He,p0=new ed,im=new io,rm=new D;class m0 extends Vt{constructor(e=new et,t=new nm){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),im.copy(i.boundingSphere),im.applyMatrix4(r),im.radius+=s,!1===e.ray.intersectsSphere(im))return;jR.copy(r).invert(),p0.copy(e.ray).applyMatrix4(jR);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,d=i.attributes.position;if(null!==c)for(let p=Math.max(0,o.start),m=Math.min(c.count,o.start+o.count);p<m;p++){const g=c.getX(p);rm.fromBufferAttribute(d,g),WR(rm,g,l,r,e,t,this)}else for(let p=Math.max(0,o.start),m=Math.min(d.count,o.start+o.count);p<m;p++)rm.fromBufferAttribute(d,p),WR(rm,p,l,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function WR(n,e,t,i,r,s,o){const a=p0.distanceSqToPoint(n);if(a<t){const l=new D;p0.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class O7 extends Hn{constructor(e,t,i,r,s,o,a,l,c){super(e,t,i,r,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=void 0!==o?o:Jt,this.magFilter=void 0!==s?s:Jt,this.generateMipmaps=!1;const u=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function d(){u.needsUpdate=!0,e.requestVideoFrameCallback(d)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e==0&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class L7 extends Hn{constructor(e,t,i){super({width:e,height:t}),this.isFramebufferTexture=!0,this.format=i,this.magFilter=sn,this.minFilter=sn,this.generateMipmaps=!1,this.needsUpdate=!0}}class g0 extends Hn{constructor(e,t,i,r,s,o,a,l,c,u,d,h){super(null,o,a,l,c,u,r,s,d,h),this.isCompressedTexture=!0,this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class N7 extends g0{constructor(e,t,i,r,s,o){super(e,t,i,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=zn}}class k7 extends Hn{constructor(e,t,i,r,s,o,a,l,c){super(e,t,i,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Dr{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;o=t||e*i[s-1];let c,a=0,l=s-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=i[r]-o,c<0)a=r+1;else{if(!(c>0)){l=r;break}l=r-1}if(r=l,i[r]===o)return r/(s-1);const u=i[r];return(r+(o-u)/(i[r+1]-u))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new ee:new D);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new D,r=[],s=[],o=[],a=new D,l=new He;for(let f=0;f<=e;f++)r[f]=this.getTangentAt(f/e,new D);s[0]=new D,o[0]=new D;let c=Number.MAX_VALUE;const u=Math.abs(r[0].x),d=Math.abs(r[0].y),h=Math.abs(r[0].z);u<=c&&(c=u,i.set(1,0,0)),d<=c&&(c=d,i.set(0,1,0)),h<=c&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(un(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(a,p))}o[f].crossVectors(r[f],s[f])}if(!0===t){let f=Math.acos(un(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(r[p],f*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class sm extends Dr{constructor(e=0,t=0,i=1,r=1,s=0,o=2*Math.PI,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const i=t||new ee,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=o?0:r),!0===this.aClockwise&&!o&&(s===r?s=-r:s-=r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const u=Math.cos(this.aRotation),d=Math.sin(this.aRotation),h=l-this.aX,f=c-this.aY;l=h*u-f*d+this.aX,c=h*d+f*u+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class $R extends sm{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function _0(){let n=0,e=0,t=0,i=0;function r(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,d){let h=(o-s)/c-(a-s)/(c+u)+(a-o)/u,f=(a-o)/u-(l-o)/(u+d)+(l-a)/d;h*=u,f*=u,r(o,a,h,f)},calc:function(s){const o=s*s;return n+e*s+t*o+i*(o*s)}}}const om=new D,y0=new _0,v0=new _0,b0=new _0;class qR extends Dr{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new D){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let c,u,a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:0===l&&a===s-1&&(a=s-2,l=1),this.closed||a>0?c=r[(a-1)%s]:(om.subVectors(r[0],r[1]).add(r[0]),c=om);const d=r[a%s],h=r[(a+1)%s];if(this.closed||a+2<s?u=r[(a+2)%s]:(om.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=om),"centripetal"===this.curveType||"chordal"===this.curveType){const f="chordal"===this.curveType?.5:.25;let p=Math.pow(c.distanceToSquared(d),f),m=Math.pow(d.distanceToSquared(h),f),g=Math.pow(h.distanceToSquared(u),f);m<1e-4&&(m=1),p<1e-4&&(p=m),g<1e-4&&(g=m),y0.initNonuniformCatmullRom(c.x,d.x,h.x,u.x,p,m,g),v0.initNonuniformCatmullRom(c.y,d.y,h.y,u.y,p,m,g),b0.initNonuniformCatmullRom(c.z,d.z,h.z,u.z,p,m,g)}else"catmullrom"===this.curveType&&(y0.initCatmullRom(c.x,d.x,h.x,u.x,this.tension),v0.initCatmullRom(c.y,d.y,h.y,u.y,this.tension),b0.initCatmullRom(c.z,d.z,h.z,u.z,this.tension));return i.set(y0.calc(l),v0.calc(l),b0.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new D).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function XR(n,e,t,i,r){const s=.5*(i-e),o=.5*(r-t),a=n*n;return(2*t-2*i+s+o)*(n*a)+(-3*t+3*i-2*s-o)*a+s*n+t}function pd(n,e,t,i){return function B7(n,e){const t=1-n;return t*t*e}(n,e)+function V7(n,e){return 2*(1-n)*n*e}(n,t)+function U7(n,e){return n*n*e}(n,i)}function md(n,e,t,i,r){return function z7(n,e){const t=1-n;return t*t*t*e}(n,e)+function H7(n,e){const t=1-n;return 3*t*t*n*e}(n,t)+function G7(n,e){return 3*(1-n)*n*n*e}(n,i)+function j7(n,e){return n*n*n*e}(n,r)}class x0 extends Dr{constructor(e=new ee,t=new ee,i=new ee,r=new ee){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new ee){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(md(e,r.x,s.x,o.x,a.x),md(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class YR extends Dr{constructor(e=new D,t=new D,i=new D,r=new D){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new D){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(md(e,r.x,s.x,o.x,a.x),md(e,r.y,s.y,o.y,a.y),md(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class am extends Dr{constructor(e=new ee,t=new ee){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ee){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const i=t||new ee;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class KR extends Dr{constructor(e=new D,t=new D){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new D){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class w0 extends Dr{constructor(e=new ee,t=new ee,i=new ee){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new ee){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(pd(e,r.x,s.x,o.x),pd(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class M0 extends Dr{constructor(e=new D,t=new D,i=new D){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new D){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(pd(e,r.x,s.x,o.x),pd(e,r.y,s.y,o.y),pd(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class S0 extends Dr{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ee){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[0===o?o:o-1],c=r[o],u=r[o>r.length-2?r.length-1:o+1],d=r[o>r.length-3?r.length-1:o+2];return i.set(XR(a,l.x,c.x,u.x,d.x),XR(a,l.y,c.y,u.y,d.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new ee).fromArray(r))}return this}}var E0=Object.freeze({__proto__:null,ArcCurve:$R,CatmullRomCurve3:qR,CubicBezierCurve:x0,CubicBezierCurve3:YR,EllipseCurve:sm,LineCurve:am,LineCurve3:KR,QuadraticBezierCurve:w0,QuadraticBezierCurve3:M0,SplineCurve:S0});class ZR extends Dr{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new am(t,e))}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength();return a.getPointAt(0===l?0:1-o/l,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],l=o.getPoints(o.isEllipseCurve?2*e:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e);for(let c=0;c<l.length;c++){const u=l[c];i&&i.equals(u)||(t.push(u),i=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push((new E0[r.type]).fromJSON(r))}return this}}class gd extends ZR{constructor(e){super(),this.type="Path",this.currentPoint=new ee,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new am(this.currentPoint.clone(),new ee(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new w0(this.currentPoint.clone(),new ee(e,t),new ee(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new x0(this.currentPoint.clone(),new ee(e,t),new ee(i,r),new ee(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new S0(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,l){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o,a,l),this}absellipse(e,t,i,r,s,o,a,l){const c=new sm(e,t,i,r,s,o,a,l);if(this.curves.length>0){const d=c.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class hc extends et{constructor(e=[new ee(0,-.5),new ee(.5,0),new ee(0,.5)],t=12,i=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},t=Math.floor(t),r=un(r,0,2*Math.PI);const s=[],o=[],a=[],l=[],c=[],u=1/t,d=new D,h=new ee,f=new D,p=new D,m=new D;let g=0,y=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:g=e[v+1].x-e[v].x,y=e[v+1].y-e[v].y,f.x=1*y,f.y=-g,f.z=0*y,m.copy(f),f.normalize(),l.push(f.x,f.y,f.z);break;case e.length-1:l.push(m.x,m.y,m.z);break;default:g=e[v+1].x-e[v].x,y=e[v+1].y-e[v].y,f.x=1*y,f.y=-g,f.z=0*y,p.copy(f),f.x+=m.x,f.y+=m.y,f.z+=m.z,f.normalize(),l.push(f.x,f.y,f.z),m.copy(p)}for(let v=0;v<=t;v++){const _=i+v*u*r,b=Math.sin(_),w=Math.cos(_);for(let M=0;M<=e.length-1;M++)d.x=e[M].x*b,d.y=e[M].y,d.z=e[M].x*w,o.push(d.x,d.y,d.z),h.x=v/t,h.y=M/(e.length-1),a.push(h.x,h.y),c.push(l[3*M+0]*b,l[3*M+1],l[3*M+0]*w)}for(let v=0;v<t;v++)for(let _=0;_<e.length-1;_++){const b=_+v*e.length,M=b+e.length,C=b+e.length+1,x=b+1;s.push(b,M,x),s.push(C,x,M)}this.setIndex(s),this.setAttribute("position",new Ee(o,3)),this.setAttribute("uv",new Ee(a,2)),this.setAttribute("normal",new Ee(c,3))}static fromJSON(e){return new hc(e.points,e.segments,e.phiStart,e.phiLength)}}class _d extends hc{constructor(e=1,t=1,i=4,r=8){const s=new gd;s.absarc(0,-t/2,e,1.5*Math.PI,0),s.absarc(0,t/2,e,0,.5*Math.PI),super(s.getPoints(i),r),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:i,radialSegments:r}}static fromJSON(e){return new _d(e.radius,e.length,e.capSegments,e.radialSegments)}}class yd extends et{constructor(e=1,t=32,i=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],l=[],c=new D,u=new ee;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let d=0,h=3;d<=t;d++,h+=3){const f=i+d/t*r;c.x=e*Math.cos(f),c.y=e*Math.sin(f),o.push(c.x,c.y,c.z),a.push(0,0,1),u.x=(o[h]/e+1)/2,u.y=(o[h+1]/e+1)/2,l.push(u.x,u.y)}for(let d=1;d<=t;d++)s.push(d,d+1,0);this.setIndex(s),this.setAttribute("position",new Ee(o,3)),this.setAttribute("normal",new Ee(a,3)),this.setAttribute("uv",new Ee(l,2))}static fromJSON(e){return new yd(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class ha extends et{constructor(e=1,t=1,i=1,r=32,s=1,o=!1,a=0,l=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const u=[],d=[],h=[],f=[];let p=0;const m=[],g=i/2;let y=0;function _(b){const w=p,M=new ee,C=new D;let x=0;const S=!0===b?e:t,I=!0===b?1:-1;for(let k=1;k<=r;k++)d.push(0,g*I,0),h.push(0,I,0),f.push(.5,.5),p++;const L=p;for(let k=0;k<=r;k++){const R=k/r*l+a,j=Math.cos(R),O=Math.sin(R);C.x=S*O,C.y=g*I,C.z=S*j,d.push(C.x,C.y,C.z),h.push(0,I,0),M.x=.5*j+.5,M.y=.5*O*I+.5,f.push(M.x,M.y),p++}for(let k=0;k<r;k++){const P=w+k,R=L+k;!0===b?u.push(R,R+1,P):u.push(R+1,R,P),x+=3}c.addGroup(y,x,!0===b?1:2),y+=x}(function v(){const b=new D,w=new D;let M=0;const C=(t-e)/i;for(let x=0;x<=s;x++){const S=[],I=x/s,L=I*(t-e)+e;for(let k=0;k<=r;k++){const P=k/r,R=P*l+a,j=Math.sin(R),O=Math.cos(R);w.x=L*j,w.y=-I*i+g,w.z=L*O,d.push(w.x,w.y,w.z),b.set(j,C,O).normalize(),h.push(b.x,b.y,b.z),f.push(P,1-I),S.push(p++)}m.push(S)}for(let x=0;x<r;x++)for(let S=0;S<s;S++){const L=m[S+1][x],k=m[S+1][x+1],P=m[S][x+1];u.push(m[S][x],L,P),u.push(L,k,P),M+=6}c.addGroup(y,M,0),y+=M})(),!1===o&&(e>0&&_(!0),t>0&&_(!1)),this.setIndex(u),this.setAttribute("position",new Ee(d,3)),this.setAttribute("normal",new Ee(h,3)),this.setAttribute("uv",new Ee(f,2))}static fromJSON(e){return new ha(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class vd extends ha{constructor(e=1,t=1,i=32,r=1,s=!1,o=0,a=2*Math.PI){super(0,e,t,i,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new vd(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Cs extends et{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const s=[],o=[];function l(v,_,b,w){const M=w+1,C=[];for(let x=0;x<=M;x++){C[x]=[];const S=v.clone().lerp(b,x/M),I=_.clone().lerp(b,x/M),L=M-x;for(let k=0;k<=L;k++)C[x][k]=0===k&&x===M?S:S.clone().lerp(I,k/L)}for(let x=0;x<M;x++)for(let S=0;S<2*(M-x)-1;S++){const I=Math.floor(S/2);S%2==0?(h(C[x][I+1]),h(C[x+1][I]),h(C[x][I])):(h(C[x][I+1]),h(C[x+1][I+1]),h(C[x+1][I]))}}function h(v){s.push(v.x,v.y,v.z)}function f(v,_){const b=3*v;_.x=e[b+0],_.y=e[b+1],_.z=e[b+2]}function m(v,_,b,w){w<0&&1===v.x&&(o[_]=v.x-1),0===b.x&&0===b.z&&(o[_]=w/2/Math.PI+.5)}function g(v){return Math.atan2(v.z,-v.x)}function y(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}(function a(v){const _=new D,b=new D,w=new D;for(let M=0;M<t.length;M+=3)f(t[M+0],_),f(t[M+1],b),f(t[M+2],w),l(_,b,w,v)})(r),function c(v){const _=new D;for(let b=0;b<s.length;b+=3)_.x=s[b+0],_.y=s[b+1],_.z=s[b+2],_.normalize().multiplyScalar(v),s[b+0]=_.x,s[b+1]=_.y,s[b+2]=_.z}(i),function u(){const v=new D;for(let _=0;_<s.length;_+=3){v.x=s[_+0],v.y=s[_+1],v.z=s[_+2];const b=g(v)/2/Math.PI+.5,w=y(v)/Math.PI+.5;o.push(b,1-w)}(function p(){const v=new D,_=new D,b=new D,w=new D,M=new ee,C=new ee,x=new ee;for(let S=0,I=0;S<s.length;S+=9,I+=6){v.set(s[S+0],s[S+1],s[S+2]),_.set(s[S+3],s[S+4],s[S+5]),b.set(s[S+6],s[S+7],s[S+8]),M.set(o[I+0],o[I+1]),C.set(o[I+2],o[I+3]),x.set(o[I+4],o[I+5]),w.copy(v).add(_).add(b).divideScalar(3);const L=g(w);m(M,I+0,v,L),m(C,I+2,_,L),m(x,I+4,b,L)}})(),function d(){for(let v=0;v<o.length;v+=6){const _=o[v+0],b=o[v+2],w=o[v+4],M=Math.max(_,b,w),C=Math.min(_,b,w);M>.9&&C<.1&&(_<.2&&(o[v+0]+=1),b<.2&&(o[v+2]+=1),w<.2&&(o[v+4]+=1))}}()}(),this.setAttribute("position",new Ee(s,3)),this.setAttribute("normal",new Ee(s.slice(),3)),this.setAttribute("uv",new Ee(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new Cs(e.vertices,e.indices,e.radius,e.details)}}class bd extends Cs{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=1/i;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new bd(e.radius,e.detail)}}const lm=new D,cm=new D,C0=new D,um=new er;class JR extends et{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const r=Math.pow(10,4),s=Math.cos(ia*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],u=["a","b","c"],d=new Array(3),h={},f=[];for(let p=0;p<l;p+=3){o?(c[0]=o.getX(p),c[1]=o.getX(p+1),c[2]=o.getX(p+2)):(c[0]=p,c[1]=p+1,c[2]=p+2);const{a:m,b:g,c:y}=um;if(m.fromBufferAttribute(a,c[0]),g.fromBufferAttribute(a,c[1]),y.fromBufferAttribute(a,c[2]),um.getNormal(C0),d[0]=`${Math.round(m.x*r)},${Math.round(m.y*r)},${Math.round(m.z*r)}`,d[1]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,d[2]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,d[0]!==d[1]&&d[1]!==d[2]&&d[2]!==d[0])for(let v=0;v<3;v++){const _=(v+1)%3,b=d[v],w=d[_],M=um[u[v]],C=um[u[_]],x=`${b}_${w}`,S=`${w}_${b}`;S in h&&h[S]?(C0.dot(h[S].normal)<=s&&(f.push(M.x,M.y,M.z),f.push(C.x,C.y,C.z)),h[S]=null):x in h||(h[x]={index0:c[v],index1:c[_],normal:C0.clone()})}}for(const p in h)if(h[p]){const{index0:m,index1:g}=h[p];lm.fromBufferAttribute(a,m),cm.fromBufferAttribute(a,g),f.push(lm.x,lm.y,lm.z),f.push(cm.x,cm.y,cm.z)}this.setAttribute("position",new Ee(f,3))}}}class fa extends gd{constructor(e){super(e),this.uuid=Fi(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push((new gd).fromJSON(r))}return this}}function QR(n,e,t,i,r){let s,o;if(r===function aX(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}(n,e,t,i)>0)for(s=e;s<t;s+=i)o=nP(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=nP(s,n[s],n[s+1],o);return o&&dm(o,o.next)&&(Md(o),o=o.next),o}function pa(n,e){if(!n)return n;e||(e=n);let i,t=n;do{if(i=!1,t.steiner||!dm(t,t.next)&&0!==Qt(t.prev,t,t.next))t=t.next;else{if(Md(t),t=e=t.prev,t===t.next)break;i=!0}}while(i||t!==e);return e}function xd(n,e,t,i,r,s,o){if(!n)return;!o&&s&&function tX(n,e,t,i){let r=n;do{0===r.z&&(r.z=D0(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,function nX(n){let e,t,i,r,s,o,a,l,c=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<c&&(a++,i=i.nextZ,i);e++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,c*=2}while(o>1)}(r)}(n,i,r,s);let l,c,a=n;for(;n.prev!==n.next;)if(l=n.prev,c=n.next,s?q7(n,i,r,s):$7(n))e.push(l.i/t|0),e.push(n.i/t|0),e.push(c.i/t|0),Md(n),n=c.next,a=c.next;else if((n=c)===a){o?1===o?xd(n=X7(pa(n),e,t),e,t,i,r,s,2):2===o&&Y7(n,e,t,i,r,s):xd(pa(n),e,t,i,r,s,1);break}}function $7(n){const e=n.prev,t=n,i=n.next;if(Qt(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,c=i.y,u=r<s?r<o?r:o:s<o?s:o,d=a<l?a<c?a:c:l<c?l:c,h=r>s?r>o?r:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c;let p=i.next;for(;p!==e;){if(p.x>=u&&p.x<=h&&p.y>=d&&p.y<=f&&fc(r,a,s,l,o,c,p.x,p.y)&&Qt(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function q7(n,e,t,i){const r=n.prev,s=n,o=n.next;if(Qt(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,u=r.y,d=s.y,h=o.y,f=a<l?a<c?a:c:l<c?l:c,p=u<d?u<h?u:h:d<h?d:h,m=a>l?a>c?a:c:l>c?l:c,g=u>d?u>h?u:h:d>h?d:h,y=D0(f,p,e,t,i),v=D0(m,g,e,t,i);let _=n.prevZ,b=n.nextZ;for(;_&&_.z>=y&&b&&b.z<=v;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==r&&_!==o&&fc(a,u,l,d,c,h,_.x,_.y)&&Qt(_.prev,_,_.next)>=0||(_=_.prevZ,b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==r&&b!==o&&fc(a,u,l,d,c,h,b.x,b.y)&&Qt(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;_&&_.z>=y;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==r&&_!==o&&fc(a,u,l,d,c,h,_.x,_.y)&&Qt(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;b&&b.z<=v;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==r&&b!==o&&fc(a,u,l,d,c,h,b.x,b.y)&&Qt(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function X7(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!dm(r,s)&&eP(r,i,i.next,s)&&wd(r,s)&&wd(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),Md(i),Md(i.next),i=n=s),i=i.next}while(i!==n);return pa(i)}function Y7(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&rX(o,a)){let l=tP(o,a);return o=pa(o,o.next),l=pa(l,l.next),xd(o,e,t,i,r,s,0),void xd(l,e,t,i,r,s,0)}a=a.next}o=o.next}while(o!==n)}function Z7(n,e){return n.x-e.x}function J7(n,e){const t=function Q7(n,e){let r,t=e,i=-1/0;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const h=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(h<=s&&h>i&&(i=h,r=t.x<t.next.x?t:t.next,h===s))return r}t=t.next}while(t!==e);if(!r)return null;const a=r,l=r.x,c=r.y;let d,u=1/0;t=r;do{s>=t.x&&t.x>=l&&s!==t.x&&fc(o<c?s:i,o,l,c,o<c?i:s,o,t.x,t.y)&&(d=Math.abs(o-t.y)/(s-t.x),wd(t,n)&&(d<u||d===u&&(t.x>r.x||t.x===r.x&&eX(r,t)))&&(r=t,u=d)),t=t.next}while(t!==a);return r}(n,e);if(!t)return e;const i=tP(t,n);return pa(i,i.next),pa(t,t.next)}function eX(n,e){return Qt(n.prev,n,e.prev)<0&&Qt(e.next,n,n.next)<0}function D0(n,e,t,i,r){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-t)*r|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function iX(n){let e=n,t=n;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==n);return t}function fc(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function rX(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function sX(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&eP(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}(n,e)&&(wd(n,e)&&wd(e,n)&&function oX(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next}while(t!==n);return i}(n,e)&&(Qt(n.prev,n,e.prev)||Qt(n,e.prev,e))||dm(n,e)&&Qt(n.prev,n,n.next)>0&&Qt(e.prev,e,e.next)>0)}function Qt(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function dm(n,e){return n.x===e.x&&n.y===e.y}function eP(n,e,t,i){const r=fm(Qt(n,e,t)),s=fm(Qt(n,e,i)),o=fm(Qt(t,i,n)),a=fm(Qt(t,i,e));return!!(r!==s&&o!==a||0===r&&hm(n,t,e)||0===s&&hm(n,i,e)||0===o&&hm(t,n,i)||0===a&&hm(t,e,i))}function hm(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function fm(n){return n>0?1:n<0?-1:0}function wd(n,e){return Qt(n.prev,n,n.next)<0?Qt(n,e,n.next)>=0&&Qt(n,n.prev,e)>=0:Qt(n,e,n.prev)<0||Qt(n,n.next,e)<0}function tP(n,e){const t=new A0(n.i,n.x,n.y),i=new A0(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function nP(n,e,t,i){const r=new A0(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Md(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function A0(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Xr{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*i}static isClockWise(e){return Xr.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];iP(e),rP(i,e);let o=e.length;t.forEach(iP);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,rP(i,t[l]);const a=function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=QR(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,d,h,f;if(i&&(s=function K7(n,e,t,i){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,c=QR(n,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(iX(c));for(r.sort(Z7),s=0;s<r.length;s++)t=J7(r[s],t);return t}(n,e,s,t)),n.length>80*t){a=c=n[0],l=u=n[1];for(let p=t;p<r;p+=t)d=n[p],h=n[p+1],d<a&&(a=d),h<l&&(l=h),d>c&&(c=d),h>u&&(u=h);f=Math.max(c-a,u-l),f=0!==f?32767/f:0}return xd(s,o,t,a,l,f,0),o}(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function iP(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function rP(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class Sd extends et{constructor(e=new fa([new ee(.5,.5),new ee(-.5,.5),new ee(-.5,-.5),new ee(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++)o(e[a]);function o(a){const l=[],c=void 0!==t.curveSegments?t.curveSegments:12,u=void 0!==t.steps?t.steps:1,d=void 0!==t.depth?t.depth:1;let h=void 0===t.bevelEnabled||t.bevelEnabled,f=void 0!==t.bevelThickness?t.bevelThickness:.2,p=void 0!==t.bevelSize?t.bevelSize:f-.1,m=void 0!==t.bevelOffset?t.bevelOffset:0,g=void 0!==t.bevelSegments?t.bevelSegments:3;const y=t.extrudePath,v=void 0!==t.UVGenerator?t.UVGenerator:lX;let _,w,M,C,x,b=!1;y&&(_=y.getSpacedPoints(u),b=!0,h=!1,w=y.computeFrenetFrames(u,!1),M=new D,C=new D,x=new D),h||(g=0,f=0,p=0,m=0);const S=a.extractPoints(c);let I=S.shape;const L=S.holes;if(!Xr.isClockWise(I)){I=I.reverse();for(let Q=0,J=L.length;Q<J;Q++){const de=L[Q];Xr.isClockWise(de)&&(L[Q]=de.reverse())}}const P=Xr.triangulateShape(I,L),R=I;for(let Q=0,J=L.length;Q<J;Q++)I=I.concat(L[Q]);function j(Q,J,de){return J||console.error("THREE.ExtrudeGeometry: vec does not exist"),J.clone().multiplyScalar(de).add(Q)}const O=I.length,G=P.length;function N(Q,J,de){let Ae,ge,Ye;const Be=Q.x-J.x,Re=Q.y-J.y,$t=de.x-Q.x,Pt=de.y-Q.y,T=Be*Be+Re*Re;if(Math.abs(Be*Pt-Re*$t)>Number.EPSILON){const W=Math.sqrt(T),ae=Math.sqrt($t*$t+Pt*Pt),ue=J.x-Re/W,xe=J.y+Be/W,Z=((de.x-Pt/ae-ue)*Pt-(de.y+$t/ae-xe)*$t)/(Be*Pt-Re*$t);Ae=ue+Be*Z-Q.x,ge=xe+Re*Z-Q.y;const Pe=Ae*Ae+ge*ge;if(Pe<=2)return new ee(Ae,ge);Ye=Math.sqrt(Pe/2)}else{let W=!1;Be>Number.EPSILON?$t>Number.EPSILON&&(W=!0):Be<-Number.EPSILON?$t<-Number.EPSILON&&(W=!0):Math.sign(Re)===Math.sign(Pt)&&(W=!0),W?(Ae=-Re,ge=Be,Ye=Math.sqrt(T)):(Ae=Be,ge=Re,Ye=Math.sqrt(T/2))}return new ee(Ae/Ye,ge/Ye)}const $=[];for(let Q=0,J=R.length,de=J-1,Ae=Q+1;Q<J;Q++,de++,Ae++)de===J&&(de=0),Ae===J&&(Ae=0),$[Q]=N(R[Q],R[de],R[Ae]);const Y=[];let pe,B=$.concat();for(let Q=0,J=L.length;Q<J;Q++){const de=L[Q];pe=[];for(let Ae=0,ge=de.length,Ye=ge-1,Be=Ae+1;Ae<ge;Ae++,Ye++,Be++)Ye===ge&&(Ye=0),Be===ge&&(Be=0),pe[Ae]=N(de[Ae],de[Ye],de[Be]);Y.push(pe),B=B.concat(pe)}for(let Q=0;Q<g;Q++){const J=Q/g,de=f*Math.cos(J*Math.PI/2),Ae=p*Math.sin(J*Math.PI/2)+m;for(let ge=0,Ye=R.length;ge<Ye;ge++){const Be=j(R[ge],$[ge],Ae);ve(Be.x,Be.y,-de)}for(let ge=0,Ye=L.length;ge<Ye;ge++){const Be=L[ge];pe=Y[ge];for(let Re=0,$t=Be.length;Re<$t;Re++){const Pt=j(Be[Re],pe[Re],Ae);ve(Pt.x,Pt.y,-de)}}}const te=p+m;for(let Q=0;Q<O;Q++){const J=h?j(I[Q],B[Q],te):I[Q];b?(C.copy(w.normals[0]).multiplyScalar(J.x),M.copy(w.binormals[0]).multiplyScalar(J.y),x.copy(_[0]).add(C).add(M),ve(x.x,x.y,x.z)):ve(J.x,J.y,0)}for(let Q=1;Q<=u;Q++)for(let J=0;J<O;J++){const de=h?j(I[J],B[J],te):I[J];b?(C.copy(w.normals[Q]).multiplyScalar(de.x),M.copy(w.binormals[Q]).multiplyScalar(de.y),x.copy(_[Q]).add(C).add(M),ve(x.x,x.y,x.z)):ve(de.x,de.y,d/u*Q)}for(let Q=g-1;Q>=0;Q--){const J=Q/g,de=f*Math.cos(J*Math.PI/2),Ae=p*Math.sin(J*Math.PI/2)+m;for(let ge=0,Ye=R.length;ge<Ye;ge++){const Be=j(R[ge],$[ge],Ae);ve(Be.x,Be.y,d+de)}for(let ge=0,Ye=L.length;ge<Ye;ge++){const Be=L[ge];pe=Y[ge];for(let Re=0,$t=Be.length;Re<$t;Re++){const Pt=j(Be[Re],pe[Re],Ae);b?ve(Pt.x,Pt.y+_[u-1].y,_[u-1].x+de):ve(Pt.x,Pt.y,d+de)}}}function z(Q,J){let de=Q.length;for(;--de>=0;){const Ae=de;let ge=de-1;ge<0&&(ge=Q.length-1);for(let Ye=0,Be=u+2*g;Ye<Be;Ye++){const Re=O*Ye,$t=O*(Ye+1);be(J+Ae+Re,J+ge+Re,J+ge+$t,J+Ae+$t)}}}function ve(Q,J,de){l.push(Q),l.push(J),l.push(de)}function _e(Q,J,de){le(Q),le(J),le(de);const Ae=r.length/3,ge=v.generateTopUV(i,r,Ae-3,Ae-2,Ae-1);qe(ge[0]),qe(ge[1]),qe(ge[2])}function be(Q,J,de,Ae){le(Q),le(J),le(Ae),le(J),le(de),le(Ae);const ge=r.length/3,Ye=v.generateSideWallUV(i,r,ge-6,ge-3,ge-2,ge-1);qe(Ye[0]),qe(Ye[1]),qe(Ye[3]),qe(Ye[1]),qe(Ye[2]),qe(Ye[3])}function le(Q){r.push(l[3*Q+0]),r.push(l[3*Q+1]),r.push(l[3*Q+2])}function qe(Q){s.push(Q.x),s.push(Q.y)}(function ne(){const Q=r.length/3;if(h){let J=0,de=O*J;for(let Ae=0;Ae<G;Ae++){const ge=P[Ae];_e(ge[2]+de,ge[1]+de,ge[0]+de)}J=u+2*g,de=O*J;for(let Ae=0;Ae<G;Ae++){const ge=P[Ae];_e(ge[0]+de,ge[1]+de,ge[2]+de)}}else{for(let J=0;J<G;J++){const de=P[J];_e(de[2],de[1],de[0])}for(let J=0;J<G;J++){const de=P[J];_e(de[0]+O*u,de[1]+O*u,de[2]+O*u)}}i.addGroup(Q,r.length/3-Q,0)})(),function ce(){const Q=r.length/3;let J=0;z(R,J),J+=R.length;for(let de=0,Ae=L.length;de<Ae;de++){const ge=L[de];z(ge,J),J+=ge.length}i.addGroup(Q,r.length/3-Q,1)}()}this.setAttribute("position",new Ee(r,3)),this.setAttribute("uv",new Ee(s,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function cX(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++)t.shapes.push(n[i].uuid);else t.shapes.push(n.uuid);return t.options=Object.assign({},e),void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++)i.push(t[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new E0[r.type]).fromJSON(r)),new Sd(i,e.options)}}const lX={generateTopUV:function(n,e,t,i,r){const a=e[3*i],l=e[3*i+1],c=e[3*r],u=e[3*r+1];return[new ee(e[3*t],e[3*t+1]),new ee(a,l),new ee(c,u)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[3*t],a=e[3*t+1],l=e[3*t+2],c=e[3*i],u=e[3*i+1],d=e[3*i+2],h=e[3*r],f=e[3*r+1],p=e[3*r+2],m=e[3*s],g=e[3*s+1],y=e[3*s+2];return Math.abs(a-u)<Math.abs(o-c)?[new ee(o,1-l),new ee(c,1-d),new ee(h,1-p),new ee(m,1-y)]:[new ee(a,1-l),new ee(u,1-d),new ee(f,1-p),new ee(g,1-y)]}};class Ed extends Cs{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2;super([-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ed(e.radius,e.detail)}}class pc extends Cs{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new pc(e.radius,e.detail)}}class Cd extends et{constructor(e=.5,t=1,i=32,r=1,s=0,o=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},i=Math.max(3,i);const a=[],l=[],c=[],u=[];let d=e;const h=(t-e)/(r=Math.max(1,r)),f=new D,p=new ee;for(let m=0;m<=r;m++){for(let g=0;g<=i;g++){const y=s+g/i*o;f.x=d*Math.cos(y),f.y=d*Math.sin(y),l.push(f.x,f.y,f.z),c.push(0,0,1),p.x=(f.x/t+1)/2,p.y=(f.y/t+1)/2,u.push(p.x,p.y)}d+=h}for(let m=0;m<r;m++){const g=m*(i+1);for(let y=0;y<i;y++){const v=y+g,b=v+i+1,w=v+i+2,M=v+1;a.push(v,b,M),a.push(b,w,M)}}this.setIndex(a),this.setAttribute("position",new Ee(l,3)),this.setAttribute("normal",new Ee(c,3)),this.setAttribute("uv",new Ee(u,2))}static fromJSON(e){return new Cd(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Dd extends et{constructor(e=new fa([new ee(0,.5),new ee(-.5,-.5),new ee(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],s=[],o=[];let a=0,l=0;if(!1===Array.isArray(e))c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(a,l,u),a+=l,l=0;function c(u){const d=r.length/3,h=u.extractPoints(t);let f=h.shape;const p=h.holes;!1===Xr.isClockWise(f)&&(f=f.reverse());for(let g=0,y=p.length;g<y;g++){const v=p[g];!0===Xr.isClockWise(v)&&(p[g]=v.reverse())}const m=Xr.triangulateShape(f,p);for(let g=0,y=p.length;g<y;g++)f=f.concat(p[g]);for(let g=0,y=f.length;g<y;g++){const v=f[g];r.push(v.x,v.y,0),s.push(0,0,1),o.push(v.x,v.y)}for(let g=0,y=m.length;g<y;g++){const v=m[g];i.push(v[0]+d,v[1]+d,v[2]+d),l+=3}}this.setIndex(i),this.setAttribute("position",new Ee(r,3)),this.setAttribute("normal",new Ee(s,3)),this.setAttribute("uv",new Ee(o,2))}toJSON(){const e=super.toJSON();return function uX(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++)e.shapes.push(n[t].uuid);else e.shapes.push(n.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const i=[];for(let r=0,s=e.shapes.length;r<s;r++)i.push(t[e.shapes[r]]);return new Dd(i,e.curveSegments)}}class mc extends et{constructor(e=1,t=32,i=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let c=0;const u=[],d=new D,h=new D,f=[],p=[],m=[],g=[];for(let y=0;y<=i;y++){const v=[],_=y/i;let b=0;0==y&&0==o?b=.5/t:y==i&&l==Math.PI&&(b=-.5/t);for(let w=0;w<=t;w++){const M=w/t;d.x=-e*Math.cos(r+M*s)*Math.sin(o+_*a),d.y=e*Math.cos(o+_*a),d.z=e*Math.sin(r+M*s)*Math.sin(o+_*a),p.push(d.x,d.y,d.z),h.copy(d).normalize(),m.push(h.x,h.y,h.z),g.push(M+b,1-_),v.push(c++)}u.push(v)}for(let y=0;y<i;y++)for(let v=0;v<t;v++){const b=u[y][v],w=u[y+1][v],M=u[y+1][v+1];(0!==y||o>0)&&f.push(u[y][v+1],b,M),(y!==i-1||l<Math.PI)&&f.push(b,w,M)}this.setIndex(f),this.setAttribute("position",new Ee(p,3)),this.setAttribute("normal",new Ee(m,3)),this.setAttribute("uv",new Ee(g,2))}static fromJSON(e){return new mc(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Ad extends Cs{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ad(e.radius,e.detail)}}class Td extends et{constructor(e=1,t=.4,i=12,r=48,s=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],l=[],c=[],u=new D,d=new D,h=new D;for(let f=0;f<=i;f++)for(let p=0;p<=r;p++){const m=p/r*s,g=f/i*Math.PI*2;d.x=(e+t*Math.cos(g))*Math.cos(m),d.y=(e+t*Math.cos(g))*Math.sin(m),d.z=t*Math.sin(g),a.push(d.x,d.y,d.z),u.x=e*Math.cos(m),u.y=e*Math.sin(m),h.subVectors(d,u).normalize(),l.push(h.x,h.y,h.z),c.push(p/r),c.push(f/i)}for(let f=1;f<=i;f++)for(let p=1;p<=r;p++){const g=(r+1)*(f-1)+p-1,y=(r+1)*(f-1)+p,v=(r+1)*f+p;o.push((r+1)*f+p-1,g,v),o.push(g,y,v)}this.setIndex(o),this.setAttribute("position",new Ee(a,3)),this.setAttribute("normal",new Ee(l,3)),this.setAttribute("uv",new Ee(c,2))}static fromJSON(e){return new Td(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Id extends et{constructor(e=1,t=.4,i=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:s,q:o},i=Math.floor(i),r=Math.floor(r);const a=[],l=[],c=[],u=[],d=new D,h=new D,f=new D,p=new D,m=new D,g=new D,y=new D;for(let _=0;_<=i;++_){const b=_/i*s*Math.PI*2;v(b,s,o,e,f),v(b+.01,s,o,e,p),g.subVectors(p,f),y.addVectors(p,f),m.crossVectors(g,y),y.crossVectors(m,g),m.normalize(),y.normalize();for(let w=0;w<=r;++w){const M=w/r*Math.PI*2,C=-t*Math.cos(M),x=t*Math.sin(M);d.x=f.x+(C*y.x+x*m.x),d.y=f.y+(C*y.y+x*m.y),d.z=f.z+(C*y.z+x*m.z),l.push(d.x,d.y,d.z),h.subVectors(d,f).normalize(),c.push(h.x,h.y,h.z),u.push(_/i),u.push(w/r)}}for(let _=1;_<=i;_++)for(let b=1;b<=r;b++){const M=(r+1)*_+(b-1),C=(r+1)*_+b,x=(r+1)*(_-1)+b;a.push((r+1)*(_-1)+(b-1),M,x),a.push(M,C,x)}function v(_,b,w,M,C){const x=Math.cos(_),S=Math.sin(_),I=w/b*_,L=Math.cos(I);C.x=M*(2+L)*.5*x,C.y=M*(2+L)*S*.5,C.z=M*Math.sin(I)*.5}this.setIndex(a),this.setAttribute("position",new Ee(l,3)),this.setAttribute("normal",new Ee(c,3)),this.setAttribute("uv",new Ee(u,2))}static fromJSON(e){return new Id(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Rd extends et{constructor(e=new M0(new D(-1,-1,0),new D(-1,1,0),new D(1,1,0)),t=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new D,l=new D,c=new ee;let u=new D;const d=[],h=[],f=[],p=[];function g(_){u=e.getPointAt(_/t,u);const b=o.normals[_],w=o.binormals[_];for(let M=0;M<=r;M++){const C=M/r*Math.PI*2,x=Math.sin(C),S=-Math.cos(C);l.x=S*b.x+x*w.x,l.y=S*b.y+x*w.y,l.z=S*b.z+x*w.z,l.normalize(),h.push(l.x,l.y,l.z),a.x=u.x+i*l.x,a.y=u.y+i*l.y,a.z=u.z+i*l.z,d.push(a.x,a.y,a.z)}}(function m(){for(let _=0;_<t;_++)g(_);g(!1===s?t:0),function v(){for(let _=0;_<=t;_++)for(let b=0;b<=r;b++)c.x=_/t,c.y=b/r,f.push(c.x,c.y)}(),function y(){for(let _=1;_<=t;_++)for(let b=1;b<=r;b++){const M=(r+1)*_+(b-1),C=(r+1)*_+b,x=(r+1)*(_-1)+b;p.push((r+1)*(_-1)+(b-1),M,x),p.push(M,C,x)}}()})(),this.setIndex(p),this.setAttribute("position",new Ee(d,3)),this.setAttribute("normal",new Ee(h,3)),this.setAttribute("uv",new Ee(f,2))}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Rd((new E0[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class sP extends et{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],i=new Set,r=new D,s=new D;if(null!==e.index){const o=e.attributes.position,a=e.index;let l=e.groups;0===l.length&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const d=l[c],h=d.start;for(let p=h,m=h+d.count;p<m;p+=3)for(let g=0;g<3;g++){const y=a.getX(p+g),v=a.getX(p+(g+1)%3);r.fromBufferAttribute(o,y),s.fromBufferAttribute(o,v),!0===oP(r,s,i)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const d=3*a+(c+1)%3;r.fromBufferAttribute(o,3*a+c),s.fromBufferAttribute(o,d),!0===oP(r,s,i)&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Ee(t,3))}}}function oP(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return!0!==t.has(i)&&!0!==t.has(r)&&(t.add(i),t.add(r),!0)}var aP=Object.freeze({__proto__:null,BoxGeometry:oo,CapsuleGeometry:_d,CircleGeometry:yd,ConeGeometry:vd,CylinderGeometry:ha,DodecahedronGeometry:bd,EdgesGeometry:JR,ExtrudeGeometry:Sd,IcosahedronGeometry:Ed,LatheGeometry:hc,OctahedronGeometry:pc,PlaneGeometry:tc,PolyhedronGeometry:Cs,RingGeometry:Cd,ShapeGeometry:Dd,SphereGeometry:mc,TetrahedronGeometry:Ad,TorusGeometry:Td,TorusKnotGeometry:Id,TubeGeometry:Rd,WireframeGeometry:sP});class lP extends Dn{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new me(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class cP extends qr{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Pd extends Dn{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new me(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new me(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qs,this.normalScale=new ee(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Ds extends Pd{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ee(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return un(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new me(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new me(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new me(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class uP extends Dn{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new me(16777215),this.specular=new me(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new me(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qs,this.normalScale=new ee(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Gu,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class dP extends Dn{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new me(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new me(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qs,this.normalScale=new ee(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class hP extends Dn{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qs,this.normalScale=new ee(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class fP extends Dn{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new me(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new me(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qs,this.normalScale=new ee(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Gu,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class pP extends Dn{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new me(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qs,this.normalScale=new ee(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class mP extends ei{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function nr(n,e,t){return T0(n)?new n.constructor(n.subarray(e,void 0!==t?t:n.length)):n.slice(e,t)}function ma(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}function T0(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function gP(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i}function I0(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r}function R0(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=n[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),t.push(o)),s=n[r++]}while(void 0!==s)}var fX=Object.freeze({__proto__:null,arraySlice:nr,convertArray:ma,flattenJSON:R0,getKeyframeOrder:gP,isTypedArray:T0,makeClipAdditive:function hX(n,e=0,t=n,i=30){i<=0&&(i=30);const r=t.tracks.length,s=e/i;for(let o=0;o<r;++o){const a=t.tracks[o],l=a.ValueTypeName;if("bool"===l||"string"===l)continue;const c=n.tracks.find(function(y){return y.name===a.name&&y.ValueTypeName===l});if(void 0===c)continue;let u=0;const d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=d/3);let h=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=f/3);const p=a.times.length-1;let m;if(s<=a.times[0])m=nr(a.values,u,d-u);else if(s>=a.times[p]){const y=p*d+u;m=nr(a.values,y,y+d-u)}else{const y=a.createInterpolant(),v=u,_=d-u;y.evaluate(s),m=nr(y.resultBuffer,v,_)}"quaternion"===l&&(new Qn).fromArray(m).normalize().conjugate().toArray(m);const g=c.times.length;for(let y=0;y<g;++y){const v=y*f+h;if("quaternion"===l)Qn.multiplyQuaternionsFlat(c.values,v,m,0,c.values,v);else{const _=f-2*h;for(let b=0;b<_;++b)c.values[v+b]-=m[b]}}}return n.blendMode=wb,n},sortedArray:I0,subclip:function dX(n,e,t,i,r=30){const s=n.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),d=[],h=[];for(let f=0;f<c.times.length;++f){const p=c.times[f]*r;if(!(p<t||p>=i)){d.push(c.times[f]);for(let m=0;m<u;++m)h.push(c.values[f*u+m])}}0!==d.length&&(c.times=ma(d,c.times.constructor),c.values=ma(h,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}});class gc{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class _P extends gc{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ta,endingEnd:ta}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case na:s=e,a=2*t-i;break;case qu:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===l)switch(this.getSettings_().endingEnd){case na:o=e,l=2*i-t;break;case qu:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(i-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,f=this._weightNext,p=(i-t)/(r-t),m=p*p,g=m*p,y=-h*g+2*h*m-h*p,v=(1+h)*g+(-1.5-2*h)*m+(-.5+h)*p+1,_=(-1-f)*g+(1.5+f)*m+.5*p,b=f*g-f*m;for(let w=0;w!==a;++w)s[w]=y*o[u+w]+v*o[c+w]+_*o[l+w]+b*o[d+w];return s}}class P0 extends gc{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(i-t)/(r-t),d=1-u;for(let h=0;h!==a;++h)s[h]=o[c+h]*d+o[l+h]*u;return s}}class yP extends gc{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ar{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ma(t,this.TimeBufferType),this.values=ma(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:ma(e.times,Array),values:ma(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new yP(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new P0(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new _P(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Bl:t=this.InterpolantFactoryMethodDiscrete;break;case ea:t=this.InterpolantFactoryMethodLinear;break;case mp:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Bl;case this.InterpolantFactoryMethodLinear:return ea;case this.InterpolantFactoryMethodSmooth:return mp}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=nr(i,s,o),this.values=nr(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&T0(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=nr(this.times),t=nr(this.values),i=this.getValueSize(),r=this.getInterpolation()===mp,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const d=a*i,h=d-i,f=d+i;for(let p=0;p!==i;++p){const m=t[d+p];if(m!==t[h+p]||m!==t[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const d=a*i,h=o*i;for(let f=0;f!==i;++f)t[h+f]=t[d+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=nr(e,0,o),this.values=nr(t,0,o*i)):(this.times=e,this.values=t),this}clone(){const e=nr(this.times,0),t=nr(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Ar.prototype.TimeBufferType=Float32Array,Ar.prototype.ValueBufferType=Float32Array,Ar.prototype.DefaultInterpolation=ea;class ga extends Ar{}ga.prototype.ValueTypeName="bool",ga.prototype.ValueBufferType=Array,ga.prototype.DefaultInterpolation=Bl,ga.prototype.InterpolantFactoryMethodLinear=void 0,ga.prototype.InterpolantFactoryMethodSmooth=void 0;class F0 extends Ar{}F0.prototype.ValueTypeName="color";class _c extends Ar{}_c.prototype.ValueTypeName="number";class vP extends gc{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)Qn.slerpFlat(s,0,o,c-a,o,c,l);return s}}class co extends Ar{InterpolantFactoryMethodLinear(e){return new vP(this.times,this.values,this.getValueSize(),e)}}co.prototype.ValueTypeName="quaternion",co.prototype.DefaultInterpolation=ea,co.prototype.InterpolantFactoryMethodSmooth=void 0;class _a extends Ar{}_a.prototype.ValueTypeName="string",_a.prototype.ValueBufferType=Array,_a.prototype.DefaultInterpolation=Bl,_a.prototype.InterpolantFactoryMethodLinear=void 0,_a.prototype.InterpolantFactoryMethodSmooth=void 0;class yc extends Ar{}yc.prototype.ValueTypeName="vector";class vc{constructor(e,t=-1,i,r=gp){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=Fi(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(mX(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(Ar.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=gP(l);l=I0(l,1,u),c=I0(c,1,u),!r&&0===l[0]&&(l.push(s),c.push(c[0])),o.push(new _c(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const d=u[1];let h=r[d];h||(r[d]=h=[]),h.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(d,h,f,p,m){if(0!==f.length){const g=[],y=[];R0(f,g,y,p),0!==g.length&&m.push(new d(h,g,y))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let d=0;d<c.length;d++){const h=c[d].keys;if(h&&0!==h.length)if(h[0].morphTargets){const f={};let p;for(p=0;p<h.length;p++)if(h[p].morphTargets)for(let m=0;m<h[p].morphTargets.length;m++)f[h[p].morphTargets[m]]=-1;for(const m in f){const g=[],y=[];for(let v=0;v!==h[p].morphTargets.length;++v){const _=h[p];g.push(_.time),y.push(_.morphTarget===m?1:0)}r.push(new _c(".morphTargetInfluence["+m+"]",g,y))}l=f.length*o}else{const f=".bones["+t[d].name+"]";i(yc,f+".position",h,"pos",r),i(co,f+".quaternion",h,"rot",r),i(yc,f+".scale",h,"scl",r)}}return 0===r.length?null:new this(s,l,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function mX(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function pX(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return _c;case"vector":case"vector2":case"vector3":case"vector4":return yc;case"color":return F0;case"quaternion":return co;case"bool":case"boolean":return ga;case"string":return _a}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];R0(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const ya={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class O0{constructor(e,t,i){const r=this;let l,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,!1===s&&void 0!==r.onStart&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,void 0!==r.onProgress&&r.onProgress(u,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,d){return c.push(u,d),this},this.removeHandler=function(u){const d=c.indexOf(u);return-1!==d&&c.splice(d,2),this},this.getHandler=function(u){for(let d=0,h=c.length;d<h;d+=2){const f=c[d],p=c[d+1];if(f.global&&(f.lastIndex=0),f.test(u))return p}return null}}}const bP=new O0;class wi{constructor(e){this.manager=void 0!==e?e:bP,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const As={};class gX extends Error{constructor(e,t){super(e),this.response=t}}class Tr extends wi{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=ya.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==As[e])return void As[e].push({onLoad:t,onProgress:i,onError:r});As[e]=[],As[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===c.body||void 0===c.body.getReader)return c;const u=As[e],d=c.body.getReader(),h=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),f=h?parseInt(h):0,p=0!==f;let m=0;const g=new ReadableStream({start(y){!function v(){d.read().then(({done:_,value:b})=>{if(_)y.close();else{m+=b.byteLength;const w=new ProgressEvent("progress",{lengthComputable:p,loaded:m,total:f});for(let M=0,C=u.length;M<C;M++){const x=u[M];x.onProgress&&x.onProgress(w)}y.enqueue(b),v()}})}()}});return new Response(g)}throw new gX(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>(new DOMParser).parseFromString(u,a));case"json":return c.json();default:if(void 0===a)return c.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),h=d&&d[1]?d[1].toLowerCase():void 0,f=new TextDecoder(h);return c.arrayBuffer().then(p=>f.decode(p))}}}).then(c=>{ya.add(e,c);const u=As[e];delete As[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onLoad&&f.onLoad(c)}}).catch(c=>{const u=As[e];if(void 0===u)throw this.manager.itemError(e),c;delete As[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class _X extends wi{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Tr(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const t=[];for(let i=0;i<e.length;i++){const r=vc.parse(e[i]);t.push(r)}return t}}class yX extends wi{constructor(e){super(e)}load(e,t,i,r){const s=this,o=[],a=new g0,l=new Tr(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function u(d){l.load(e[d],function(h){const f=s.parse(h,!0);o[d]={width:f.width,height:f.height,format:f.format,mipmaps:f.mipmaps},c+=1,6===c&&(1===f.mipmapCount&&(a.minFilter=Jt),a.image=o,a.format=f.format,a.needsUpdate=!0,t&&t(a))},i,r)}if(Array.isArray(e))for(let d=0,h=e.length;d<h;++d)u(d);else l.load(e,function(d){const h=s.parse(d,!0);if(h.isCubemap){const f=h.mipmaps.length/h.mipmapCount;for(let p=0;p<f;p++){o[p]={mipmaps:[]};for(let m=0;m<h.mipmapCount;m++)o[p].mipmaps.push(h.mipmaps[p*h.mipmapCount+m]),o[p].format=h.format,o[p].width=h.width,o[p].height=h.height}a.image=o}else a.image.width=h.width,a.image.height=h.height,a.mipmaps=h.mipmaps;1===h.mipmapCount&&(a.minFilter=Jt),a.format=h.format,a.needsUpdate=!0,t&&t(a)},i,r);return a}}class Fd extends wi{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=ya.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Zu("img");function l(){u(),ya.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(d){u(),r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class vX extends wi{constructor(e){super(e)}load(e,t,i,r){const s=new od,o=new Fd(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(u){s.images[c]=u,a++,6===a&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class bX extends wi{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new uc,a=new Tr(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){const c=s.parse(l);c&&(void 0!==c.image?o.image=c.image:void 0!==c.data&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=void 0!==c.wrapS?c.wrapS:zn,o.wrapT=void 0!==c.wrapT?c.wrapT:zn,o.magFilter=void 0!==c.magFilter?c.magFilter:Jt,o.minFilter=void 0!==c.minFilter?c.minFilter:Jt,o.anisotropy=void 0!==c.anisotropy?c.anisotropy:1,void 0!==c.encoding&&(o.encoding=c.encoding),void 0!==c.flipY&&(o.flipY=c.flipY),void 0!==c.format&&(o.format=c.format),void 0!==c.type&&(o.type=c.type),void 0!==c.mipmaps&&(o.mipmaps=c.mipmaps,o.minFilter=$r),1===c.mipmapCount&&(o.minFilter=Jt),void 0!==c.generateMipmaps&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,t&&t(o,c))},i,r),o}}class xP extends wi{constructor(e){super(e)}load(e,t,i,r){const s=new Hn,o=new Fd(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class uo extends Vt{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new me(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class wP extends uo{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Vt.DEFAULT_UP),this.updateMatrix(),this.groundColor=new me(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const L0=new He,MP=new D,SP=new D;class N0{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ee(512,512),this.map=null,this.mapPass=null,this.matrix=new He,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Up,this._frameExtents=new ee(1,1),this._viewportCount=1,this._viewports=[new Rt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;MP.setFromMatrixPosition(e.matrixWorld),t.position.copy(MP),SP.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(SP),t.updateMatrixWorld(),L0.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(L0),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(L0)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class xX extends N0{constructor(){super(new An(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*Yu*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class k0 extends uo{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Vt.DEFAULT_UP),this.updateMatrix(),this.target=new Vt,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new xX}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const EP=new He,Od=new D,B0=new D;class wX extends N0{constructor(){super(new An(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ee(4,2),this._viewportCount=6,this._viewports=[new Rt(2,1,1,1),new Rt(0,1,1,1),new Rt(3,1,1,1),new Rt(1,1,1,1),new Rt(3,0,1,1),new Rt(1,0,1,1)],this._cubeDirections=[new D(1,0,0),new D(-1,0,0),new D(0,0,1),new D(0,0,-1),new D(0,1,0),new D(0,-1,0)],this._cubeUps=[new D(0,1,0),new D(0,1,0),new D(0,1,0),new D(0,1,0),new D(0,0,1),new D(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),Od.setFromMatrixPosition(e.matrixWorld),i.position.copy(Od),B0.copy(i.position),B0.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(B0),i.updateMatrixWorld(),r.makeTranslation(-Od.x,-Od.y,-Od.z),EP.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(EP)}}class V0 extends uo{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new wX}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class MX extends N0{constructor(){super(new nc(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class U0 extends uo{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Vt.DEFAULT_UP),this.updateMatrix(),this.target=new Vt,this.shadow=new MX}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class CP extends uo{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class DP extends uo{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class AP{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new D)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*i),t.addScaledVector(o[4],i*r*1.092548),t.addScaledVector(o[5],r*s*1.092548),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],i*s*1.092548),t.addScaledVector(o[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*r),t.addScaledVector(o[2],1.023328*s),t.addScaledVector(o[3],1.023328*i),t.addScaledVector(o[4],.858086*i*r),t.addScaledVector(o[5],.858086*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],.858086*i*s),t.addScaledVector(o[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const i=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*i*s,t[8]=.546274*(i*i-r*r)}}class pm extends uo{constructor(e=new AP,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class mm extends wi{constructor(e){super(e),this.textures={}}load(e,t,i,r){const s=this,o=new Tr(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const t=this.textures;function i(s){return void 0===t[s]&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const r=mm.createMaterialFromType(e.type);if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=(new me).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.iridescence&&(r.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(r.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(r.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&(r.vertexColors="number"==typeof e.vertexColors?e.vertexColors>0:e.vertexColors),void 0!==e.uniforms)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=i(o.value);break;case"c":r.uniforms[s].value=(new me).setHex(o.value);break;case"v2":r.uniforms[s].value=(new ee).fromArray(o.value);break;case"v3":r.uniforms[s].value=(new D).fromArray(o.value);break;case"v4":r.uniforms[s].value=(new Rt).fromArray(o.value);break;case"m3":r.uniforms[s].value=(new ci).fromArray(o.value);break;case"m4":r.uniforms[s].value=(new He).fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(r.glslVersion=e.glslVersion),void 0!==e.extensions)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=i(e.map)),void 0!==e.matcap&&(r.matcap=i(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=i(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=i(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=i(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new ee).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=i(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=i(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=i(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=i(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=i(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=i(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=i(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=i(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=i(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=i(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=i(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=i(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new ee).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(r.iridescenceMap=i(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(r.transmissionMap=i(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=i(e.thicknessMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=i(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:lP,SpriteMaterial:l0,RawShaderMaterial:cP,ShaderMaterial:qr,PointsMaterial:nm,MeshPhysicalMaterial:Ds,MeshStandardMaterial:Pd,MeshPhongMaterial:uP,MeshToonMaterial:dP,MeshNormalMaterial:hP,MeshLambertMaterial:fP,MeshDepthMaterial:s0,MeshDistanceMaterial:o0,MeshBasicMaterial:Li,MeshMatcapMaterial:pP,LineDashedMaterial:mP,LineBasicMaterial:ei,Material:Dn}[e]}}class bc{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class TP extends et{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class IP extends wi{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Tr(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const t={},i={};function r(f,p){if(void 0!==t[p])return t[p];const g=f.interleavedBuffers[p],y=function s(f,p){if(void 0!==i[p])return i[p];const y=new Uint32Array(f.arrayBuffers[p]).buffer;return i[p]=y,y}(f,g.buffer),v=Ul(g.type,y),_=new ld(v,g.stride);return _.uuid=g.uuid,t[p]=_,_}const o=e.isInstancedBufferGeometry?new TP:new et,a=e.data.index;if(void 0!==a){const f=Ul(a.type,a.array);o.setIndex(new Dt(f,1))}const l=e.data.attributes;for(const f in l){const p=l[f];let m;if(p.isInterleavedBufferAttribute){const g=r(e.data,p.data);m=new lo(g,p.itemSize,p.offset,p.normalized)}else{const g=Ul(p.type,p.array);m=new(p.isInstancedBufferAttribute?dc:Dt)(g,p.itemSize,p.normalized)}void 0!==p.name&&(m.name=p.name),void 0!==p.usage&&m.setUsage(p.usage),void 0!==p.updateRange&&(m.updateRange.offset=p.updateRange.offset,m.updateRange.count=p.updateRange.count),o.setAttribute(f,m)}const c=e.data.morphAttributes;if(c)for(const f in c){const p=c[f],m=[];for(let g=0,y=p.length;g<y;g++){const v=p[g];let _;if(v.isInterleavedBufferAttribute){const b=r(e.data,v.data);_=new lo(b,v.itemSize,v.offset,v.normalized)}else{const b=Ul(v.type,v.array);_=new Dt(b,v.itemSize,v.normalized)}void 0!==v.name&&(_.name=v.name),m.push(_)}o.morphAttributes[f]=m}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const d=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==d)for(let f=0,p=d.length;f!==p;++f){const m=d[f];o.addGroup(m.start,m.count,m.materialIndex)}const h=e.data.boundingSphere;if(void 0!==h){const f=new D;void 0!==h.center&&f.fromArray(h.center),o.boundingSphere=new io(f,h.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class SX extends wi{constructor(e){super(e)}load(e,t,i,r){const s=this,o=""===this.path?bc.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new Tr(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(d){return void 0!==r&&r(d),void console.error("THREE:ObjectLoader: Can't parse "+e+".",d.message)}const u=c.metadata;if(void 0===u||void 0===u.type||"geometry"===u.type.toLowerCase())return void 0!==r&&r(new Error("THREE.ObjectLoader: Can't load "+e)),void console.error("THREE.ObjectLoader: Can't load "+e);s.parse(c,t)},i,r)}loadAsync(e,t){var i=this;return Hu(function*(){const r=i,s=""===i.path?bc.extractUrlBase(e):i.path;i.resourcePath=i.resourcePath||s;const o=new Tr(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials);const a=yield o.loadAsync(e,t),l=JSON.parse(a),c=l.metadata;if(void 0===c||void 0===c.type||"geometry"===c.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return yield r.parseAsync(l)})()}parse(e,t){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){void 0!==t&&t(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,i),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),void 0!==t){let d=!1;for(const h in o)if(o[h].data instanceof HTMLImageElement){d=!0;break}!1===d&&t(c)}return c}parseAsync(e){var t=this;return Hu(function*(){const i=t.parseAnimations(e.animations),r=t.parseShapes(e.shapes),s=t.parseGeometries(e.geometries,r),o=yield t.parseImagesAsync(e.images),a=t.parseTextures(e.textures,o),l=t.parseMaterials(e.materials,a),c=t.parseObject(e.object,s,l,a,i),u=t.parseSkeletons(e.skeletons,c);return t.bindSkeletons(c,u),c})()}parseShapes(e){const t={};if(void 0!==e)for(let i=0,r=e.length;i<r;i++){const s=(new fa).fromJSON(e[i]);t[s.uuid]=s}return t}parseSkeletons(e,t){const i={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),void 0!==e)for(let s=0,o=e.length;s<o;s++){const a=(new hd).fromJSON(e[s],r);i[a.uuid]=a}return i}parseGeometries(e,t){const i={};if(void 0!==e){const r=new IP;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;default:l.type in aP?a=aP[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,void 0!==l.name&&(a.name=l.name),!0===a.isBufferGeometry&&void 0!==l.userData&&(a.userData=l.userData),i[l.uuid]=a}}return i}parseMaterials(e,t){const i={},r={};if(void 0!==e){const s=new mm;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const l=e[o];void 0===i[l.uuid]&&(i[l.uuid]=s.parse(l)),r[l.uuid]=i[l.uuid]}}return r}parseAnimations(e){const t={};if(void 0!==e)for(let i=0;i<e.length;i++){const s=vc.parse(e[i]);t[s.uuid]=s}return t}parseImages(e,t){const i=this,r={};let s;function a(l){if("string"==typeof l){const c=l;return function o(l){return i.manager.itemStart(l),s.load(l,function(){i.manager.itemEnd(l)},void 0,function(){i.manager.itemError(l),i.manager.itemEnd(l)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:i.resourcePath+c)}return l.data?{data:Ul(l.type,l.data),width:l.width,height:l.height}:null}if(void 0!==e&&e.length>0){const l=new O0(t);s=new Fd(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,u=e.length;c<u;c++){const d=e[c],h=d.url;if(Array.isArray(h)){const f=[];for(let p=0,m=h.length;p<m;p++){const y=a(h[p]);null!==y&&(y instanceof HTMLImageElement?f.push(y):f.push(new uc(y.data,y.width,y.height)))}r[d.uuid]=new sa(f)}else{const f=a(d.url);r[d.uuid]=new sa(f)}}}return r}parseImagesAsync(e){var t=this;return Hu(function*(){const i=t,r={};let s;function o(l){return a.apply(this,arguments)}function a(){return(a=Hu(function*(l){if("string"==typeof l){const c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:i.resourcePath+c;return yield s.loadAsync(u)}return l.data?{data:Ul(l.type,l.data),width:l.width,height:l.height}:null})).apply(this,arguments)}if(void 0!==e&&e.length>0){s=new Fd(t.manager),s.setCrossOrigin(t.crossOrigin);for(let l=0,c=e.length;l<c;l++){const u=e[l],d=u.url;if(Array.isArray(d)){const h=[];for(let f=0,p=d.length;f<p;f++){const m=d[f],g=yield o(m);null!==g&&(g instanceof HTMLImageElement?h.push(g):h.push(new uc(g.data,g.width,g.height)))}r[u.uuid]=new sa(h)}else{const h=yield o(u.url);r[u.uuid]=new sa(h)}}}return r})()}parseTextures(e,t){function i(s,o){return"number"==typeof s?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(void 0!==e)for(let s=0,o=e.length;s<o;s++){const a=e[s];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=t[a.image],c=l.data;let u;Array.isArray(c)?(u=new od,6===c.length&&(u.needsUpdate=!0)):(u=c&&c.data?new uc:new Hn,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=a.uuid,void 0!==a.name&&(u.name=a.name),void 0!==a.mapping&&(u.mapping=i(a.mapping,EX)),void 0!==a.offset&&u.offset.fromArray(a.offset),void 0!==a.repeat&&u.repeat.fromArray(a.repeat),void 0!==a.center&&u.center.fromArray(a.center),void 0!==a.rotation&&(u.rotation=a.rotation),void 0!==a.wrap&&(u.wrapS=i(a.wrap[0],RP),u.wrapT=i(a.wrap[1],RP)),void 0!==a.format&&(u.format=a.format),void 0!==a.type&&(u.type=a.type),void 0!==a.encoding&&(u.encoding=a.encoding),void 0!==a.minFilter&&(u.minFilter=i(a.minFilter,PP)),void 0!==a.magFilter&&(u.magFilter=i(a.magFilter,PP)),void 0!==a.anisotropy&&(u.anisotropy=a.anisotropy),void 0!==a.flipY&&(u.flipY=a.flipY),void 0!==a.generateMipmaps&&(u.generateMipmaps=a.generateMipmaps),void 0!==a.premultiplyAlpha&&(u.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(u.unpackAlignment=a.unpackAlignment),void 0!==a.userData&&(u.userData=a.userData),r[a.uuid]=u}return r}parseObject(e,t,i,r,s){let o,u,d;function a(h){return void 0===t[h]&&console.warn("THREE.ObjectLoader: Undefined geometry",h),t[h]}function l(h){if(void 0!==h){if(Array.isArray(h)){const f=[];for(let p=0,m=h.length;p<m;p++){const g=h[p];void 0===i[g]&&console.warn("THREE.ObjectLoader: Undefined material",g),f.push(i[g])}return f}return void 0===i[h]&&console.warn("THREE.ObjectLoader: Undefined material",h),i[h]}}function c(h){return void 0===r[h]&&console.warn("THREE.ObjectLoader: Undefined texture",h),r[h]}switch(e.type){case"Scene":o=new Xp,void 0!==e.background&&(o.background=Number.isInteger(e.background)?new me(e.background):c(e.background)),void 0!==e.environment&&(o.environment=c(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new qp(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new $p(e.fog.color,e.fog.density))),void 0!==e.backgroundBlurriness&&(o.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new An(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new nc(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new CP(e.color,e.intensity);break;case"DirectionalLight":o=new U0(e.color,e.intensity);break;case"PointLight":o=new V0(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new DP(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new k0(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new wP(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=(new pm).fromJSON(e);break;case"SkinnedMesh":u=a(e.geometry),d=l(e.material),o=new u0(u,d),void 0!==e.bindMode&&(o.bindMode=e.bindMode),void 0!==e.bindMatrix&&o.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(o.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),d=l(e.material),o=new On(u,d);break;case"InstancedMesh":u=a(e.geometry),d=l(e.material);const f=e.instanceMatrix,p=e.instanceColor;o=new d0(u,d,e.count),o.instanceMatrix=new dc(new Float32Array(f.array),16),void 0!==p&&(o.instanceColor=new dc(new Float32Array(p.array),p.itemSize));break;case"LOD":o=new RR;break;case"Line":o=new Es(a(e.geometry),l(e.material));break;case"LineLoop":o=new f0(a(e.geometry),l(e.material));break;case"LineSegments":o=new Cr(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new m0(a(e.geometry),l(e.material));break;case"Sprite":o=new TR(l(e.material));break;case"Group":o=new Ss;break;case"Bone":o=new Qp;break;default:o=new Vt}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(o.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(o.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.frustumCulled&&(o.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(o.renderOrder=e.renderOrder),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.layers&&(o.layers.mask=e.layers),void 0!==e.children){const h=e.children;for(let f=0;f<h.length;f++)o.add(this.parseObject(h[f],t,i,r,s))}if(void 0!==e.animations){const h=e.animations;for(let f=0;f<h.length;f++)o.animations.push(s[h[f]])}if("LOD"===e.type){void 0!==e.autoUpdate&&(o.autoUpdate=e.autoUpdate);const h=e.levels;for(let f=0;f<h.length;f++){const p=h[f],m=o.getObjectByProperty("uuid",p.object);void 0!==m&&o.addLevel(m,p.distance,p.hysteresis)}}return o}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse(function(i){if(!0===i.isSkinnedMesh&&void 0!==i.skeleton){const r=t[i.skeleton];void 0===r?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}}const EX={UVMapping:lp,CubeReflectionMapping:qs,CubeRefractionMapping:Xs,EquirectangularReflectionMapping:ju,EquirectangularRefractionMapping:Wu,CubeUVReflectionMapping:Ol},RP={RepeatWrapping:Ys,ClampToEdgeWrapping:zn,MirroredRepeatWrapping:Ll},PP={NearestFilter:sn,NearestMipmapNearestFilter:$u,NearestMipmapLinearFilter:Nl,LinearFilter:Jt,LinearMipmapNearestFilter:cp,LinearMipmapLinearFilter:$r};class FP extends wi{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=ya.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){ya.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let gm;class z0{static getContext(){return void 0===gm&&(gm=new(window.AudioContext||window.webkitAudioContext)),gm}static setContext(e){gm=e}}class CX extends wi{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Tr(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{const l=a.slice(0);z0.getContext().decodeAudioData(l,function(u){t(u)})}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}}class DX extends pm{constructor(e,t,i=1){super(void 0,i),this.isHemisphereLightProbe=!0;const r=(new me).set(e),s=(new me).set(t),o=new D(r.r,r.g,r.b),a=new D(s.r,s.g,s.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}}class AX extends pm{constructor(e,t=1){super(void 0,t),this.isAmbientLightProbe=!0;const i=(new me).set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const OP=new He,LP=new He,va=new He;class TX{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new An,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new An,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,va.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,o=t.near*Math.tan(ia*t.fov*.5)/t.zoom;let a,l;LP.elements[12]=-r,OP.elements[12]=r,a=-o*t.aspect+s,l=o*t.aspect+s,va.elements[0]=2*t.near/(l-a),va.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(va),a=-o*t.aspect-s,l=o*t.aspect-s,va.elements[0]=2*t.near/(l-a),va.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(va)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(LP),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(OP)}}class H0{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=NP(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=NP();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function NP(){return(typeof performance>"u"?Date:performance).now()}const ba=new D,kP=new Qn,IX=new D,xa=new D;class RX extends Vt{constructor(){super(),this.type="AudioListener",this.context=z0.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new H0}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(ba,kP,IX),xa.set(0,0,-1).applyQuaternion(kP),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(ba.x,r),t.positionY.linearRampToValueAtTime(ba.y,r),t.positionZ.linearRampToValueAtTime(ba.z,r),t.forwardX.linearRampToValueAtTime(xa.x,r),t.forwardY.linearRampToValueAtTime(xa.y,r),t.forwardZ.linearRampToValueAtTime(xa.z,r),t.upX.linearRampToValueAtTime(i.x,r),t.upY.linearRampToValueAtTime(i.y,r),t.upZ.linearRampToValueAtTime(i.z,r)}else t.setPosition(ba.x,ba.y,ba.z),t.setOrientation(xa.x,xa.y,xa.z,i.x,i.y,i.z)}}class BP extends Vt{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const wa=new D,VP=new Qn,PX=new D,Ma=new D;class FX extends BP{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(wa,VP,PX),Ma.set(0,0,1).applyQuaternion(VP);const t=this.panner;if(t.positionX){const i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(wa.x,i),t.positionY.linearRampToValueAtTime(wa.y,i),t.positionZ.linearRampToValueAtTime(wa.z,i),t.orientationX.linearRampToValueAtTime(Ma.x,i),t.orientationY.linearRampToValueAtTime(Ma.y,i),t.orientationZ.linearRampToValueAtTime(Ma.z,i)}else t.setPosition(wa.x,wa.y,wa.z),t.setOrientation(Ma.x,Ma.y,Ma.z)}}class OX{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let i=0;i<t.length;i++)e+=t[i];return e/t.length}}class UP{constructor(e,t,i){let r,s,o;switch(this.binding=e,this.valueSize=i,t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*i);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(0===o){for(let a=0;a!==r;++a)i[s+a]=i[a];o=t}else o+=t,this._mixBufferRegion(i,s,0,t/o,r);this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1&&this._mixBufferRegion(i,r,t*this._origIndex,1-s,t),o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(i[l]!==i[l+t]){a.setValue(i,r);break}}saveOriginalState(){const t=this.buffer,i=this.valueSize,r=i*this._origIndex;this.binding.getValue(t,r);for(let s=i,o=r;s!==o;++s)t[s]=t[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[i+o]}_slerp(e,t,i,r){Qn.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,s){const o=this._workIndex*s;Qn.multiplyQuaternionsFlat(e,o,e,t,e,i),Qn.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[i+a]*r}}_lerpAdditive(e,t,i,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[i+o]*r}}}const G0="\\[\\]\\.:\\/",LX=new RegExp("["+G0+"]","g"),j0="[^"+G0+"]",NX="[^"+G0.replace("\\.","")+"]",zX=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",j0)+/(WCOD+)?/.source.replace("WCOD",NX)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",j0)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",j0)+"$"),HX=["material","materials","bones","map"];class GX{constructor(e,t,i){const r=i||Ut.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Ut=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(LX,"")}static parseTrackName(t){const i=zX.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==HX.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===i||l.uuid===i)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===u){u=d;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=GX,n})();Ut.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Ut.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Ut.prototype.GetterByBindingType=[Ut.prototype._getValue_direct,Ut.prototype._getValue_array,Ut.prototype._getValue_arrayElement,Ut.prototype._getValue_toArray],Ut.prototype.SetterByBindingTypeAndVersioning=[[Ut.prototype._setValue_direct,Ut.prototype._setValue_direct_setNeedsUpdate,Ut.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ut.prototype._setValue_array,Ut.prototype._setValue_array_setNeedsUpdate,Ut.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ut.prototype._setValue_arrayElement,Ut.prototype._setValue_arrayElement_setNeedsUpdate,Ut.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ut.prototype._setValue_fromArray,Ut.prototype._setValue_fromArray_setNeedsUpdate,Ut.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class jX{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Fi(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,c=this.nCachedObjects_;for(let u=0,d=arguments.length;u!==d;++u){const h=arguments[u],f=h.uuid;let p=t[f];if(void 0===p){p=l++,t[f]=p,e.push(h);for(let m=0,g=o;m!==g;++m)s[m].push(new Ut(h,i[m],r[m]))}else if(p<c){a=e[p];const m=--c,g=e[m];t[g.uuid]=p,e[p]=g,t[f]=m,e[m]=h;for(let y=0,v=o;y!==v;++y){const _=s[y];let w=_[p];_[p]=_[m],void 0===w&&(w=new Ut(h,i[y],r[y])),_[m]=w}}else e[p]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,u=t[c];if(void 0!==u&&u>=s){const d=s++,h=e[d];t[h.uuid]=u,e[u]=h,t[c]=d,e[d]=l;for(let f=0,p=r;f!==p;++f){const m=i[f],y=m[u];m[u]=m[d],m[d]=y}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const u=arguments[a].uuid,d=t[u];if(void 0!==d)if(delete t[u],d<s){const h=--s,f=e[h],p=--o,m=e[p];t[f.uuid]=d,e[d]=f,t[m.uuid]=h,e[h]=m,e.pop();for(let g=0,y=r;g!==y;++g){const v=i[g],b=v[p];v[d]=v[h],v[h]=b,v.pop()}}else{const h=--o,f=e[h];h>0&&(t[f.uuid]=d),e[d]=f,e.pop();for(let p=0,m=r;p!==m;++p){const g=i[p];g[d]=g[h],g.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const i=this._bindingsIndicesByPath;let r=i[e];const s=this._bindings;if(void 0!==r)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,u=this.nCachedObjects_,d=new Array(l.length);r=s.length,i[e]=r,o.push(e),a.push(t),s.push(d);for(let h=u,f=l.length;h!==f;++h)d[h]=new Ut(l[h],e,t);return d}unsubscribe_(e){const t=this._bindingsIndicesByPath,i=t[e];if(void 0!==i){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a];t[e[a]]=i,o[i]=l,o.pop(),s[i]=s[a],s.pop(),r[i]=r[a],r.pop()}}}class WX{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:ta,endingEnd:ta};for(let c=0;c!==o;++c){const u=s[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=SI,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,s=e._clip.duration,a=r/s;e.warp(1,s/r,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+i,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled)return void this._updateWeight(e);const s=this._startTime;if(null!==s){const l=(e-s)*i;l<0||0===i?t=0:(this._startTime=null,t=i*l)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;if(this.blendMode===wb)for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulateAdditive(a);else for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulate(r,a)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(null!==i){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;null!==i&&(t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=i===EI;if(0===e)return-1===s?r:o&&1==(1&s)?t-r:r;if(i===MI){-1===s&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===s&&(e>=0?(s=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===l){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&1==(1&s))return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=na,r.endingEnd=na):(r.endingStart=e?this.zeroSlopeAtStart?na:ta:qu,r.endingEnd=t?this.zeroSlopeAtEnd?na:ta:qu)}_scheduleFading(e,t,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=i,this}}const $X=new Float32Array(1);class qX extends _s{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=i.uuid,c=this._bindingsByRootAndName;let u=c[l];void 0===u&&(u={},c[l]=u);for(let d=0;d!==s;++d){const h=r[d],f=h.name;let p=u[f];if(void 0!==p)++p.referenceCount,o[d]=p;else{if(p=o[d],void 0!==p){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,l,f));continue}p=new UP(Ut.create(i,f,t&&t._propertyBindings[d].binding.parsedPath),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,f),o[d]=p}a[d].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==--s.useCount&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,s=this._actionsByClip;let o=s[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===l.length&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==--s.referenceCount&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];void 0===o&&(o={},r[t]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[s],0===Object.keys(a).length&&delete o[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return void 0===i&&(i=new P0(new Float32Array(2),new Float32Array(2),1,$X),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=i,t[i]=s}clipAction(e,t,i){const r=t||this._root,s=r.uuid;let o="string"==typeof e?vc.findByName(r,e):e;const a=null!==o?o.uuid:e,l=this._actionsByClip[a];let c=null;if(void 0===i&&(i=null!==o?o.blendMode:gp),void 0!==l){const d=l.actionByRoot[s];if(void 0!==d&&d.blendMode===i)return d;c=l.knownActions[0],null===o&&(o=c._clip)}if(null===o)return null;const u=new WX(this,o,t,i);return this._bindAction(u,c),this._addInactiveAction(u,a,s),u}existingAction(e,t){const i=t||this._root,r=i.uuid,s="string"==typeof e?vc.findByName(i,e):e,a=this._actionsByClip[s?s.uuid:e];return void 0!==a&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let i=this._nActiveActions-1;i>=0;--i)e[i].stop();return this}update(e){const t=this._actions,i=this._nActiveActions,r=this.time+=e*=this.timeScale,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==i;++c)t[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(void 0!==s){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const u=c._cacheIndex,d=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,d._cacheIndex=u,t[u]=d,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const o in i){const l=i[o].actionByRoot[t];void 0!==l&&(this._deactivateAction(l),this._removeInactiveAction(l))}const s=this._bindingsByRootAndName[t];if(void 0!==s)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const i=this.existingAction(e,t);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class W0{constructor(e){this.value=e}clone(){return new W0(void 0===this.value.clone?this.value:this.value.clone())}}let XX=0;class YX extends _s{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:XX++}),this.name="",this.usage=Xu,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let i=0,r=t.length;i<r;i++)this.uniforms.push(t[i].clone());return this}clone(){return(new this.constructor).copy(this)}}class KX extends ld{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class ZX{constructor(e,t,i,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=i,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class $0{constructor(e,t,i=0,r=1/0){this.ray=new ed(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new ca,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return q0(e,this,i,t),i.sort(zP),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)q0(e[r],this,i,t);return i.sort(zP),i}}function zP(n,e){return n.distance-e.distance}function q0(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),!0===i){const r=n.children;for(let s=0,o=r.length;s<o;s++)q0(r[s],e,t,!0)}}class JX{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(un(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class QX{constructor(e=1,t=0,i=0){return this.radius=e,this.theta=t,this.y=i,this}set(e,t,i){return this.radius=e,this.theta=t,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}clone(){return(new this.constructor).copy(this)}}const HP=new ee;class eY{constructor(e=new ee(1/0,1/0),t=new ee(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=HP.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return HP.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const GP=new D,_m=new D;class tY{constructor(e=new D,t=new D){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){GP.subVectors(e,this.start),_m.subVectors(this.end,this.start);const i=_m.dot(_m);let s=_m.dot(GP)/i;return t&&(s=un(s,0,1)),s}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const jP=new D;class nY extends Vt{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const i=new et,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,u=a/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}i.setAttribute("position",new Ee(r,3));const s=new ei({fog:!1,toneMapped:!1});this.cone=new Cr(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),jP.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(jP),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const ho=new D,ym=new He,X0=new He;class iY extends Cr{constructor(e){const t=WP(e),i=new et,r=[],s=[],o=new me(0,0,1),a=new me(0,1,0);for(let c=0;c<t.length;c++){const u=t[c];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}i.setAttribute("position",new Ee(r,3)),i.setAttribute("color",new Ee(s,3)),super(i,new ei({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,i=this.geometry,r=i.getAttribute("position");X0.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(ym.multiplyMatrices(X0,a.matrixWorld),ho.setFromMatrixPosition(ym),r.setXYZ(o,ho.x,ho.y,ho.z),ym.multiplyMatrices(X0,a.parent.matrixWorld),ho.setFromMatrixPosition(ym),r.setXYZ(o+1,ho.x,ho.y,ho.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function WP(n){const e=[];!0===n.isBone&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,WP(n.children[t]));return e}class rY extends On{constructor(e,t,i){super(new mc(t,4,2),new Li({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const sY=new D,$P=new me,qP=new me;class oY extends Vt{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new pc(t);r.rotateY(.5*Math.PI),this.material=new Li({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(3*s.count);r.setAttribute("color",new Dt(o,3)),this.add(new On(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");$P.copy(this.light.color),qP.copy(this.light.groundColor);for(let i=0,r=t.count;i<r;i++){const s=i<r/2?$P:qP;t.setXYZ(i,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(sY.setFromMatrixPosition(this.light.matrixWorld).negate())}}class aY extends Cr{constructor(e=10,t=10,i=4473924,r=8947848){i=new me(i),r=new me(r);const s=t/2,o=e/t,a=e/2,l=[],c=[];for(let h=0,f=0,p=-a;h<=t;h++,p+=o){l.push(-a,0,p,a,0,p),l.push(p,0,-a,p,0,a);const m=h===s?i:r;m.toArray(c,f),f+=3,m.toArray(c,f),f+=3,m.toArray(c,f),f+=3,m.toArray(c,f),f+=3}const u=new et;u.setAttribute("position",new Ee(l,3)),u.setAttribute("color",new Ee(c,3)),super(u,new ei({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class lY extends Cr{constructor(e=10,t=16,i=8,r=64,s=4473924,o=8947848){s=new me(s),o=new me(o);const a=[],l=[];if(t>1)for(let d=0;d<t;d++){const h=d/t*(2*Math.PI),f=Math.sin(h)*e,p=Math.cos(h)*e;a.push(0,0,0),a.push(f,0,p);const m=1&d?s:o;l.push(m.r,m.g,m.b),l.push(m.r,m.g,m.b)}for(let d=0;d<i;d++){const h=1&d?s:o,f=e-e/i*d;for(let p=0;p<r;p++){let m=p/r*(2*Math.PI),g=Math.sin(m)*f,y=Math.cos(m)*f;a.push(g,0,y),l.push(h.r,h.g,h.b),m=(p+1)/r*(2*Math.PI),g=Math.sin(m)*f,y=Math.cos(m)*f,a.push(g,0,y),l.push(h.r,h.g,h.b)}}const c=new et;c.setAttribute("position",new Ee(a,3)),c.setAttribute("color",new Ee(l,3)),super(c,new ei({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const XP=new D,vm=new D,YP=new D;class cY extends Vt{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",void 0===t&&(t=1);let r=new et;r.setAttribute("position",new Ee([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new ei({fog:!1,toneMapped:!1});this.lightPlane=new Es(r,s),this.add(this.lightPlane),r=new et,r.setAttribute("position",new Ee([0,0,0,0,0,1],3)),this.targetLine=new Es(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),XP.setFromMatrixPosition(this.light.matrixWorld),vm.setFromMatrixPosition(this.light.target.matrixWorld),YP.subVectors(vm,XP),this.lightPlane.lookAt(vm),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(vm),this.targetLine.scale.z=YP.length()}}const bm=new D,on=new Bp;class uY extends Cr{constructor(e){const t=new et,i=new ei({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};function a(p,m){l(p),l(m)}function l(p){r.push(0,0,0),s.push(0,0,0),void 0===o[p]&&(o[p]=[]),o[p].push(r.length/3-1)}a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4"),t.setAttribute("position",new Ee(r,3)),t.setAttribute("color",new Ee(s,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new me(16755200),u=new me(16711680),d=new me(43775),h=new me(16777215),f=new me(3355443);this.setColors(c,u,d,h,f)}setColors(e,t,i,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,i.r,i.g,i.b),a.setXYZ(33,i.r,i.g,i.b),a.setXYZ(34,i.r,i.g,i.b),a.setXYZ(35,i.r,i.g,i.b),a.setXYZ(36,i.r,i.g,i.b),a.setXYZ(37,i.r,i.g,i.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap;on.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),dn("c",t,e,on,0,0,-1),dn("t",t,e,on,0,0,1),dn("n1",t,e,on,-1,-1,-1),dn("n2",t,e,on,1,-1,-1),dn("n3",t,e,on,-1,1,-1),dn("n4",t,e,on,1,1,-1),dn("f1",t,e,on,-1,-1,1),dn("f2",t,e,on,1,-1,1),dn("f3",t,e,on,-1,1,1),dn("f4",t,e,on,1,1,1),dn("u1",t,e,on,.7,1.1,-1),dn("u2",t,e,on,-.7,1.1,-1),dn("u3",t,e,on,0,2,-1),dn("cf1",t,e,on,-1,0,1),dn("cf2",t,e,on,1,0,1),dn("cf3",t,e,on,0,-1,1),dn("cf4",t,e,on,0,1,1),dn("cn1",t,e,on,-1,0,-1),dn("cn2",t,e,on,1,0,-1),dn("cn3",t,e,on,0,-1,-1),dn("cn4",t,e,on,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function dn(n,e,t,i,r,s,o){bm.set(r,s,o).unproject(i);const a=e[n];if(void 0!==a){const l=t.getAttribute("position");for(let c=0,u=a.length;c<u;c++)l.setXYZ(a[c],bm.x,bm.y,bm.z)}}const xm=new eo;class dY extends Cr{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),s=new et;s.setIndex(new Dt(i,1)),s.setAttribute("position",new Dt(r,3)),super(s,new ei({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&xm.setFromObject(this.object),xm.isEmpty())return;const t=xm.min,i=xm.max,r=this.geometry.attributes.position,s=r.array;s[0]=i.x,s[1]=i.y,s[2]=i.z,s[3]=t.x,s[4]=i.y,s[5]=i.z,s[6]=t.x,s[7]=t.y,s[8]=i.z,s[9]=i.x,s[10]=t.y,s[11]=i.z,s[12]=i.x,s[13]=i.y,s[14]=t.z,s[15]=t.x,s[16]=i.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=i.x,s[22]=t.y,s[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class hY extends Cr{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new et;s.setIndex(new Dt(i,1)),s.setAttribute("position",new Ee([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(s,new ei({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class fY extends Es{constructor(e,t=1,i=16776960){const r=i,o=new et;o.setAttribute("position",new Ee([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),o.computeBoundingSphere(),super(o,new ei({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const l=new et;l.setAttribute("position",new Ee([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),l.computeBoundingSphere(),this.add(new On(l,new Li({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const KP=new D;let wm,Y0;class pY extends Vt{constructor(e=new D(0,0,1),t=new D(0,0,0),i=1,r=16776960,s=.2*i,o=.2*s){super(),this.type="ArrowHelper",void 0===wm&&(wm=new et,wm.setAttribute("position",new Ee([0,0,0,0,1,0],3)),Y0=new ha(0,.5,1,5,1),Y0.translate(0,-.5,0)),this.position.copy(t),this.line=new Es(wm,new ei({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new On(Y0,new Li({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{KP.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(KP,t)}}setLength(e,t=.2*e,i=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class mY extends Cr{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new et;r.setAttribute("position",new Ee(t,3)),r.setAttribute("color",new Ee([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(r,new ei({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,i){const r=new me,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class gY{constructor(){this.type="ShapePath",this.color=new me,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new gd,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,o){return this.currentPath.bezierCurveTo(e,t,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function i(y,v){const _=v.length;let b=!1;for(let w=_-1,M=0;M<_;w=M++){let C=v[w],x=v[M],S=x.x-C.x,I=x.y-C.y;if(Math.abs(I)>Number.EPSILON){if(I<0&&(C=v[M],S=-S,x=v[w],I=-I),y.y<C.y||y.y>x.y)continue;if(y.y===C.y){if(y.x===C.x)return!0}else{const L=I*(y.x-C.x)-S*(y.y-C.y);if(0===L)return!0;if(L<0)continue;b=!b}}else{if(y.y!==C.y)continue;if(x.x<=y.x&&y.x<=C.x||C.x<=y.x&&y.x<=x.x)return!0}}return b}const r=Xr.isClockWise,s=this.subPaths;if(0===s.length)return[];let o,a,l;const c=[];if(1===s.length)return a=s[0],l=new fa,l.curves=a.curves,c.push(l),c;let u=!r(s[0].getPoints());u=e?!u:u;const d=[],h=[];let m,g,f=[],p=0;h[p]=void 0,f[p]=[];for(let y=0,v=s.length;y<v;y++)a=s[y],m=a.getPoints(),o=r(m),o=e?!o:o,o?(!u&&h[p]&&p++,h[p]={s:new fa,p:m},h[p].s.curves=a.curves,u&&p++,f[p]=[]):f[p].push({h:a,p:m[0]});if(!h[0])return function t(y){const v=[];for(let _=0,b=y.length;_<b;_++){const w=y[_],M=new fa;M.curves=w.curves,v.push(M)}return v}(s);if(h.length>1){let y=!1,v=0;for(let _=0,b=h.length;_<b;_++)d[_]=[];for(let _=0,b=h.length;_<b;_++){const w=f[_];for(let M=0;M<w.length;M++){const C=w[M];let x=!0;for(let S=0;S<h.length;S++)i(C.p,h[S].p)&&(_!==S&&v++,x?(x=!1,d[S].push(C)):y=!0);x&&d[_].push(C)}}v>0&&!1===y&&(f=d)}for(let y=0,v=h.length;y<v;y++){l=h[y].s,c.push(l),g=f[y];for(let _=0,b=g.length;_<b;_++)l.holes.push(g[_].h)}return c}}const Ts=_Y();function _Y(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(i[l]=0,i[256|l]=32768,r[l]=24,r[256|l]=24):c<-14?(i[l]=1024>>-c-14,i[256|l]=1024>>-c-14|32768,r[l]=-c-1,r[256|l]=-c-1):c<=15?(i[l]=c+15<<10,i[256|l]=c+15<<10|32768,r[l]=13,r[256|l]=13):c<128?(i[l]=31744,i[256|l]=64512,r[l]=24,r[256|l]=24):(i[l]=31744,i[256|l]=64512,r[l]=13,r[256|l]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;!(8388608&c);)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}var bY=Object.freeze({__proto__:null,fromHalfFloat:function vY(n){const e=n>>10;return Ts.uint32View[0]=Ts.mantissaTable[Ts.offsetTable[e]+(1023&n)]+Ts.exponentTable[e],Ts.floatView[0]},toHalfFloat:function yY(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=un(n,-65504,65504),Ts.floatView[0]=n;const e=Ts.uint32View[0],t=e>>23&511;return Ts.baseTable[t]+((8388607&e)>>Ts.shiftTable[t])}});class xY extends oo{constructor(e,t,i,r,s,o){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(e,t,i,r,s,o)}}class wY extends _d{constructor(e,t,i,r){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(e,t,i,r)}}class MY extends yd{constructor(e,t,i,r){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(e,t,i,r)}}class SY extends vd{constructor(e,t,i,r,s,o,a){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(e,t,i,r,s,o,a)}}class EY extends ha{constructor(e,t,i,r,s,o,a,l){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(e,t,i,r,s,o,a,l)}}class CY extends bd{constructor(e,t){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(e,t)}}class DY extends Sd{constructor(e,t){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(e,t)}}class AY extends Ed{constructor(e,t){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(e,t)}}class TY extends hc{constructor(e,t,i,r){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(e,t,i,r)}}class IY extends pc{constructor(e,t){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(e,t)}}class RY extends tc{constructor(e,t,i,r){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(e,t,i,r)}}class PY extends Cs{constructor(e,t,i,r){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(e,t,i,r)}}class FY extends Cd{constructor(e,t,i,r,s,o){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(e,t,i,r,s,o)}}class OY extends Dd{constructor(e,t){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(e,t)}}class LY extends mc{constructor(e,t,i,r,s,o,a){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(e,t,i,r,s,o,a)}}class NY extends Ad{constructor(e,t){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(e,t)}}class kY extends Td{constructor(e,t,i,r,s){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(e,t,i,r,s)}}class BY extends Id{constructor(e,t,i,r,s,o){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(e,t,i,r,s,o)}}class VY extends Rd{constructor(e,t,i,r,s){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(e,t,i,r,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:op}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=op);const Mm=new class zY extends Uf{}(class UY extends Vf{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!=i&&i>0||null==i&&this.delay>0?super.requestAsyncId(e,t,i):(e.flush(this),0)}});class $Y extends Lt{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Mw(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new qt;const t=this.getSubject();e.add(this.source.subscribe(Gt(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=qt.EMPTY)}return e}refCount(){return function WY(){return en((n,e)=>{let t=null;n._refCount++;const i=Gt(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}()(this)}}const XY={connector:()=>new wt};function ZP(n,e=XY){const{connector:t}=e;return en((i,r)=>{const s=t();Rn(n(function qY(n){return new Lt(e=>n.subscribe(e))}(s))).subscribe(r),r.add(i.subscribe(s))})}function JP(n,e){const t=st(n)?n:()=>n;return st(e)?ZP(e,{connector:t}):i=>new $Y(i,t)}const QY=(n,e)=>Object.assign(Object.assign({},n),e);function eK(n=new wt,e=new wt,t=new Ru(QY)){const i=Os(n.pipe(jo(),sh(),ka(Mm)),e.pipe(ka(Mm))).pipe(function HY(...n){const e=ug(n);return en((t,i)=>{const r=n.length,s=new Array(r);let o=n.map(()=>!1),a=!1;for(let l=0;l<r;l++)Rn(n[l]).subscribe(Gt(i,c=>{s[l]=c,!a&&!o[l]&&(o[l]=!0,(a=o.every(Fs))&&(o=null))},La));t.subscribe(Gt(i,l=>{if(a){const c=[l,...s];i.next(e?e(...c):c)}}))})}(t.pipe(ka(Mm))),function jY(n,e){return en(function GY(n,e,t,i,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(Gt(o,u=>{const d=c++;l=a?n(l,u,d):(a=!0,u),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}(n,e,arguments.length>=2,!0))}((u,[d,h])=>h(u,d),{}),hs(u=>s.state=u,u=>console.error(u)),ku(u=>Dc),function YY(n){return n?e=>ZP(n)(e):e=>JP(new wt)(e)}()),r=i.pipe(function KY(n,e,t,i){t&&!st(t)&&(i=t);const r=st(t)?t:void 0;return s=>JP(new Pl(n,e,i),r)(s)}(1)),s={state:{},signal$:i,state$:r,nextSlice:function a(u){e.next(u)},nextSliceObservable:function l(u){n.next(u)},nextAccumulator:function o(u){t.next(u)},subscribe:function c(){const u=s.signal$.connect();return u.add(s.state$.connect()),u.add(()=>{t.complete(),n.complete(),e.complete()}),u}};return s}function QP(n){return!!Array.isArray(n)&&n.length>0&&n.every(e=>"function"==typeof e)}function eF(n){return!!Array.isArray(n)&&n.length>0&&n.every(e=>"string"==typeof e)}function Ld(n){return null!=n&&["string","symbol","number"].includes(typeof n)}function tF(n){return null!=n&&"object"==typeof n&&!Array.isArray(n)}function nF(n){return null!=n}function iF(n){return n?1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}:La}function Nd(...n){return e=>e.pipe(jo(),t=>QP(n)?t.pipe(iF(n)):t,li(t=>void 0!==t),jo(),function ZY(n,e,t){let i,r=!1;return n&&"object"==typeof n?({bufferSize:i=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=n):i=n??1/0,Tc({connector:()=>new Pl(i,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}({bufferSize:1,refCount:!0}))}function kd(n,e){if(!nF(n))return n;if(!nF(e))return;const t=(Array.isArray(e)?e:[e]).filter(r=>Ld(r));if(0===t.length||!tF(n)||0===Object.keys(n).length)return;let i=n[t.shift()];return t.forEach(r=>{tF(i)&&Ld(r)&&(i=i[r])}),i}function rF(n,e){return n===e}function sF(n,e){return t=>t.pipe(li(i=>void 0!==i),Nt(i=>{if(null===i)return null;const r=n.filter(s=>i.hasOwnProperty(s)&&void 0!==i[s]);return r.length<n.length?void 0:r.reduce((s,o)=>(s[o]=i[o],s),{})}),li(i=>void 0!==i),function iK(n,e){let t=(i,r)=>n.some(s=>!rF(kd(i,[s]),kd(r,[s])));if(void 0!==e){const i=r=>e.hasOwnProperty(r)&&void 0!==e[r]?e[r]:rF;t=(r,s)=>n.some(o=>!i(o)(kd(r,[o]),kd(s,[o])))}return jo((i,r)=>!t(i,r))}(n,e))}let oK=(()=>{class n{constructor(){this.subscription=new qt,this.accumulator=eK(),this.effectObservable=function sK(n=new wt){const e=Os(n.pipe(sh(),ka(Mm)));return{effects$:e,nextEffectObservable:function t(r){n.next(r)},subscribe:function i(){return e.subscribe()}}}(),this.$=this.accumulator.signal$,this.subscription.add(this.subscribe())}ngOnDestroy(){this.subscription.unsubscribe()}setAccumulator(t){this.accumulator.nextAccumulator(t)}get(...t){const i=Object.keys(this.accumulator.state).length>0;return t&&t.length?kd(this.accumulator.state,t):i?this.accumulator.state:void 0}set(t,i){if("object"!=typeof t||void 0!==i){if("function"!=typeof t||void 0!==i){if(Ld(t)&&"function"==typeof i){const r={};return r[t]=i(this.accumulator.state),void this.accumulator.nextSlice(r)}throw new Error("wrong params passed to set")}this.accumulator.nextSlice(t(this.accumulator.state))}else this.accumulator.nextSlice(t)}connect(t,i,r){if(void 0===r&&void 0===i&&Yo(t))this.accumulator.nextSliceObservable(t);else if(void 0!==r||"function"!=typeof i||!Yo(t)||Yo(i))if(void 0===r&&Ld(t)&&Yo(i)){const s=t,o=i.pipe(Nt(a=>Object.assign({},{[s]:a})));this.accumulator.nextSliceObservable(o)}else{if("function"!=typeof r||!Ld(t)||!Yo(i))throw new Error("wrong params passed to connect");{const s=t,o=i.pipe(Nt(a=>Object.assign({},{[s]:r(this.get(),a)})));this.accumulator.nextSliceObservable(o)}}else{const s=i,o=t.pipe(Nt(a=>s(this.get(),a)));this.accumulator.nextSliceObservable(o)}}select(...t){return this.accumulator.state$.pipe(function rK(...n){return e=>{if(!n||0===n.length)return e.pipe(Nd());if(function tK(n){return"string"==typeof n[0]&&"function"==typeof n[1]}(n))return e.pipe(Nd(Nt(t=>n[1](t[n[0]]))));if(function nK(n){return eF(n[0])&&"function"==typeof n[1]&&(void 0===n[2]||"object"==typeof n[2])}(n))return e.pipe(sF(n[0],n[2]),Nd(Nt(n[1])));if(eF(n))return e.pipe(Nd(function JY(...n){const e=n.length;if(0===e)throw new Error("list of properties cannot be empty.");return Nt(t=>{let i=t;for(let r=0;r<e;r++){const s=i?.[n[r]];if(!(typeof s<"u"))return;i=s}return i})}(...n)));if(QP(n))return e.pipe(Nd(iF(n)));throw new Error("wrong params passed to select")}}(...t))}hold(t,i){const r=t.pipe(ku(s=>Dc));this.effectObservable.nextEffectObservable("function"!=typeof i?r:r.pipe(hs(i)))}subscribe(){const t=new qt;return t.add(this.accumulator.subscribe()),t.add(this.effectObservable.subscribe()),t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ce({token:n,factory:n.\u0275fac}),n})();const aF=["glCanvas"],lK=["portalContentAnchor"];function cK(n,e){if(1&n){const t=nf();pt(0,"ngt-portal-before-render",2),pn("beforeRender",function(r){return Co(t),Do(as().onBeforeRender(r))}),Ot()}if(2&n){const t=as();fn("renderPriority",t.autoRenderPriority)("parentScene",t.parentScene)("parentCamera",t.parentCamera)}}const lF={};function Bd(n){if(n)return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId;const e=Db.generateUUID();return lF[e]?Bd():(lF[e]=!0,e)}function Z0(n,e){const t=e?.devicePixelRatio||1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}const Sm=new Map;function Em(n,e,t,i){const r=Yo(e)?e:Ri(e),s=_t(Zn);return r.pipe(Nt(o=>{const l=new(n(o));return t&&t(l),[(Array.isArray(o)?o:"string"==typeof o?[o]:Object.values(o)).map(u=>(Sm.has(u)||Sm.set(u,Mo(l.loadAsync(u,i)).pipe(hs(d=>{d.scene&&Object.assign(d,function hK(n){const e={nodes:{},materials:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),"material"in t&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}(d.scene))}),function yW(n=1/0){let e;e=n&&"object"==typeof n?n:{count:n};const{count:t=1/0,delay:i,resetOnSuccess:r=!1}=e;return t<=0?Fs:en((s,o)=>{let l,a=0;const c=()=>{let u=!1;l=s.subscribe(Gt(o,d=>{r&&(a=0),o.next(d)},void 0,d=>{if(a++<t){const h=()=>{l?(l.unsubscribe(),l=null,c()):u=!0};if(null!=i){const f="number"==typeof i?Fv(i):Rn(i(d,a)),p=Gt(o,()=>{p.unsubscribe(),h()},()=>{o.complete()});f.subscribe(p)}else h()}else o.error(d)})),u&&(l.unsubscribe(),l=null,c())};c()})}(2),ku(d=>(console.error(`[NGT] Error loading ${u}: ${d.message}`),Ri([]))),Tc({connector:()=>new Pl(1)}))),Sm.get(u))),o]}),tp(([o,a])=>Ev(o).pipe(Nt(l=>{if(Array.isArray(a))return l;if("string"==typeof a)return l[0];const c=Object.keys(a);return c.reduce((u,d)=>(u[d]=l[c.indexOf(d)],u),{})}),hs(()=>{requestAnimationFrame(()=>s.detectChanges())}))))}Em.destroy=()=>{Sm.clear()},Em.preLoad=(n,e,t)=>{Em(n,e,t).pipe(fs(1)).subscribe()};const cF=Em,uF=new Set,dF=new Set,hF=new Set;function Q0(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function Vd(n,e){switch(n){case"before":return Q0(uF,e);case"after":return Q0(dF,e);case"tail":return Q0(hF,e)}}function ex(n,e,t){const i=e.get();let r=i.clock.getDelta();"never"===i.frameloop&&"number"==typeof n&&(r=n-i.clock.elapsedTime,i.clock.oldTime=i.clock.elapsedTime,i.clock.elapsedTime=n);for(let s=0;s<i.internal.subscribers.length;s++)i.internal.subscribers[s].callback({...i,delta:r,frame:t});return!i.internal.priority&&i.gl.render&&i.gl.render(i.scene,i.camera),i.internal.frames=Math.max(0,i.internal.frames-1),"always"===i.frameloop?1:i.internal.frames}const ct={obj:n=>n===Object(n)&&!Array.isArray(n)&&"function"!=typeof n,material:n=>!!n&&n.isMaterial,geometry:n=>!!n&&n.isBufferGeometry,orthographicCamera:n=>!!n&&n.isOrthographicCamera,perspectiveCamera:n=>!!n&&n.isPerspectiveCamera,camera:n=>!!n&&n.isCamera,renderer:n=>!!n&&n instanceof Wp,scene:n=>!!n&&n.isScene,object3D:n=>!!n&&n.isObject3D,instance:n=>!!n&&!!n.__ngt__,ref:n=>n instanceof Tt,equ(n,e,{arrays:t="shallow",objects:i="reference",strict:r=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if("string"==typeof n||"number"==typeof n)return n===e;const s=ct.obj(n);if(s&&"reference"===i)return n===e;const o=Array.isArray(n);if(o&&"reference"===t)return n===e;if((o||s)&&n===e)return!0;let a;for(a in n)if(!(a in e))return!1;for(a in r?e:n)if(n[a]!==e[a])return!1;if(void 0===a){if(o&&0===n.length&&0===e.length||s&&0===Object.keys(n).length&&0===Object.keys(e).length)return!0;if(n!==e)return!1}return!0}};function fF(n){null!==n&&ct.obj(n)&&"needsUpdate"in n&&(n.needsUpdate=!0,"uniformsNeedUpdate"in n&&(n.uniformsNeedUpdate=!0))}function pF(n){ct.object3D(n)&&n.updateMatrix(),ct.camera(n)&&((ct.perspectiveCamera(n)||ct.orthographicCamera(n))&&n.updateProjectionMatrix(),n.updateMatrixWorld()),fF(n)}function tx(n,e){n.manual||(ct.orthographicCamera(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function ut(n){return n&&n.__ngt__||{}}function Ud(n){const e=ut(n).store?.get();e&&0===e.internal.frames&&e.invalidate(),pF(n)}function zd(n,e){const t="function"==typeof n?n():n;if(e?.primitive||!t.__ngt__){const{objects:i=new Ru([]),nonObjects:r=new Ru([]),...s}=e||{};t.__ngt__={previousAttach:null,store:null,parent:null,memoized:{},eventCount:0,handlers:{},objects:i,nonObjects:r,add:(o,a)=>{const l=t.__ngt__[a].value,c=l.indexOf(u=>u===o);c>-1?(l.splice(c,1,o),t.__ngt__[a].next(l)):t.__ngt__[a].next([...t.__ngt__[a].value,o]),nx(t.__ngt__.parent)},remove:(o,a)=>{t.__ngt__[a].next(t.__ngt__[a].value.filter(l=>l!==o)),nx(t.__ngt__.parent)},...s}}return t}function nx(n){if(!n)return;const e=ut(n);e.objects&&e.objects.next(e.objects.value),e.nonObjects&&e.nonObjects.next(e.nonObjects.value),nx(e.parent)}function Sa(n,e){if(!Object.keys(e).length)return n;const t=ut(n),i=t.store?.get(),r=function pK(n,e){const t=Object.entries(e),i=[];for(const[r,s]of t)ct.equ(s,n[r])||i.push([r,s]);return i}(n,e);for(let o=0;o<r.length;o++){const a=r[o][0],l=n,c=l[a],u=r[o][1];if(c&&c.set&&(c.copy||c instanceof ca)){const d=c instanceof me;if(Array.isArray(u))c.fromArray?c.fromArray(u):c.set(...u);else if(c.copy&&u&&u.constructor&&c.constructor.name===u.constructor.name)c.copy(u),!yn&&!i.linear&&d&&c.convertSRGBToLinear();else if(void 0!==u){const h=c instanceof me;!h&&c.setScalar?c.setScalar(u):c instanceof ca&&u instanceof ca?c.mask=u.mask:c.set(u),!yn&&!i?.linear&&h&&c.convertSRGBToLinear()}}else l[a]=u,!i?.linear&&l[a]instanceof Hn&&(l[a].encoding=mt);pF(c),Ud(n)}return t.parent&&i.internal&&n.raycast&&t.eventCount!=t.eventCount&&(i.removeInteraction(n.uuid),t.eventCount&&i.addInteraction(n)),t.parent&&t.afterUpdate&&t.afterUpdate.observed&&r.length&&t.afterUpdate.emit(n),n}let ix=(()=>{class n extends oK{constructor(){super(),this.cache={},this.set({__ngt_dummy__:"__ngt_dummy__"}),this.initialize();const t=this.set.bind(this);Object.defineProperty(this,"set",{get:()=>(...i)=>{const r=i[0];if(ct.obj(r)){const s=Object.entries(r).reduce((o,[a,l])=>(o[a]=void 0===l?this.get(a):l,o),{});return t(s)}return t(...i)}})}initialize(){}effect(t,i){return this.hold(t.pipe(function mK(n){let i,e=()=>{},t=!1;const r=s=>()=>{e&&e({prev:i,complete:!0,error:s})};return hs({next:s=>{e&&t&&e({prev:i,complete:!1,error:!1});const o=n(s);o&&(e=o),i=s,t||(t=!0)},complete:r(!1),unsubscribe:r(!1),error:r(!0)})}(i)))}triggerChangeDetection(t,i=[]){let r=this.$;i.length&&(r=AT(i.map(s=>this.select(s).pipe(Wo(this.get(s)??void 0))))),this.hold(r,()=>{requestAnimationFrame(()=>{t.detectChanges()})})}key$(...t){const i=t.join(".");return this.cache[i]||(this.cache[i]=this.select(...t).pipe(Wo(this.get(...t)??void 0),jo())),this.cache[i]}ngOnDestroy(){this.cache={},super.ngOnDestroy()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ce({token:n,factory:n.\u0275fac}),n})();const rx=new Map,{invalidate:sx,advance:mF}=function fK(n){let t,i,e=!1;function r(a){i=requestAnimationFrame(r),e=!0,t=0,Vd("before",a);for(const l of n.values()){const c=l.get();c.internal.active&&("always"===c.frameloop||c.internal.frames>0)&&!c.gl.xr?.isPresenting&&(t+=ex(a,l))}if(Vd("after",a),0===t)return Vd("tail",a),e=!1,cancelAnimationFrame(i)}return{loop:r,invalidate:function s(a,l=1){const c=a?.get();if(!c)return n.forEach(u=>s(u,l));c.gl.xr?.isPresenting||!c.internal.active||"never"===c.frameloop||(c.internal.frames=Math.min(60,c.internal.frames+l),e||(e=!0,requestAnimationFrame(r)))},advance:function o(a,l=!0,c,u){const d=c?.get();if(l&&Vd("before",a),d)ex(a,c,u);else for(const h of n.values())ex(a,h);l&&Vd("after",a)}}}(rx),xc={objects:"shallow",strict:!1};let Ir=(()=>{class n extends ix{constructor(){super(...arguments),this.parentStore=_t(n,{optional:!0,skipSelf:!0}),this.window=_t(at).defaultView,this.isInit=!1}init(){if(!this.isInit){const t=new D,i=new D,r=new D,s=(c=this.get("camera"),u=i,d=this.get("size"))=>{const{width:h,height:f,top:p,left:m}=d,g=h/f;u instanceof D?r.copy(u):r.set(...u);const y=c.getWorldPosition(t).distanceTo(r);if(ct.orthographicCamera(c))return{width:h/c.zoom,height:f/c.zoom,top:p,left:m,factor:1,distance:y,aspect:g};const v=c.fov*Math.PI/180,_=2*Math.tan(v/2)*y,b=_*g;return{width:b,height:_,top:p,left:m,factor:h/b,distance:y,aspect:g}},o=new ee;let a;const l=c=>{this.set(u=>({performance:{...u.performance,current:c}}))};this.set({get:this.get.bind(this),set:this.set.bind(this),select:this.select.bind(this),ready:!1,scene:zd(new Xp,{store:this}),events:{priority:1,enabled:!0,connected:!1},invalidate:(c=1)=>sx(this,c),advance:(c,u)=>mF(c,u,this),legacy:!1,linear:!1,flat:!1,controls:null,clock:new H0,pointer:o,frameloop:"always",performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const c=this.get();a&&clearTimeout(a),c.performance.current!==c.performance.min&&l(c.performance.min),a=setTimeout(()=>l(this.get("performance","max")||1),c.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:s},previousStore:this.parentStore,internal:{active:!1,priority:0,frames:0,lastEvent:null,interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(c,u=0,d=this)=>{const h=this.get("internal");return h.priority=h.priority+(u>0?1:0),h.subscribers.push({priority:u,store:d,callback:c}),h.subscribers.sort((f,p)=>(f.priority||0)-(p.priority||0)),()=>{const f=this.get("internal");f?.subscribers&&(f.priority=f.priority-(u>0?1:0),f.subscribers=f.subscribers.filter(p=>p.callback!==c))}}},setEvents:c=>{this.set(u=>({events:{...u.events,...c}}))},setSize:(c,u,d,h)=>{const f=this.get("camera"),p={width:c,height:u,top:d||0,left:h||0};this.set(m=>({size:p,viewport:{...m.viewport,...s(f,i,p)}}))},setDpr:c=>{const u=Z0(c,this.window);this.set(d=>({viewport:{...d.viewport,dpr:u,initialDpr:d.viewport.initialDpr||u}}))},setFrameloop:(c="always")=>{const u=this.get("clock");u.stop(),u.elapsedTime=0,"never"!==c&&(u.start(),u.elapsedTime=0),this.set({frameloop:c})},addInteraction:c=>{this.set(u=>({internal:{...u.internal,interaction:[...u.internal.interaction,c]}}))},removeInteraction:c=>{this.set(u=>({internal:{...u.internal,interaction:u.internal.interaction.filter(d=>d.uuid!==c)}}))}}),this.isInit=!0,this.resize()}}configure(t,i){const{gl:r,size:s,camera:o,raycaster:a,events:l,orthographic:c,lookAt:u,shadows:d,linear:h,legacy:f,flat:p,dpr:m,frameloop:g,performance:y}=t,v=this.get(),_={};let b=v.gl;v.gl||(_.gl=b=function dK(n,e){const t="function"==typeof n?n(e):n;return null!=t?.render?t:new Wp({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n||{}})}(r,i));let w=v.raycaster;w||(_.raycaster=w=new $0);const{params:M,...C}=a||{};if(ct.equ(C,w,xc)||Sa(w,{...C}),ct.equ(M,w.params,xc)||Sa(w,{params:{...w.params,...M||{}}}),!v.camera){const L=ct.camera(o);let k=L?o:function uK(n,e){return n?new nc(0,0,0,0,.1,1e3):new An(75,e.width/e.height,.1,1e3)}(c||!1,v.size);L||(o&&Sa(k,o),o?.position||(k.position.z=5),o?.rotation||(Array.isArray(u)?k.lookAt(u[0],u[1],u[2]):u instanceof D?k.lookAt(u):k.lookAt(0,0,0)),k.updateProjectionMatrix()),ct.instance(k)||(k=zd(k,{store:this})),_.camera=k}if(!v.xr){const L=(R,j)=>{"never"!==this.get().frameloop&&mF(R,!0,this,j)},k=()=>{const R=this.get();R.gl.xr.enabled=R.gl.xr.isPresenting,R.gl.xr.setAnimationLoop(R.gl.xr.isPresenting?L:null),R.gl.xr.isPresenting||sx(this)},P={connect:()=>{b.xr.addEventListener("sessionstart",k),b.xr.addEventListener("sessionend",k)},disconnect:()=>{b.xr.removeEventListener("sessionstart",k),b.xr.removeEventListener("sessionend",k)}};b.xr&&P.connect(),_.xr=P}if(b.shadowMap){const L="boolean"==typeof d;if(L&&b.shadowMap.enabled!==d||!ct.equ(d,b.shadowMap,xc)){const k=b.shadowMap.enabled;b.shadowMap.enabled=!!d,L?b.shadowMap.type=Gv:Object.assign(b.shadowMap,d),k!==b.shadowMap.enabled&&fF(b.shadowMap)}}yn&&(yn.legacyMode=f??!0);const x=h?gs:mt,S=p?vr:Zv;b.outputEncoding!==x&&(b.outputEncoding=x),b.toneMapping!==S&&(b.toneMapping=S),v.legacy!==f&&(_.legacy=f),v.linear!==h&&(_.linear=h),v.flat!==p&&(_.flat=p),b.setClearAlpha(0),b.setPixelRatio(Z0(v.viewport.dpr)),b.setSize(v.size.width,v.size.height),ct.obj(r)&&"function"!=typeof r&&!ct.renderer(r)&&!ct.equ(r,b,xc)&&Sa(b,r),l&&!v.events.handlers&&(_.events=l(this)),y&&!ct.equ(y,v.performance,xc)&&(_.performance={...v.performance,...y}),this.set(_),m&&v.viewport.dpr!==Z0(m)&&v.setDpr(m);const I=function gK(n,e){if(e)return e;if(n instanceof HTMLCanvasElement&&n.parentElement){const{width:t,height:i,top:r,left:s}=n.parentElement.getBoundingClientRect();return{width:t,height:i,top:r,left:s}}return{width:0,height:0,top:0,left:0}}(i,s);ct.equ(I,v.size,xc)||v.setSize(I.width,I.height,I.top,I.left),v.frameloop!==g&&v.setFrameloop(g),this.get("ready")||this.set({ready:!0}),this.invalidate()}destroy(t){this.set(i=>({internal:{...i.internal,active:!1}})),setTimeout(()=>{const{gl:i,xr:r,events:s}=this.get();i&&(s.disconnect&&s.disconnect(),i.renderLists.dispose(),i.forceContextLoss(),i.xr&&i.xr.enabled&&(i.xr.setAnimationLoop(null),r.disconnect()),function _K(n){n.dispose&&!ct.scene(n)&&n.dispose();for(const e in n)e.dispose?.(),delete n[e]}(this.get()),rx.delete(t))},500)}resize(){const t=this.get();let i=t.size,r=t.viewport.dpr,s=t.camera;this.hold(this.select(sF(["camera","size","viewport","gl"])),()=>{const{camera:o,size:a,viewport:l,gl:c,set:u}=this.get();(a!==i||l.dpr!==r)&&(i=a,r=l.dpr,tx(o,a),c.setPixelRatio(l.dpr),c.setSize(a.width,a.height)),o!==s&&(tx(o,a),s=o,u(d=>({viewport:{...d.viewport,...d.viewport.getCurrentViewport(o)}})))})}invalidate(){this.hold(this.select(),()=>sx(this))}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=nn(n)))(i||n)}}(),n.\u0275prov=Ce({token:n,factory:n.\u0275fac}),n})();const gF=new he("NgtCompoundPrefixes"),_F={},vK=new he("THREE Constructors Catalogue",{factory:()=>_F});let bK=(()=>{class n{constructor(){this.vcr=_t(Kn),this.template=_t(qi),this.injected=!1,this.shouldCreateView=!0;const t=this.vcr.element.nativeElement;t.__ngt_renderer_add_comment__&&(t.__ngt_renderer_add_comment__(),delete t.__ngt_renderer_add_comment__)}createView(){this.shouldCreateView&&(this.view&&!this.view.destroyed&&this.view.destroy(),this.view=this.vcr.createEmbeddedView(this.template),this.view.detectChanges())}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=De({type:n}),n})(),yF=(()=>{class n extends bK{constructor(){super(...arguments),this.injectedArgs=[]}set args(t){null==t||!Array.isArray(t)||1===t.length&&null===t[0]||(this.injected=!1,this.injectedArgs=t,this.createView())}get args(){return this.validate()?(this.injected=!0,this.injectedArgs):null}validate(){return!this.injected&&!!this.injectedArgs.length}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=nn(n)))(i||n)}}(),n.\u0275dir=De({type:n,selectors:[["","args",""]],inputs:{args:"args"},standalone:!0,features:[Xe]}),n})();function vF(n,e,t,i){const r=t.get(e);r&&(t.delete(e),0===t.size&&(n.delete(i),r.target.releasePointerCapture(i)))}function bF(n,e){const t=n.get("internal");t.interaction=t.interaction.filter(i=>i!==e),t.initialHits=t.initialHits.filter(i=>i!==e),t.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((i,r)=>{vF(t.capturedMap,e,i,r)}),n.get("previousStore")&&bF(n.get("previousStore"),e)}function Cm(n,e,t=[]){const[i,...r]=t;i&&(0===r.length?Sa(n,{[i]:e}):(function MK(n,e){(!Object.hasOwn(n,e)&&Reflect&&Reflect.has&&!Reflect.has(n,e)||void 0===n[e])&&(n[e]={})}(n,i),Cm(n[i],e,r)))}const ax_BEFORE_RENDER="beforeRender",ax_AFTER_UPDATE="afterUpdate",ax_AFTER_ATTACH="afterAttach";function lx(n,e){const t=ut(n),i=ut(e);if(!t||!i)throw new Error("[NGT] THREE instances need to be prepared with local state.");let r=!1;if((!i.store||i.store===t.store.get("previousStore"))&&(i.store=t.store),i.attach){const s=i.attach;if("function"==typeof s){const o=s(n,e,i.store);o&&(i.previousAttach=o)}else{if("none"===s[0])return void Ud(e);if("material"===s[0]&&s[1]&&"number"==typeof Number(s[1])&&ct.material(e)&&!Array.isArray(n.material)&&(n.material=[]),i.isRaw){if(i.parent=n,void 0===e.__ngt_renderer__[10])return;Cm(n,e.__ngt_renderer__[10],s)}else Cm(n,e,s);i.previousAttach=s.reduce((o,a)=>o[a],n)}}else ct.object3D(n)&&ct.object3D(e)&&(n.add(e),r=!0);t.add(e,r?"objects":"nonObjects"),i.parent=n,i.afterAttach&&i.afterAttach.emit({parent:n,node:e}),Ud(e),Ud(n)}function cx(n,e,t){const i=ut(n),r=ut(e);r.parent=null,i.objects&&i.remove(e,"objects"),i.nonObjects&&i.remove(e,"nonObjects"),r.attach?function wK(n,e,t){const i=ut(e);Array.isArray(t)?Cm(n,i.previousAttach,t):i.previousAttach()}(n,e,r.attach):ct.object3D(n)&&ct.object3D(e)&&(n.remove(e),bF(r.store||i.store,e));const s=r.primitive;s||(xF(r.objects?.value||[],e,!!t),xF(e.childre,e,!!t)),!s&&e.dispose&&!ct.scene(e)&&queueMicrotask(()=>e.dispose()),Ud(n)}function xF(n,e,t){n&&[...n].forEach(i=>cx(e,i,t))}function EK(n,e,t){return i=>{n(i),t&&t.detectChanges(),e.detectChanges()}}class DK{constructor(e){this.root=e,this.comments=[]}createNode(e,t){const i=[e,null,[],!1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],r=Object.assign(t,{__ngt_renderer__:i});return r.ownerDocument||(r.ownerDocument=this.root.document),"three"!==i[0]&&(i[13]=()=>Sl(r).injector),"comment"===i[0]?(r.__ngt_renderer_add_comment__=s=>{s&&"portal"===s.__ngt_renderer__[0]?this.portals.push(s):this.comments.push(r)},r):("compound"===i[0]&&(i[7]=new Set,i[8]={},i[9]={}),r)}setParent(e,t){e.__ngt_renderer__[1]||(e.__ngt_renderer__[1]=t)}addChild(e,t){e.__ngt_renderer__[2].includes(t)||e.__ngt_renderer__[2].push(t)}removeChild(e,t){const i=e.__ngt_renderer__[2].findIndex(r=>t===r);i>=0&&e.__ngt_renderer__[2].splice(i,1)}setCompound(e,t){const i=e.__ngt_renderer__;i[6]=t;const r=Object.keys(i[8]),s=Object.keys(i[9]);if(r.length)for(const o of r)this.applyAttribute(t,o,i[8][o]);if(s.length)for(const o of s)this.applyProperty(t,o,i[9][o]);this.executeOperation(e)}queueOperation(e,t){e.__ngt_renderer__[7].add(t)}executeOperation(e,t="op"){const i=e.__ngt_renderer__;i[7]?.size&&i[7].forEach(r=>{r[0]===t&&(r[1](),i[7].delete(r))})}processPortalContainer(e){const i=(0,e.__ngt_renderer__[13])?.();if(!i)return;const r=i.get(Ir,null);if(!r)return;const s=r.get("scene");s&&(e.__ngt_renderer__[12]=this.createNode("three",s))}applyAttribute(e,t,i){const r=e.__ngt_renderer__;if(!r[3]){if("priority"===t){let s=Number(i);isNaN(s)&&(s=0,console.warn('[NGT] "priority" is an invalid number, default to 0')),ut(e).priority=s}if("ngtCompound"===t)return void(r[4]=[""===i||"first"===i,{}]);if("attach"===t){const s=i.split(".");return void(s.length&&(ut(e).attach=s))}if("rawValue"===t){let s=i;return""===s||"true"===s||"false"===s?s="true"===s||""===s:isNaN(Number(s))||(s=Number(s)),void(r[10]=s)}Sa(e,{[t]:i})}}applyProperty(e,t,i){const r=e.__ngt_renderer__;if(r[3])return;if("ref"===t&&ct.ref(i))return r[11]=i,void(i.nativeElement=e);const s=ut(e).parent||r[1];if(ut(e).isRaw&&"rawValue"===t)return r[10]=i,void(s&&lx(s,e));if("attach"===t)return ut(e).attach=Array.isArray(i)?i.map(a=>a.toString()):i,void(s&&lx(s,e));const o=r[4];o?.[1]&&t in o[1]&&!o[0]&&(i=o[1][t]),Sa(e,{[t]:i})}isCompound(e){return this.root.compoundPrefixes.some(t=>e.startsWith(t))}isDOM(e){const t=e.__ngt_renderer__;return!t||"compound"!==t[0]&&(e instanceof Element||e instanceof Document||e instanceof Window)}get rootScene(){return this.root.store.get("scene")}get rootCdr(){return this.root.cdr}get portals(){return this.root.portals}getClosestParentWithInstance(e){let t=e.__ngt_renderer__[1];for(;t&&"three"!==t.__ngt_renderer__[0];)t=t.__ngt_renderer__[12]?t.__ngt_renderer__[12]:t.__ngt_renderer__[1];return t}getClosestParentWithCompound(e){if(e.__ngt_renderer__[5])return e.__ngt_renderer__[5];let t=e.__ngt_renderer__[1];if(t&&"compound"===t.__ngt_renderer__[0]&&!t.__ngt_renderer__[6])return t;for(;t&&("three"===t.__ngt_renderer__[0]||!t.__ngt_renderer__[5]||"compound"!==t.__ngt_renderer__[0]);)t=t.__ngt_renderer__[1];return t?"three"===t.__ngt_renderer__[0]&&t.__ngt_renderer__[5]?t.__ngt_renderer__[5]:t.__ngt_renderer__[6]?null:t:void 0}getCreationState(){return{injectedArgs:this.firstNonInjectedDirective(yF)?.args||[],store:this.tryGetPortalStore()}}destroy(e,t){const i=e.__ngt_renderer__;if(!i[3]){if("three"===i[0]){i[4]=void 0,i[5]=void 0;const r=ut(e);r.objects&&(r.objects.value.forEach(s=>this.destroy(s,t)),r.objects.complete()),r.nonObjects&&(r.nonObjects.value.forEach(s=>this.destroy(s,t)),r.nonObjects.complete()),r.afterUpdate&&r.afterUpdate.complete(),r.afterAttach&&r.afterAttach.complete(),delete r.objects,delete r.nonObjects,delete r.add,delete r.remove,delete r.afterUpdate,delete r.afterAttach,delete r.store,delete r.handlers,r.primitive||delete e.__ngt__}if("comment"===i[0]){i[13]=null,delete e.__ngt_renderer_add_comment__;const r=this.comments.findIndex(s=>s===e);r>-1&&this.comments.splice(r,1)}if("portal"===i[0]){i[13]=null;const r=this.portals.findIndex(s=>s===e);r>-1&&this.portals.splice(r,1)}"compound"===i[0]&&(i[6]=void 0,i[8]=null,i[9]=null,this.executeOperation(e,"cleanUp"),i[7].clear(),i[7]=null),i[11]&&(i[11].nativeElement=null,i[11]=void 0),i[1]=null;for(const r of i[2]||[])"three"===r.__ngt_renderer__[0]&&t&&cx(t,r,!0),this.destroy(r,t);i[2]=[],i[3]=!0,t&&this.removeChild(t,e)}}firstNonInjectedDirective(e){let t,i=this.comments.length-1;for(;i>=0;){const r=this.comments[i];if(r.__ngt_renderer__[3]){i--;continue}const s=r.__ngt_renderer__[13]();if(!s){i--;continue}const o=s.get(e,null);if(o&&o.validate()){t=o;break}i--}return t}tryGetPortalStore(){let e,t=this.portals.length-1;for(;t>=0;){const i=this.portals[t];if(i.__ngt_renderer__[3]){t--;continue}const r=i.__ngt_renderer__[13]();if(!r){t--;continue}const s=r.get(Ir,null);if(s&&s.get("previousStore")){e=s;break}t--}return e||this.root.store}}let AK=(()=>{class n{constructor(){this.delegateRendererFactory=_t(Lo,{skipSelf:!0}),this.cdr=_t(Zn),this.store=_t(Ir),this.catalogue=_t(vK),this.compoundPrefixes=_t(gF),this.document=_t(at),this.rendererMap=new Map,this.portals=[],this.rendererStore=new DK({store:this.store,cdr:this.cdr,portals:this.portals,compoundPrefixes:this.compoundPrefixes,document:this.document})}createRenderer(t,i){const r=this.delegateRendererFactory.createRenderer(t,i);if(!i)return r;let s=this.rendererMap.get(i.id);return s||(s=new TK(r,this.rendererStore,this.catalogue,!t),this.rendererMap.set(i.id,s)),s}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ce({token:n,factory:n.\u0275fac}),n})();class TK{constructor(e,t,i,r=!0){this.delegate=e,this.store=t,this.catalogue=i,this.root=r,this.createText=this.delegate.createText.bind(this.delegate),this.destroy=this.delegate.destroy.bind(this.delegate),this.destroyNode=null,this.selectRootElement=this.delegate.selectRootElement.bind(this.delegate),this.nextSibling=this.delegate.nextSibling.bind(this.delegate),this.removeAttribute=this.delegate.removeAttribute.bind(this.delegate),this.addClass=this.delegate.addClass.bind(this.delegate),this.removeClass=this.delegate.removeClass.bind(this.delegate),this.setStyle=this.delegate.setStyle.bind(this.delegate),this.removeStyle=this.delegate.removeStyle.bind(this.delegate),this.setValue=this.delegate.setValue.bind(this.delegate)}createElement(e,t){const i=this.delegate.createElement(e,t);if(this.root){this.root=!1;const c=this.store.createNode("three",this.store.rootScene);return c.__ngt_renderer__[13]=()=>Sl(i).injector,c}if(this.store.isCompound(e))return this.store.createNode("compound",i);if("ngt-portal"===e)return this.store.createNode("portal",i);if("ngt-value"===e)return this.store.createNode("three",Object.assign({__ngt_renderer__:{rawValue:void 0}},{__ngt__:{isRaw:!0}}));const{injectedArgs:r,store:s}=this.store.getCreationState();if("ngt-primitive"===e){if(!r[0])throw new Error("[NGT] ngt-primitive without args is invalid");const c=r[0];let u=ut(c);return Object.keys(u).length||(zd(c,{store:s,args:r,primitive:!0}),u=ut(c)),u.store||(u.store=s),this.store.createNode("three",c)}const a=function CK(n){return n.split("-").map(i=>i.charAt(0).toUpperCase()+i.slice(1)).join("")}(e.startsWith("ngt")?e.slice(4):e),l=this.catalogue[a];if(l){const c=zd(new l(...r),{store:s,args:r}),u=this.store.createNode("three",c),d=ut(c);return ct.geometry(c)?d.attach=["geometry"]:ct.material(c)&&(d.attach=["material"]),u}return this.store.createNode("dom",i)}createComment(e){return this.store.createNode("comment",this.delegate.createComment(e))}appendChild(e,t){if(t instanceof Text)return;const i=t.__ngt_renderer__,r=e.__ngt_renderer__;if("comment"!==i[0]){if(this.store.setParent(t,e),this.store.addChild(e,t),"portal"===i[0])return this.store.processPortalContainer(t),void(i[12]&&this.appendChild(e,i[12]));if("portal"===r[0])return this.store.processPortalContainer(e),void(r[12]&&this.appendChild(r[12],t));if("three"!==r[0]||"three"!==i[0]){if("three"===r[0])for(const o of i[2])this.appendChild(e,o);if("compound"===r[0]&&(!r[6]&&"three"===i[0]&&(i[4]?this.store.setCompound(e,t):i[5]||(i[5]=e)),r[6]&&"three"===i[0]&&i[4]&&r[6]!==t&&this.store.setCompound(e,t)),"three"===i[0]&&!ut(t).parent||("dom"===r[0]||"compound"===r[0]&&!r[6])&&("dom"===i[0]||"compound"===i[0]&&!i[6])){const o=this.store.getClosestParentWithInstance(e);o&&this.appendChild(o,t)}}else{if(ut(t).parent||(lx(e,t),!i[4]))return;const o=this.store.getClosestParentWithCompound(e);if(!o)return;this.appendChild(o,t)}}else this.store.setParent(t,e)}insertBefore(e,t){!e.__ngt_renderer__||e===t||this.appendChild(e,t)}removeChild(e,t,i){const r=e.__ngt_renderer__;if("three"===r[0]&&"three"===t.__ngt_renderer__[0])return cx(e,t,!0),void this.store.destroy(t,e);if("compound"===r[0]&&r[1])return void this.removeChild(r[1],t,i);if("three"===r[0])return void this.store.destroy(t,e);const o=this.store.getClosestParentWithInstance(e);o&&this.removeChild(o,t,i),this.store.destroy(t,o)}parentNode(e){const t=e.__ngt_renderer__;return t?.[1]?t[1]:this.delegate.parentNode(e)}setAttribute(e,t,i,r){const s=e.__ngt_renderer__;if("compound"===s[0])return s[8][t]=i,s[6]?void this.setAttribute(s[6],t,i,r):void this.store.queueOperation(e,["op",()=>this.setAttribute(e,t,i,r)]);"three"===s[0]&&this.store.applyAttribute(e,t,i)}setProperty(e,t,i){const r=e.__ngt_renderer__;if("compound"===r[0])return r[9][t]=i,r[6]?(r[6].__ngt_renderer__[4]&&Object.assign(r[6].__ngt_renderer__[4],{props:{...r[6].__ngt_renderer__[4],[t]:i}}),void this.setProperty(r[6],t,i)):void this.store.queueOperation(e,["op",()=>this.setProperty(e,t,i)]);"three"===r[0]&&this.store.applyProperty(e,t,i)}listen(e,t,i){const r=e.__ngt_renderer__,s=r?.[13]?.().get(Zn,null),o=a=>{const l=i(a);return s&&s.detectChanges(),this.store.rootCdr.detectChanges(),l};if(this.store.isDOM(e))return this.delegate.listen(e,t,o);if(e===this.store.rootScene){let[a,l]=t.split(":");return null==l&&(l=a,a=""),this.delegate.listen("window"===a?e.ownerDocument.defaultView:e.ownerDocument,l,o)}return"three"===r[0]||"compound"===r[0]&&r[6]?function SK(n,e,t,i,r,s){const o=ut(n);if(t===ax_BEFORE_RENDER)return o.store.get("internal").subscribe(c=>i({state:c,object:n}),e||o.priority||0);if(t===ax_AFTER_UPDATE||t===ax_AFTER_ATTACH){o[t]||(o[t]=new It);const c=o[t]?.subscribe(i);return c.unsubscribe.bind(c)}o.handlers||(o.handlers={});const a=o.handlers[t];return o.handlers={...o.handlers,[t]:EK(c=>{a&&a(c),i(c)},r,s)},o.eventCount+=1,1===o.eventCount&&n.raycast&&o.store.get("addInteraction")(n),()=>{const c=ut(n);c&&c.eventCount&&c.store.get("removeInteraction")(n.uuid)}}(r[6]||e,ut(e).priority||0,t,i,this.store.rootCdr,s):("compound"===r[0]&&!r[6]&&this.store.queueOperation(e,["op",()=>this.store.queueOperation(e,["cleanUp",this.listen(e,t,i)])]),()=>{})}get data(){return this.delegate.data}}function IK({store:n,changeDetectorRef:e,compoundPrefixes:t=[]}){return t.includes("ngts")||t.push("ngts"),t.includes("ngtp")||t.push("ngtp"),function G2(n){return{\u0275providers:n}}([{provide:Lo,useClass:AK},{provide:Ir,useValue:n},{provide:Zn,useValue:e},{provide:gF,useValue:t}])}const wF={click:!1,contextmenu:!1,dblclick:!1,wheel:!1,pointerdown:!0,pointerup:!0,pointerleave:!0,pointermove:!0,pointercancel:!0,lostpointercapture:!0};function RK(n){const{handlePointer:e}=function xK(n){function t(l){return l.filter(c=>["move","over","enter","out","leave"].some(u=>{const d=`pointer${u}`;return ut(c).handlers?.[d]}))}function s(l){const{internal:c}=n.get();for(const u of c.hovered.values())if(!l.length||!l.find(d=>d.object===u.object&&d.index===u.index&&d.instanceId===u.instanceId)){const h=ut(u.eventObject),f=h?.handlers;if(c.hovered.delete(Bd(u)),h?.eventCount){const p={...u,intersections:l};f?.pointerout?.(p),f?.pointerleave?.(p)}}}function o(l,c){for(let u=0;u<c.length;u++)ut(c[u])?.handlers.pointermissed?.(l)}return{handlePointer:function a(l){switch(l){case"pointerleave":case"pointercancel":return()=>s([]);case"lostpointercapture":return c=>{const{internal:u}=n.get();"pointerId"in c&&u.capturedMap.has(c.pointerId)&&(u.capturedMap.delete(c.pointerId),s([]))}}return function(u){const{onPointerMissed:d,internal:h}=n.get();h.lastEvent=u;const f="pointermove"===l,p="click"===l||"contextmenu"===l||"dblclick"===l,g=function i(l,c){const u=n.get(),d=new Set,h=[],f=c?c(u.internal.interaction):u.internal.interaction;for(let g=0;g<f.length;g++){const y=ut(f[g]).store?.get();y&&(y.raycaster.camera=void 0)}u.previousStore||u.events.compute?.(l,n);let m=f.flatMap(function p(g){const v=ut(g).store,_=v?.get();return _&&_.events.enabled&&null!==_.raycaster.camera?(void 0===_.raycaster.camera&&(_.events.compute?.(l,v,_.previousStore),void 0===_.raycaster.camera&&(_.raycaster.camera=null)),_.raycaster.camera?_.raycaster.intersectObject(g,!0):[]):[]}).sort((g,y)=>{const v=ut(g.object).store.get(),_=ut(y.object).store.get();return v&&_&&_.events.priority-v.events.priority||g.distance-y.distance}).filter(g=>{const y=Bd(g);return!d.has(y)&&(d.add(y),!0)});u.events.filter&&(m=u.events.filter(m,n));for(const g of m){let y=g.object;for(;y;)ut(y).eventCount&&h.push({...g,eventObject:y}),y=y.parent}if("pointerId"in l&&u.internal.capturedMap.has(l.pointerId))for(const g of u.internal.capturedMap.get(l.pointerId).values())d.has(Bd(g.intersection))||h.push(g.intersection);return h}(u,f?t:void 0),y=p?function e(l){const c=n.get("internal"),u=l.offsetX-c.initialClick[0],d=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(u*u+d*d))}(u):0;"pointerdown"===l&&(h.initialClick=[u.offsetX,u.offsetY],h.initialHits=g.map(_=>_.eventObject)),p&&!g.length&&y<=2&&(o(u,h.interaction),d&&d(u)),f&&s(g),function r(l,c,u,d){const h=n.get();if(l.length){const f={stopped:!1};for(const p of l){const m=ut(p.object).store?.get()||h,{raycaster:g,pointer:y,camera:v,internal:_}=m,b=new D(y.x,y.y,0).unproject(v),w=I=>_.capturedMap.get(I)?.has(p.eventObject)??!1,M=I=>{const L={intersection:p,target:c.target};_.capturedMap.has(I)?_.capturedMap.get(I).set(p.eventObject,L):_.capturedMap.set(I,new Map([[p.eventObject,L]])),c.target.setPointerCapture(I)},C=I=>{const L=_.capturedMap.get(I);L&&vF(_.capturedMap,p.eventObject,L,I)},x={};for(const I in c){const L=c[I];"function"!=typeof L&&(x[I]=L)}const S={...p,...x,pointer:y,intersections:l,stopped:f.stopped,delta:u,unprojectedPoint:b,ray:g.ray,camera:v,stopPropagation(){const I="pointerId"in c&&_.capturedMap.get(c.pointerId);(!I||I.has(p.eventObject))&&(S.stopped=f.stopped=!0,_.hovered.size&&Array.from(_.hovered.values()).find(L=>L.eventObject===p.eventObject))&&s([...l.slice(0,l.indexOf(p)),p])},target:{hasPointerCapture:w,setPointerCapture:M,releasePointerCapture:C},currentTarget:{hasPointerCapture:w,setPointerCapture:M,releasePointerCapture:C},nativeEvent:c};if(d(S),!0===f.stopped)break}}}(g,u,y,function v(_){const b=_.eventObject,w=ut(b),M=w?.handlers;if(w?.eventCount)if(f){if(M?.pointerover||M?.pointerenter||M?.pointerout||M?.pointerleave){const C=Bd(_),x=h.hovered.get(C);x?x.stopped&&_.stopPropagation():(h.hovered.set(C,_),M.pointerover?.(_),M.pointerenter?.(_))}M?.pointermove?.(_)}else{const C=M?.[l];C?(!p||h.initialHits.includes(b))&&(o(u,h.interaction.filter(x=>!h.initialHits.includes(x))),C(_)):p&&h.initialHits.includes(b)&&o(u,h.interaction.filter(x=>!h.initialHits.includes(x)))}})}}}}(n);return{priority:1,enabled:!0,compute:(t,i)=>{const r=i.get();r.pointer.set(t.offsetX/r.size.width*2-1,-t.offsetY/r.size.height*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(wF).reduce((t,i)=>(t[i]=e(i),t),{}),connect:t=>{const i=n.get();i.events.disconnect?.(),i.setEvents({connected:t}),Object.entries(i.events.handlers??{}).forEach(([r,s])=>{t.addEventListener(r,s,{passive:wF[r]})})},disconnect:()=>{const{events:t,setEvents:i}=n.get();t.connected&&(Object.entries(t.handlers??{}).forEach(([r,s])=>{t.connected instanceof HTMLElement&&t.connected.removeEventListener(r,s)}),i({connected:void 0}))}}}let MF=(()=>{class n extends ix{constructor(){super(...arguments),this.cdr=_t(Zn),this.envInjector=_t(Oo),this.host=_t(Tt),this.store=_t(Ir),this.hostClass=!0,this.sceneGraphInputs={},this.compoundPrefixes=[],this.created=new It,this.pointerMissed=new It}initialize(){super.initialize(),this.set({shadows:!1,linear:!1,flat:!1,legacy:!1,orthographic:!1,frameloop:"always",dpr:[1,2],events:RK})}get pointerEvents(){return this.get("eventSource")!==this.host.nativeElement?"none":"auto"}set linear(t){this.set({linear:t})}set legacy(t){this.set({legacy:t})}set flat(t){this.set({flat:t})}set orthographic(t){this.set({orthographic:t})}set frameloop(t){this.set({frameloop:t})}set dpr(t){this.set({dpr:t})}set raycaster(t){this.set({raycaster:t})}set shadows(t){this.set({shadows:t})}set camera(t){this.set({camera:t})}set gl(t){this.set({gl:t})}set eventSource(t){this.set({eventSource:t})}set eventPrefix(t){this.set({eventPrefix:t})}set lookAt(t){this.set({lookAt:t})}set performance(t){this.set({performance:t})}ngOnChanges(t){t.sceneGraphInputs&&this.glRef&&this.setSceneGraphInputs()}ngOnInit(){this.get("eventSource")||(this.eventSource=this.host.nativeElement),this.pointerMissed.observed&&this.store.set({onPointerMissed:t=>{this.pointerMissed.emit(t),this.cdr.detectChanges()}}),this.store.init(),rx.set(this.glCanvas.nativeElement,this.store),this.hold(this.store.select("ready").pipe(li(t=>t)),()=>this.storeReady())}onResize({width:t,height:i}){t>0&&i>0&&(this.store.isInit||this.store.init(),this.store.configure(this.get(),this.glCanvas.nativeElement))}storeReady(){this.store.set(r=>({internal:{...r.internal,active:!0}}));const t=this.get(),i=this.store.get();i.events.connect?.(ct.ref(t.eventSource)?t.eventSource.nativeElement:t.eventSource),t.eventPrefix&&i.setEvents({compute:(r,s)=>{const o=s.get();o.pointer.set(r[t.eventPrefix+"X"]/o.size.width*2-1,-r[t.eventPrefix+"Y"]/o.size.height*2+1),o.raycaster.setFromCamera(o.pointer,o.camera)}}),this.created.observed&&(this.created.emit(this.store.get()),this.cdr.detectChanges()),this.glRef&&this.glRef.destroy(),requestAnimationFrame(()=>{this.glEnvInjector=ly([IK({store:this.store,changeDetectorRef:this.cdr,compoundPrefixes:this.compoundPrefixes})],this.envInjector),this.glRef=this.glAnchor.createComponent(this.sceneGraph,{environmentInjector:this.glEnvInjector}),this.glRef.changeDetectorRef.detach(),this.setSceneGraphInputs(),this.overrideDetectChanges(),this.cdr.detectChanges()})}ngOnDestroy(){this.glRef&&this.glRef.destroy(),this.glEnvInjector&&this.glEnvInjector.destroy(),cF.destroy(),this.store.destroy(this.glCanvas.nativeElement),super.ngOnDestroy()}overrideDetectChanges(){const t=this.cdr.detectChanges.bind(this.cdr);this.cdr.detectChanges=()=>{t(),this.glRef?.changeDetectorRef.detectChanges()}}setSceneGraphInputs(){for(const t of Object.keys(this.sceneGraphInputs))this.glRef?.setInput(t,this.sceneGraphInputs[t]);this.cdr.detectChanges()}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=nn(n)))(i||n)}}(),n.\u0275cmp=Gi({type:n,selectors:[["ngt-canvas"]],viewQuery:function(t,i){if(1&t&&(Us(aF,7),Us(aF,7,Kn)),2&t){let r;Xi(r=Yi())&&(i.glCanvas=r.first),Xi(r=Yi())&&(i.glAnchor=r.first)}},hostVars:4,hostBindings:function(t,i){2&t&&(af("pointer-events",i.pointerEvents),Ii("ngt-canvas",i.hostClass))},inputs:{sceneGraph:"sceneGraph",sceneGraphInputs:"sceneGraphInputs",compoundPrefixes:"compoundPrefixes",linear:"linear",legacy:"legacy",flat:"flat",orthographic:"orthographic",frameloop:"frameloop",dpr:"dpr",raycaster:"raycaster",shadows:"shadows",camera:"camera",gl:"gl",eventSource:"eventSource",eventPrefix:"eventPrefix",lookAt:"lookAt",performance:"performance"},outputs:{created:"created",pointerMissed:"pointerMissed"},standalone:!0,features:[Ct([Ir,pW({emitInZone:!1})]),Xe,Or,hu],decls:3,vars:0,consts:[[2,"height","100%","width","100%",3,"ngxResize"],[2,"display","block"],["glCanvas",""]],template:function(t,i){1&t&&(pt(0,"div",0),pn("ngxResize",function(s){return i.onResize(s)}),Yn(1,"canvas",1,2),Ot())},dependencies:[mW],styles:["[_nghost-%COMP%]{display:block;position:relative;width:100%;height:100%;overflow:hidden}"]}),n})();function PK(n){if(n)try{n.context&&n.detectChanges()}catch{n.markForCheck()}}function FK(n=null){const e=ct.ref(n)?n:new Tt(n);let t=e.nativeElement;const i=[],r=new Ru(t),{destroy$:s,cdr:o}=function SF(n){try{const e=_t(Zn),t=new Pl;return queueMicrotask(()=>{e.onDestroy(()=>{t.next(),t.complete(),n?.()})}),{destroy$:t,cdr:e}}catch{throw new Error("[NGT] injectNgtDestroy is being called outside of Constructor Context")}}(()=>{r.complete()});i.push(o);const a=r.asObservable().pipe(jo(),Qi(s)),c=a.pipe(li((d,h)=>h>0||null!=d),Qi(s));return Object.defineProperty(e,"nativeElement",{set:d=>{if(e.nativeElement!==d){r.next(d),t=e.nativeElement,e.nativeElement=d;const h=[...i];for(let f=0;f<h.length;f++){const p=h[f];p.destroyed?i.splice(f,1):PK(p)}}},get:()=>r.value}),Object.assign(e,{subscribe:d=>a.subscribe(h=>{d(h,t),t=h}),$:c,children$:(d="objects")=>c.pipe(tp(h=>{const f=ut(h);return f.objects&&f.nonObjects?Os(f.objects,f.nonObjects).pipe(Nt(()=>{try{return"both"===d?[...f.objects.value,...f.nonObjects.value]:f[d].value}catch{return console.error(`[NGT] Exception in accessing children of ${h}`),[]}})):Ri([])}),li((h,f)=>f>0||h.length>0),Qi(s)),useCDR:d=>{i.push(d)}})}let LK=(()=>{class n{constructor(){this.cdr=_t(Zn),this.parentCdr=_t(Zn,{skipSelf:!0,optional:!0})}transform(t,i=null){if(this.obj===t)return this.latestValue;if(this.obj=t,this.latestValue=i,this.sub&&this.sub.unsubscribe(),Yo(this.obj))this.sub=this.obj.subscribe(this.updateValue.bind(this));else{if(!function OK(n){return(n instanceof Promise||"[object Promise]"===Object.prototype.toString.call(n))&&"function"==typeof n.then}(this.obj))throw new Error("[NGT] Invalid value passed to ngtPush pipe");this.obj.then(this.updateValue.bind(this))}return this.latestValue}updateValue(t){this.latestValue=t,this.cdr.detectChanges(),this.parentCdr&&this.parentCdr.detectChanges()}ngOnDestroy(){this.sub&&this.sub.unsubscribe(),this.latestValue=void 0,this.obj=void 0}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=ni({name:"ngtPush",type:n,pure:!1,standalone:!0}),n})();var Dm,ux;const NK=["get","set","select","setSize","setDpr","setFrameloop","events","invalidate","advance","size","viewport","addInteraction","removeInteraction"];let kK=(()=>{class n{constructor(){this.portalStore=_t(Ir),this.renderPriority=1,this.beforeRender=new It}ngOnInit(){let t;this.subscription=this.portalStore.get("internal").subscribe(({delta:i,frame:r})=>{this.beforeRender.emit({...this.portalStore.get(),delta:i,frame:r});const{gl:s,scene:o,camera:a}=this.portalStore.get();t=s.autoClear,1===this.renderPriority&&(s.autoClear=!0,s.render(this.parentScene,this.parentCamera)),s.autoClear=!1,s.clearDepth(),s.render(o,a),s.autoClear=t},this.renderPriority,this.portalStore)}ngOnDestroy(){this.subscription?.()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=De({type:n,selectors:[["ngt-portal-before-render"]],inputs:{renderPriority:"renderPriority",parentScene:"parentScene",parentCamera:"parentCamera"},outputs:{beforeRender:"beforeRender"},standalone:!0}),n})(),BK=(()=>{class n{constructor(t,i){const r=t.element.nativeElement;r.__ngt_renderer_add_comment__&&(r.__ngt_renderer_add_comment__(i.element.nativeElement),delete r.__ngt_renderer_add_comment__)}}return n.\u0275fac=function(t){return new(t||n)(U(Kn),U(Kn,4))},n.\u0275dir=De({type:n,selectors:[["ng-template","ngtPortalContent",""]],standalone:!0}),n})();class Hd extends ix{constructor(){super(...arguments),Dm.add(this),this.autoRender=!0,this.autoRenderPriority=1,this.beforeRender=new It,this.parentStore=_t(Ir,{skipSelf:!0}),this.parentScene=this.parentStore.get("scene"),this.parentCamera=this.parentStore.get("camera"),this.portalStore=_t(Ir,{self:!0}),this.raycaster=new $0,this.pointer=new ee,this.portalContentRendered=!1}set container(e){this.set({container:e})}set state(e){this.set({state:e})}initialize(){super.initialize(),this.set({container:FK(zd(new Xp))})}ngOnInit(){const e=this.parentStore.get(),t=this.get();!t.state&&this.autoRender&&(t.state={events:{priority:this.autoRenderPriority+1}});const{events:i,size:r,...s}=t.state||{},o=t.container,a=ct.ref(o)?o.nativeElement:o,l=ut(a);l.store||(l.store=this.portalStore),this.portalStore.set({...e,scene:a,raycaster:this.raycaster,pointer:this.pointer,previousStore:this.parentStore,events:{...e.events,...i||{}},size:{...e.size,...r||{}},...s,get:this.portalStore.get.bind(this.portalStore),set:this.portalStore.set.bind(this.portalStore),select:this.portalStore.select.bind(this.portalStore),setEvents:c=>this.portalStore.set(u=>({...u,events:{...u.events,...c}}))}),this.hold(this.parentStore.select(),c=>this.portalStore.set(u=>Dw(this,Dm,"m",ux).call(this,c,u))),requestAnimationFrame(()=>{this.portalStore.set(c=>Dw(this,Dm,"m",ux).call(this,this.parentStore.get(),c))}),this.portalContentView=this.portalContentAnchor.createEmbeddedView(this.portalContentTemplate),this.portalContentView.detectChanges(),this.portalContentRendered=!0}onBeforeRender(e){this.beforeRender.emit({root:{...this.parentStore.get(),delta:e.delta,frame:e.frame},portal:e})}ngOnDestroy(){this.portalContentView&&!this.portalContentView.destroyed&&this.portalContentView.destroy(),super.ngOnDestroy()}}function CF(n,e){if(e===CI)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===_p||e===Mb){let t=n.getIndex();if(null===t){const o=[],a=n.getAttribute("position");if(void 0===a)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}const i=t.count-2,r=[];if(e===_p)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}Dm=new WeakSet,ux=function(e,t){const i={...e};Object.keys(i).forEach(c=>{(NK.includes(c)||e[c]!==t[c])&&delete i[c]});const r=this.get(),{size:s,events:o,...a}=r.state||{};let l;if(t&&s){const c=t.camera;l=e.viewport.getCurrentViewport(c,new D,s),c!==e.camera&&tx(c,s)}return{...i,scene:ct.ref(r.container)?r.container.nativeElement:r.container,raycaster:this.raycaster,pointer:this.pointer,previousStore:this.parentStore,events:{...e.events,...t?.events||{},...o},size:{...e.size,...s},viewport:{...e.viewport,...l||{}},...a}},Hd.\u0275fac=function(){let n;return function(t){return(n||(n=nn(Hd)))(t||Hd)}}(),Hd.\u0275cmp=Gi({type:Hd,selectors:[["ngt-portal"]],contentQueries:function(e,t,i){if(1&e&&mu(i,BK,7,qi),2&e){let r;Xi(r=Yi())&&(t.portalContentTemplate=r.first)}},viewQuery:function(e,t){if(1&e&&Us(lK,7,Kn),2&e){let i;Xi(i=Yi())&&(t.portalContentAnchor=i.first)}},inputs:{container:"container",state:"state",autoRender:"autoRender",autoRenderPriority:"autoRenderPriority"},outputs:{beforeRender:"beforeRender"},standalone:!0,features:[Ct([Ir]),Xe,hu],decls:3,vars:1,consts:[["portalContentAnchor",""],[3,"renderPriority","parentScene","parentCamera","beforeRender",4,"ngIf"],[3,"renderPriority","parentScene","parentCamera","beforeRender"]],template:function(e,t){1&e&&(ef(0,null,0),su(2,cK,1,3,"ngt-portal-before-render",1),tf()),2&e&&(yi(2),fn("ngIf",t.autoRender&&t.portalContentRendered))},dependencies:[Xy,kK],encapsulation:2});class VK extends wi{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new jK(t)}),this.register(function(t){return new ZK(t)}),this.register(function(t){return new JK(t)}),this.register(function(t){return new $K(t)}),this.register(function(t){return new qK(t)}),this.register(function(t){return new XK(t)}),this.register(function(t){return new YK(t)}),this.register(function(t){return new GK(t)}),this.register(function(t){return new KK(t)}),this.register(function(t){return new WK(t)}),this.register(function(t){return new zK(t)}),this.register(function(t){return new QK(t)}),this.register(function(t){return new eZ(t)})}load(e,t,i,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:bc.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new Tr(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={},l=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===DF){try{o[gt.KHR_BINARY_GLTF]=new tZ(e)}catch(d){return void(r&&r(d))}s=JSON.parse(o[gt.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const c=new pZ(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const d=this.pluginCallbacks[u](c);a[d.name]=d,o[d.name]=!0}if(s.extensionsUsed)for(let u=0;u<s.extensionsUsed.length;++u){const d=s.extensionsUsed[u],h=s.extensionsRequired||[];switch(d){case gt.KHR_MATERIALS_UNLIT:o[d]=new HK;break;case gt.KHR_DRACO_MESH_COMPRESSION:o[d]=new nZ(s,this.dracoLoader);break;case gt.KHR_TEXTURE_TRANSFORM:o[d]=new iZ;break;case gt.KHR_MESH_QUANTIZATION:o[d]=new rZ;break;default:h.indexOf(d)>=0&&void 0===a[d]&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function UK(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const gt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class zK{constructor(e){this.parser=e,this.name=gt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const u=new me(16777215);void 0!==l.color&&u.fromArray(l.color);const d=void 0!==l.range?l.range:0;switch(l.type){case"directional":c=new U0(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new V0(u),c.distance=d;break;case"spot":c=new k0(u),c.distance=d,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,po(c,l),void 0!==l.intensity&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),t.cache.add(i,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(l){return i._getNodeRef(t.cache,a,l)})}}class HK{constructor(){this.name=gt.KHR_MATERIALS_UNLIT}getMaterialType(){return Li}extendParams(e,t,i){const r=[];e.color=new me(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(i.assignTexture(e,"map",s.baseColorTexture,mt))}return Promise.all(r)}}class GK{constructor(e){this.parser=e,this.name=gt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class jK{constructor(e){this.parser=e,this.name=gt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Ds:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new ee(a,a)}return Promise.all(s)}}class WK{constructor(e){this.parser=e,this.name=gt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Ds:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class $K{constructor(e){this.parser=e,this.name=gt.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Ds:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new me(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];return void 0!==o.sheenColorFactor&&t.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,mt)),void 0!==o.sheenRoughnessTexture&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class qK{constructor(e){this.parser=e,this.name=gt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Ds:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class XK{constructor(e){this.parser=e,this.name=gt.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Ds:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new me(a[0],a[1],a[2]),Promise.all(s)}}class YK{constructor(e){this.parser=e,this.name=gt.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Ds:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class KK{constructor(e){this.parser=e,this.name=gt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?Ds:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new me(a[0],a[1],a[2]),void 0!==o.specularColorTexture&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,mt)),Promise.all(s)}}class ZK{constructor(e){this.parser=e,this.name=gt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class JK{constructor(e){this.parser=e,this.name=gt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class QK{constructor(e){this.name=gt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const u=r.count,d=r.byteStride,h=new Uint8Array(a,r.byteOffset||0,r.byteLength||0);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(u,d,h,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){const f=new ArrayBuffer(u*d);return o.decodeGltfBuffer(new Uint8Array(f),u,d,h,r.mode,r.filter),f})})}return null}}class eZ{constructor(e){this.name=gt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const r=t.meshes[i.mesh];for(const c of r.primitives)if(c.mode!==ir.TRIANGLES&&c.mode!==ir.TRIANGLE_STRIP&&c.mode!==ir.TRIANGLE_FAN&&void 0!==c.mode)return null;const o=i.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(u=>(l[c]=u,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const u=c.pop(),d=u.isGroup?u.children:[u],h=c[0].count,f=[];for(const p of d){const m=new He,g=new D,y=new Qn,v=new D(1,1,1),_=new d0(p.geometry,p.material,h);for(let b=0;b<h;b++)l.TRANSLATION&&g.fromBufferAttribute(l.TRANSLATION,b),l.ROTATION&&y.fromBufferAttribute(l.ROTATION,b),l.SCALE&&v.fromBufferAttribute(l.SCALE,b),_.setMatrixAt(b,m.compose(g,y,v));for(const b in l)"TRANSLATION"!==b&&"ROTATION"!==b&&"SCALE"!==b&&p.geometry.setAttribute(b,l[b]);Vt.prototype.copy.call(_,p),_.frustumCulled=!1,this.parser.assignFinalMaterial(_),f.push(_)}return u.isGroup?(u.clear(),u.add(...f),u):f[0]}))}}const DF="glTF";class tZ{constructor(e){this.name=gt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==DF)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,s=new DataView(e,12);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const l=s.getUint32(o,!0);if(o+=4,1313821514===l){const c=new Uint8Array(e,12+o,a);this.content=i.decode(c)}else if(5130562===l){const c=12+o;this.body=e.slice(c,c+a)}o+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class nZ{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=gt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const u in o){const d=fx[u]||u.toLowerCase();a[d]=o[u]}for(const u in e.attributes){const d=fx[u]||u.toLowerCase();if(void 0!==o[u]){const h=i.accessors[e.attributes[u]];c[d]=wc[h.componentType].name,l[d]=!0===h.normalized}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(d){r.decodeDracoFile(u,function(h){for(const f in h.attributes){const m=l[f];void 0!==m&&(h.attributes[f].normalized=m)}d(h)},a,c)})})}}class iZ{constructor(){this.name=gt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class rZ{constructor(){this.name=gt.KHR_MESH_QUANTIZATION}}class TF extends gc{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=2*a,c=3*a,u=r-t,d=(i-t)/u,h=d*d,f=h*d,p=e*c,m=p-c,g=-2*f+3*h,y=f-h,v=1-g,_=y-h+d;for(let b=0;b!==a;b++)s[b]=v*o[m+b+a]+_*(o[m+b+l]*u)+g*o[p+b+a]+y*(o[p+b]*u);return s}}const sZ=new Qn;class oZ extends TF{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return sZ.fromArray(s).normalize().toArray(s),s}}const ir={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},wc={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},IF={9728:sn,9729:Jt,9984:$u,9985:cp,9986:Nl,9987:$r},RF={33071:zn,33648:Ll,10497:Ys},hx={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},fx={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},fo={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},aZ={CUBICSPLINE:void 0,LINEAR:ea,STEP:Bl};function jd(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function po(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function uZ(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function dZ(n){const e=n.extensions&&n.extensions[gt.KHR_DRACO_MESH_COMPRESSION];let t;return t=e?"draco:"+e.bufferView+":"+e.indices+":"+PF(e.attributes):n.indices+":"+PF(n.attributes)+":"+n.mode,t}function PF(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function mx(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const fZ=new He;class pZ{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new UK,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||i||r&&s<98?new xP(this.options.manager):new FP(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Tr(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};jd(s,a,r),po(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(i[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const l=this.associations.get(o);null!=l&&this.associations.set(a,l);for(const[c,u]of o.children.entries())s(u,a.children[c])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[gt.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(bc.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteOffset||0;return i.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const o=hx[r.type],l=!0===r.normalized,c=new(0,wc[r.componentType])(r.count*o);return Promise.resolve(new Dt(c,o,l))}const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=hx[r.type],c=wc[r.componentType],u=c.BYTES_PER_ELEMENT,h=r.byteOffset||0,f=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,p=!0===r.normalized;let m,g;if(f&&f!==u*l){const y=Math.floor(h/f),v="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+y+":"+r.count;let _=t.cache.get(v);_||(m=new c(a,y*f,r.count*f/u),_=new ld(m,f/u),t.cache.add(v,_)),g=new lo(_,l,h%f/u,p)}else m=null===a?new c(r.count*l):new c(a,h,r.count*l),g=new Dt(m,l,p);if(void 0!==r.sparse){const b=r.sparse.values.byteOffset||0,w=new(0,wc[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*hx.SCALAR),M=new c(o[2],b,r.sparse.count*l);null!==a&&(g=new Dt(g.array.slice(),g.itemSize,g.normalized));for(let C=0,x=w.length;C<x;C++){const S=w[C];if(g.setX(S,M[C*l]),l>=2&&g.setY(S,M[C*l+1]),l>=3&&g.setZ(S,M[C*l+2]),l>=4&&g.setW(S,M[C*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=this.options.manager.getHandler(o.uri);null!==l&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,i).then(function(u){u.flipY=!1,u.name=o.name||a.name||"";const h=(s.samplers||{})[o.sampler]||{};return u.magFilter=IF[h.magFilter]||Jt,u.minFilter=IF[h.minFilter]||$r,u.wrapS=RF[h.wrapS]||Ys,u.wrapT=RF[h.wrapT]||Ys,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(d=>d.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(void 0!==o.bufferView)l=this.getDependency("bufferView",o.bufferView).then(function(d){c=!0;const h=new Blob([d],{type:o.mimeType});return l=a.createObjectURL(h),l});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(d){return new Promise(function(h,f){let p=h;!0===t.isImageBitmapLoader&&(p=function(m){const g=new Hn(m);g.needsUpdate=!0,h(g)}),t.load(bc.resolveURL(d,s.path),p,void 0,f)})}).then(function(d){return!0===c&&a.revokeObjectURL(l),d.userData.mimeType=o.mimeType||function hZ(n){return n.search(/\.jpe?g($|\?)/i)>0||0===n.search(/^data\:image\/jpeg/)?"image/jpeg":n.search(/\.webp($|\?)/i)>0||0===n.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),d});return this.sourceCache[e]=u,u}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(void 0!==i.texCoord&&0!=i.texCoord&&!("aoMap"===t&&1==i.texCoord)&&console.warn("THREE.GLTFLoader: Custom UV set "+i.texCoord+" for texture "+t+" not yet supported."),s.extensions[gt.KHR_TEXTURE_TRANSFORM]){const a=void 0!==i.extensions?i.extensions[gt.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[gt.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return void 0!==r&&(o.encoding=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new nm,Dn.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new ei,Dn.prototype.copy.call(l,i),l.color.copy(i.color),this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}i.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=i}getMaterialType(){return Pd}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},c=[];if((s.extensions||{})[gt.KHR_MATERIALS_UNLIT]){const d=r[gt.KHR_MATERIALS_UNLIT];o=d.getMaterialType(),c.push(d.extendParams(a,s,t))}else{const d=s.pbrMetallicRoughness||{};if(a.color=new me(1,1,1),a.opacity=1,Array.isArray(d.baseColorFactor)){const h=d.baseColorFactor;a.color.fromArray(h),a.opacity=h[3]}void 0!==d.baseColorTexture&&c.push(t.assignTexture(a,"map",d.baseColorTexture,mt)),a.metalness=void 0!==d.metallicFactor?d.metallicFactor:1,a.roughness=void 0!==d.roughnessFactor?d.roughnessFactor:1,void 0!==d.metallicRoughnessTexture&&(c.push(t.assignTexture(a,"metalnessMap",d.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",d.metallicRoughnessTexture))),o=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=Wr);const u=s.alphaMode||"OPAQUE";if("BLEND"===u?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===u&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==Li&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new ee(1,1),void 0!==s.normalTexture.scale)){const d=s.normalTexture.scale;a.normalScale.set(d,d)}return void 0!==s.occlusionTexture&&o!==Li&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==Li&&(a.emissive=(new me).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&o!==Li&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,mt)),Promise.all(c).then(function(){const d=new o(a);return s.name&&(d.name=s.name),po(d,s),t.associations.set(d,{materials:e}),s.extensions&&jd(r,d,s),d})}createUniqueName(e){const t=Ut.sanitizeNodeName(e||"");let i=t;for(let r=1;this.nodeNamesUsed[i];++r)i=t+"_"+r;return this.nodeNamesUsed[i]=!0,i}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[gt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return FF(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],u=dZ(c),d=r[u];if(d)o.push(d.promise);else{let h;h=c.extensions&&c.extensions[gt.KHR_DRACO_MESH_COMPRESSION]?s(c):FF(new et,c,t),r[u]={primitive:c,promise:h},o.push(h)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const u=void 0===o[l].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new Pd({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:jr})),n.DefaultMaterial):this.getDependency("material",o[l].material);a.push(u)}var n;return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],d=[];for(let f=0,p=u.length;f<p;f++){const m=u[f],g=o[f];let y;const v=c[f];if(g.mode===ir.TRIANGLES||g.mode===ir.TRIANGLE_STRIP||g.mode===ir.TRIANGLE_FAN||void 0===g.mode)y=!0===s.isSkinnedMesh?new u0(m,v):new On(m,v),!0===y.isSkinnedMesh&&!y.geometry.attributes.skinWeight.normalized&&y.normalizeSkinWeights(),g.mode===ir.TRIANGLE_STRIP?y.geometry=CF(y.geometry,Mb):g.mode===ir.TRIANGLE_FAN&&(y.geometry=CF(y.geometry,_p));else if(g.mode===ir.LINES)y=new Cr(m,v);else if(g.mode===ir.LINE_STRIP)y=new Es(m,v);else if(g.mode===ir.LINE_LOOP)y=new f0(m,v);else{if(g.mode!==ir.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);y=new m0(m,v)}Object.keys(y.geometry.morphAttributes).length>0&&uZ(y,s),y.name=t.createUniqueName(s.name||"mesh_"+e),po(y,s),g.extensions&&jd(r,y,g),t.assignFinalMaterial(y),d.push(y)}for(let f=0,p=d.length;f<p;f++)t.associations.set(d[f],{meshes:e,primitives:f});if(1===d.length)return d[0];const h=new Ss;t.associations.set(h,{meshes:e});for(let f=0,p=d.length;f<p;f++)h.add(d[f]);return h})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new An(Db.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new nc(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),po(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this.getDependency("node",t.joints[r]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,u=o.length;c<u;c++){const d=o[c];if(d){a.push(d);const h=new He;null!==s&&h.fromArray(s.array,16*c),l.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new hd(a,l)})}loadAnimation(e){const i=this.json.animations[e],r=[],s=[],o=[],a=[],l=[];for(let c=0,u=i.channels.length;c<u;c++){const d=i.channels[c],h=i.samplers[d.sampler],f=d.target,m=void 0!==i.parameters?i.parameters[h.input]:h.input,g=void 0!==i.parameters?i.parameters[h.output]:h.output;r.push(this.getDependency("node",f.node)),s.push(this.getDependency("accessor",m)),o.push(this.getDependency("accessor",g)),a.push(h),l.push(f)}return Promise.all([Promise.all(r),Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[0],d=c[1],h=c[2],f=c[3],p=c[4],m=[];for(let y=0,v=u.length;y<v;y++){const _=u[y],b=d[y],w=h[y],M=f[y],C=p[y];if(void 0===_)continue;let x;switch(_.updateMatrix(),fo[C.path]){case fo.weights:x=_c;break;case fo.rotation:x=co;break;default:x=yc}const S=_.name?_.name:_.uuid,I=void 0!==M.interpolation?aZ[M.interpolation]:ea,L=[];fo[C.path]===fo.weights?_.traverse(function(P){P.morphTargetInfluences&&L.push(P.name?P.name:P.uuid)}):L.push(S);let k=w.array;if(w.normalized){const P=mx(k.constructor),R=new Float32Array(k.length);for(let j=0,O=k.length;j<O;j++)R[j]=k[j]*P;k=R}for(let P=0,R=L.length;P<R;P++){const j=new x(L[P]+"."+fo[C.path],b.array,k,I);"CUBICSPLINE"===M.interpolation&&(j.createInterpolant=function(G){return new(this instanceof co?oZ:TF)(this.times,this.values,this.getValueSize()/3,G)},j.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),m.push(j)}}return new vc(i.name?i.name:"animation_"+e,void 0,m)})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const i=this.extensions,r=this,s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"";return function(){const a=[],l=r._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});l&&a.push(l),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(h){return r._getNodeRef(r.cameraCache,s.camera,h)})),r._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){a.push(h)});const c=[],u=s.children||[];for(let h=0,f=u.length;h<f;h++)c.push(r.getDependency("node",u[h]));const d=void 0===s.skin?Promise.resolve(null):r.getDependency("skin",s.skin);return Promise.all([Promise.all(a),Promise.all(c),d])}().then(function(a){const l=a[0],c=a[1],u=a[2];let d;if(d=!0===s.isBone?new Qp:l.length>1?new Ss:1===l.length?l[0]:new Vt,d!==l[0])for(let h=0,f=l.length;h<f;h++)d.add(l[h]);if(s.name&&(d.userData.name=s.name,d.name=o),po(d,s),s.extensions&&jd(i,d,s),void 0!==s.matrix){const h=new He;h.fromArray(s.matrix),d.applyMatrix4(h)}else void 0!==s.translation&&d.position.fromArray(s.translation),void 0!==s.rotation&&d.quaternion.fromArray(s.rotation),void 0!==s.scale&&d.scale.fromArray(s.scale);r.associations.has(d)||r.associations.set(d,{}),r.associations.get(d).nodes=e,null!==u&&d.traverse(function(h){h.isSkinnedMesh&&h.bind(u,fZ)});for(let h=0,f=c.length;h<f;h++)d.add(c[h]);return d})}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new Ss;i.name&&(s.name=r.createUniqueName(i.name)),po(s,i),i.extensions&&jd(t,s,i);const o=i.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let u=0,d=l.length;u<d;u++)s.add(l[u]);return r.associations=(u=>{const d=new Map;for(const[h,f]of r.associations)(h instanceof Dn||h instanceof Hn)&&d.set(h,f);return u.traverse(h=>{const f=r.associations.get(h);null!=f&&d.set(h,f)}),d})(s),s})}}function FF(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(const o in i){const a=fx[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(void 0!==e.indices&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return po(n,e),function mZ(n,e,t){const i=e.attributes,r=new eo;if(void 0===i.POSITION)return;{const a=t.json.accessors[i.POSITION],l=a.min,c=a.max;if(void 0===l||void 0===c)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new D(l[0],l[1],l[2]),new D(c[0],c[1],c[2])),a.normalized){const u=mx(wc[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}const s=e.targets;if(void 0!==s){const a=new D,l=new D;for(let c=0,u=s.length;c<u;c++){const d=s[c];if(void 0!==d.POSITION){const h=t.json.accessors[d.POSITION],f=h.min,p=h.max;if(void 0!==f&&void 0!==p){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),h.normalized){const m=mx(wc[h.componentType]);l.multiplyScalar(m)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new io;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function cZ(n,e,t){let i=!1,r=!1,s=!1;for(let c=0,u=e.length;c<u;c++){const d=e[c];if(void 0!==d.POSITION&&(i=!0),void 0!==d.NORMAL&&(r=!0),void 0!==d.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const d=e[c];if(i){const h=void 0!==d.POSITION?t.getDependency("accessor",d.POSITION):n.attributes.position;o.push(h)}if(r){const h=void 0!==d.NORMAL?t.getDependency("accessor",d.NORMAL):n.attributes.normal;a.push(h)}if(s){const h=void 0!==d.COLOR_0?t.getDependency("accessor",d.COLOR_0):n.attributes.color;l.push(h)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const d=c[1],h=c[2];return i&&(n.morphAttributes.position=c[0]),r&&(n.morphAttributes.normal=d),s&&(n.morphAttributes.color=h),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}function gZ(n,e){if(1&n){const t=nf();pt(0,"ngt-primitive",3),pn("beforeRender",function(r){return Co(t),Do(as().onBeforeRender(r))}),Ot()}2&n&&fn("scale",1)}const _Z=function(n){return[n]};!function yK(n){Object.assign(_F,n)}(Ec);let yZ=(()=>{class n{constructor(){this.model$=cF(()=>VK,"assets/vitesse_sphere_2.glb").pipe(Nt(t=>t.scene))}onBeforeRender(t){t.object.rotation.x+=.01}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Gi({type:n,selectors:[["ng-component"]],standalone:!0,features:[hu],decls:4,vars:7,consts:[["angle","0.15","penumbra","1","color","red",3,"position"],[3,"position"],[3,"scale","beforeRender",4,"args"],[3,"scale","beforeRender"]],template:function(t,i){1&t&&(Yn(0,"ngt-spot-light",0)(1,"ngt-point-light",1),su(2,gZ,1,1,"ngt-primitive",2),function yD(n,e){const t=lt();let i;const r=n+Wt;t.firstCreatePass?(i=function nz(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??(t.destroyHooks=[])).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=Eo(i.type)),o=Hi(U);try{const a=Dh(!1),l=s();return Dh(a),function WB(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,re(),r,l),l}finally{Hi(o)}}(3,"ngtPush")),2&t&&(fn("position",10),yi(1),fn("position",10),yi(1),fn("args",function hD(n,e,t,i){return fD(re(),ri(),n,e,t,i)}(5,_Z,vD(3,3,i.model$))))},dependencies:[LK,yF],encapsulation:2}),n})(),vZ=(()=>{class n{constructor(){this.Scene=yZ}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Gi({type:n,selectors:[["app-one-step-down"]],decls:1,vars:1,consts:[[3,"sceneGraph"]],template:function(t,i){1&t&&Yn(0,"ngt-canvas",0),2&t&&fn("sceneGraph",i.Scene)},dependencies:[MF]}),n})(),bZ=(()=>{class n{constructor(){this.title="VitesseVent_OS_3",this.FMisOpen=!1,this.EEisOpen=!0}ngOnInit(){setTimeout(()=>{this.FMisOpen=!0},2e3)}rightAnimDone(t){"void"!=t.fromState&&(console.log(t.fromState),setTimeout(()=>{this.FMisOpen=!1},5e3),setTimeout(()=>{this.EEisOpen=!1},7e3))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Gi({type:n,selectors:[["app-root"]],decls:38,vars:4,consts:[[1,"topDiv"],[1,"menuDiv"],["mat-icon-button","","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item",""],["mat-menu-item","","disabled",""],[1,"messageDiv"],[1,"WTPar"],[1,"YTPar"],[1,"loremDiv"],[1,"lorem"],[1,"firstDiv"]],template:function(t,i){if(1&t&&(pt(0,"div",0)(1,"div",1),vi(2,"Vanta"),pt(3,"b"),vi(4,"Black"),Ot()(),pt(5,"div",1)(6,"button",2)(7,"mat-icon"),vi(8,"menu"),Ot()(),pt(9,"mat-menu",null,3)(11,"button",4)(12,"mat-icon"),vi(13,"dialpad"),Ot(),pt(14,"span"),vi(15,"Redial"),Ot()(),pt(16,"button",5)(17,"mat-icon"),vi(18,"voicemail"),Ot(),pt(19,"span"),vi(20,"Check voice mail"),Ot()(),pt(21,"button",4)(22,"mat-icon"),vi(23,"notifications_off"),Ot(),pt(24,"span"),vi(25,"Disable alerts"),Ot()()()()(),pt(26,"div",6),pn("@FMopenClose.done",function(s){return i.rightAnimDone(s)}),pt(27,"p",7),vi(28,"Freelance"),Ot(),pt(29,"p",8),vi(30,"Graphiste"),Ot(),pt(31,"p",8),vi(32,"Web designer"),Ot(),pt(33,"div",9)(34,"p",10),vi(35,"Lorem ipsum dolor sit amet consectetur adipisicing elit. Deleniti animi aliquid quo illum ex quisquam facilis, mollitia assumenda optio rerum? Expedita tenetur amet laboriosam delectus repellat ullam quisquam re maiores."),Ot()()(),pt(36,"div",11),Yn(37,"app-one-step-down"),Ot()),2&t){const r=function $_(n){return Ga(function GN(){return We.lFrame.contextLView}(),Wt+n)}(10);fn("@FMopenClose",i.EEisOpen?"closed":"open"),yi(6),fn("matMenuTriggerFor",r),yi(20),fn("@FMopenClose",i.FMisOpen?"open":"closed"),yi(10),fn("@FMopenClose",i.EEisOpen?"closed":"open")}},dependencies:[y8,ej,lW,rp,hW,vZ],data:{animation:[KG]}}),n})();function OF(n){return new se(3e3,!1)}function tJ(){return typeof window<"u"&&typeof window.document<"u"}function gx(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function mo(n){switch(n.length){case 0:return new Du;case 1:return n[0];default:return new vT(n)}}function LF(n,e,t,i,r=new Map,s=new Map){const o=[],a=[];let l=-1,c=null;if(i.forEach(u=>{const d=u.get("offset"),h=d==l,f=h&&c||new Map;u.forEach((p,m)=>{let g=m,y=p;if("offset"!==m)switch(g=e.normalizePropertyName(g,o),y){case uv:y=r.get(m);break;case ds:y=s.get(m);break;default:y=e.normalizeStyleValue(m,g,y,o)}f.set(g,y)}),h||a.push(f),c=f,l=d}),o.length)throw function GZ(n){return new se(3502,!1)}();return a}function _x(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&yx(t,"start",n)));break;case"done":n.onDone(()=>i(t&&yx(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&yx(t,"destroy",n)))}}function yx(n,e,t){const s=vx(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),o=n._data;return null!=o&&(s._data=o),s}function vx(n,e,t,i,r="",s=0,o){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function ki(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function NF(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}let bx=(n,e)=>!1,kF=(n,e,t)=>[],BF=null;function xx(n){const e=n.parentNode||n.host;return e===BF?null:e}(gx()||typeof Element<"u")&&(tJ()?(BF=(()=>document.documentElement)(),bx=(n,e)=>{for(;e;){if(e===n)return!0;e=xx(e)}return!1}):bx=(n,e)=>n.contains(e),kF=(n,e,t)=>{if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]});let Ca=null,VF=!1;const UF=bx,zF=kF;let HF=(()=>{class n{validateStyleProperty(t){return function iJ(n){Ca||(Ca=function rJ(){return typeof document<"u"?document.body:null}()||{},VF=!!Ca.style&&"WebkitAppearance"in Ca.style);let e=!0;return Ca.style&&!function nJ(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Ca.style,!e&&VF&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Ca.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return UF(t,i)}getParentElement(t){return xx(t)}query(t,i,r){return zF(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],l){return new Du(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ce({token:n,factory:n.\u0275fac}),n})(),wx=(()=>{class n{}return n.NOOP=new HF,n})();const sJ=1e3,Mx="ng-enter",Am="ng-leave",Tm="ng-trigger",Im=".ng-trigger",jF="ng-animating",Sx=".ng-animating";function Is(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:Ex(parseFloat(e[1]),e[2])}function Ex(n,e){return"s"===e?n*sJ:n}function Rm(n,e,t){return n.hasOwnProperty("duration")?n:function aJ(n,e,t){let r,s=0,o="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(OF()),{duration:0,delay:0,easing:""};r=Ex(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=Ex(parseFloat(l),a[4]));const c=a[5];c&&(o=c)}else r=n;if(!t){let a=!1,l=e.length;r<0&&(e.push(function xZ(){return new se(3100,!1)}()),a=!0),s<0&&(e.push(function wZ(){return new se(3101,!1)}()),a=!0),a&&e.splice(l,0,OF())}return{duration:r,delay:s,easing:o}}(n,e,t)}function Wd(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function WF(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function go(n,e=new Map,t){if(t)for(let[i,r]of t)e.set(i,r);for(let[i,r]of n)e.set(i,r);return e}function qF(n,e,t){return t?e+":"+t+";":""}function XF(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=qF(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=qF(0,dJ(t),n.style[t]));n.setAttribute("style",e)}function Yr(n,e,t){n.style&&(e.forEach((i,r)=>{const s=Dx(r);t&&!t.has(r)&&t.set(r,n.style[s]),n.style[s]=i}),gx()&&XF(n))}function Da(n,e){n.style&&(e.forEach((t,i)=>{const r=Dx(i);n.style[r]=""}),gx()&&XF(n))}function $d(n){return Array.isArray(n)?1==n.length?n[0]:_T(n):n}const Cx=new RegExp("{{\\s*(.+?)\\s*}}","g");function YF(n){let e=[];if("string"==typeof n){let t;for(;t=Cx.exec(n);)e.push(t[1]);Cx.lastIndex=0}return e}function qd(n,e,t){const i=n.toString(),r=i.replace(Cx,(s,o)=>{let a=e[o];return null==a&&(t.push(function SZ(n){return new se(3003,!1)}()),a=""),a.toString()});return r==i?n:r}function Pm(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const uJ=/-+([a-z0-9])/g;function Dx(n){return n.replace(uJ,(...e)=>e[1].toUpperCase())}function dJ(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Bi(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function EZ(n){return new se(3004,!1)}()}}function KF(n,e){return window.getComputedStyle(n)[e]}const Lm="*";function _J(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function yJ(n,e,t){if(":"==n[0]){const l=function vJ(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function VZ(n){return new se(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof l)return void e.push(l);n=l}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function BZ(n){return new se(3015,!1)}()),e;const r=i[1],s=i[2],o=i[3];e.push(ZF(r,o));"<"==s[0]&&!(r==Lm&&o==Lm)&&e.push(ZF(o,r))}(i,t,e)):t.push(n),t}const Nm=new Set(["true","1"]),km=new Set(["false","0"]);function ZF(n,e){const t=Nm.has(n)||km.has(n),i=Nm.has(e)||km.has(e);return(r,s)=>{let o=n==Lm||n==r,a=e==Lm||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?Nm.has(n):km.has(n)),!a&&i&&"boolean"==typeof s&&(a=s?Nm.has(e):km.has(e)),o&&a}}const bJ=new RegExp("s*:selfs*,?","g");function Ax(n,e,t,i){return new xJ(n).build(e,t,i)}class xJ{constructor(e){this._driver=e}build(e,t,i){const r=new SJ(t);return this._resetContextStyleTimingState(r),Bi(this,$d(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function DZ(){return new se(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,s.push(this.visitState(l,t))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,t);i+=l.queryCount,r+=l.depCount,o.push(l)}else t.errors.push(function AZ(){return new se(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{YF(l).forEach(c=>{o.hasOwnProperty(c)||s.add(c)})})}),s.size&&(Pm(s.values()),t.errors.push(function TZ(n,e){return new se(3008,!1)}()))}return{type:0,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=Bi(this,$d(e.animation),t);return{type:1,matchers:_J(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Aa(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(i=>Bi(this,i,t)),options:Aa(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=i;const a=Bi(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:3,steps:s,options:Aa(e.options)}}visitAnimate(e,t){const i=function CJ(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return Tx(Rm(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=Tx(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=Rm(t,e);return Tx(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:yr({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const c={};i.easing&&(c.easing=i.easing),o=yr(c)}t.currentTime+=i.duration+i.delay;const l=this.visitStyle(o,t);l.isEmptyStep=a,r=l}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of r)"string"==typeof a?a===ds?i.push(a):t.errors.push(new se(3002,!1)):i.push(WF(a));let s=!1,o=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let l of a.values())if(l.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:i,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,l)=>{const c=t.collectedStyles.get(t.currentQuerySelector),u=c.get(l);let d=!0;u&&(s!=r&&s>=u.startTime&&r<=u.endTime&&(t.errors.push(function RZ(n,e,t,i,r){return new se(3010,!1)}()),d=!1),s=u.startTime),d&&c.set(l,{startTime:s,endTime:r}),t.options&&function cJ(n,e,t){const i=e.params||{},r=YF(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function MZ(n){return new se(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function PZ(){return new se(3011,!1)}()),i;let s=0;const o=[];let a=!1,l=!1,c=0;const u=e.steps.map(y=>{const v=this._makeStyleAst(y,t);let _=null!=v.offset?v.offset:function EJ(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(v.styles),b=0;return null!=_&&(s++,b=v.offset=_),l=l||b<0||b>1,a=a||b<c,c=b,o.push(b),v});l&&t.errors.push(function FZ(){return new se(3012,!1)}()),a&&t.errors.push(function OZ(){return new se(3200,!1)}());const d=e.steps.length;let h=0;s>0&&s<d?t.errors.push(function LZ(){return new se(3202,!1)}()):0==s&&(h=1/(d-1));const f=d-1,p=t.currentTime,m=t.currentAnimateTimings,g=m.duration;return u.forEach((y,v)=>{const _=h>0?v==f?1:h*v:o[v],b=_*g;t.currentTime=p+m.delay+b,m.duration=b,this._validateStyleAst(y,t),y.offset=_,i.styles.push(y)}),i}visitReference(e,t){return{type:8,animation:Bi(this,$d(e.animation),t),options:Aa(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Aa(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Aa(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function wJ(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(bJ,"")),n=n.replace(/@\*/g,Im).replace(/@\w+/g,t=>Im+"-"+t.slice(1)).replace(/:animating/g,Sx),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,ki(t.collectedStyles,t.currentQuerySelector,new Map);const a=Bi(this,$d(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:Aa(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function NZ(){return new se(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:Rm(e.timings,t.errors,!0);return{type:12,animation:Bi(this,$d(e.animation),t),timings:i,options:null}}}class SJ{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Aa(n){return n?(n=Wd(n)).params&&(n.params=function MJ(n){return n?Wd(n):null}(n.params)):n={},n}function Tx(n,e,t){return{duration:n,delay:e,easing:t}}function Ix(n,e,t,i,r,s,o=null,a=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class Bm{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const TJ=new RegExp(":enter","g"),RJ=new RegExp(":leave","g");function Rx(n,e,t,i,r,s=new Map,o=new Map,a,l,c=[]){return(new PJ).buildKeyframes(n,e,t,i,r,s,o,a,l,c)}class PJ{buildKeyframes(e,t,i,r,s,o,a,l,c,u=[]){c=c||new Bm;const d=new Px(e,t,c,r,s,u,[]);d.options=l;const h=l.delay?Is(l.delay):0;d.currentTimeline.delayNextStep(h),d.currentTimeline.setStyles([o],null,d.errors,l),Bi(this,i,d);const f=d.timelines.filter(p=>p.containsAnimation());if(f.length&&a.size){let p;for(let m=f.length-1;m>=0;m--){const g=f[m];if(g.element===t){p=g;break}}p&&!p.allowOnlyTimelineStyles()&&p.setStyles([a],null,d.errors,l)}return f.length?f.map(p=>p.buildKeyframes()):[Ix(t,[],[],[],0,h,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const r of e){const s=r?.delay;if(s){const o="number"==typeof s?s:Is(qd(s,r?.params??{},t.errors));i.delayNextStep(o)}}}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const o=null!=i.duration?Is(i.duration):null,a=null!=i.delay?Is(i.delay):null;return 0!==o&&e.forEach(l=>{const c=t.appendInstructionToTimeline(l,o,a);s=Math.max(s,c.duration+c.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),Bi(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Vm);const o=Is(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>Bi(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?Is(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),Bi(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return Rm(t.params?qd(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,a=t.createSubContext().currentTimeline;a.easing=i.easing,e.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?Is(r.delay):0;s&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Vm);let o=i;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{t.currentQueryIndex=u;const d=t.createSubContext(e.options,c);s&&d.delayNextStep(s),c===t.element&&(l=d.currentTimeline),Bi(this,e.animation,d),d.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,d.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let l=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const u=t.currentTimeline;l&&u.delayNextStep(l);const d=u.currentTime;Bi(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-d+(r.startTime-i.currentTimeline.startTime)}}const Vm={};class Px{constructor(e,t,i,r,s,o,a,l){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Vm,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new Um(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=Is(i.duration)),null!=i.delay&&(r.delay=Is(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=qd(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new Px(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=Vm,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new FJ(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(TJ,"."+this._enterClassName)).replace(RJ,"."+this._leaveClassName);let c=this._driver.query(this.element,e,1!=i);0!==i&&(c=i<0?c.slice(c.length+i,c.length):c.slice(0,i)),a.push(...c)}return!s&&0==a.length&&o.push(function kZ(n){return new se(3014,!1)}()),a}}class Um{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new Um(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||ds),this._currentKeyframe.set(t,ds);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},o=function OJ(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||e.keys();for(let s of i)t.set(s,ds)}else go(r,t)}),t}(e,this._globalTimelineStyles);for(let[a,l]of o){const c=qd(l,s,i);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??ds),this._updateStyle(a,c)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const c=go(a,new Map,this._backFill);c.forEach((u,d)=>{u===uv?e.add(d):u===ds&&t.add(d)}),i||c.set("offset",l/this.duration),r.push(c)});const s=e.size?Pm(e.values()):[],o=t.size?Pm(t.values()):[];if(i){const a=r[0],l=new Map(a);a.set("offset",0),l.set("offset",1),r=[a,l]}return Ix(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class FJ extends Um{constructor(e,t,i,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=i+t,a=t/o,l=go(e[0]);l.set("offset",0),s.push(l);const c=go(e[0]);c.set("offset",eO(a)),s.push(c);const u=e.length-1;for(let d=1;d<=u;d++){let h=go(e[d]);const f=h.get("offset");h.set("offset",eO((t+f*i)/o)),s.push(h)}i=o,t=0,r="",e=s}return Ix(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function eO(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class Fx{}const LJ=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class NJ extends Fx{normalizePropertyName(e,t){return Dx(e)}normalizeStyleValue(e,t,i,r){let s="";const o=i.toString().trim();if(LJ.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function CZ(n,e){return new se(3005,!1)}())}return o+s}}function tO(n,e,t,i,r,s,o,a,l,c,u,d,h){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:d,errors:h}}const Ox={};class nO{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function kJ(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,s,o,a,l,c,u){const d=[],h=this.ast.options&&this.ast.options.params||Ox,p=this.buildStyles(i,a&&a.params||Ox,d),m=l&&l.params||Ox,g=this.buildStyles(r,m,d),y=new Set,v=new Map,_=new Map,b="void"===r,w={params:BJ(m,h),delay:this.ast.options?.delay},M=u?[]:Rx(e,t,this.ast.animation,s,o,p,g,w,c,d);let C=0;if(M.forEach(S=>{C=Math.max(S.duration+S.delay,C)}),d.length)return tO(t,this._triggerName,i,r,b,p,g,[],[],v,_,C,d);M.forEach(S=>{const I=S.element,L=ki(v,I,new Set);S.preStyleProps.forEach(P=>L.add(P));const k=ki(_,I,new Set);S.postStyleProps.forEach(P=>k.add(P)),I!==t&&y.add(I)});const x=Pm(y.values());return tO(t,this._triggerName,i,r,b,p,g,M,x,v,_,C)}}function BJ(n,e){const t=Wd(e);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(t[i]=n[i]);return t}class VJ{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=Wd(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(r[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=qd(o,r,t));const l=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,l,o,t),i.set(a,o)})}),i}}class zJ{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new VJ(r.style,r.options&&r.options.params||{},i))}),iO(this.states,"true","1"),iO(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new nO(e,r,this.states))}),this.fallbackTransition=function HJ(n,e,t){return new nO(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(o=>o.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function iO(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const GJ=new Bm;class jJ{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],r=[],s=Ax(this._driver,t,i,r);if(i.length)throw function jZ(n){return new se(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,i){const r=e.element,s=LF(0,this._normalizer,0,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=Rx(this._driver,t,s,Mx,Am,new Map,new Map,i,GJ,r),o.forEach(u=>{const d=ki(a,u.element,new Map);u.postStyleProps.forEach(h=>d.set(h,null))})):(r.push(function WZ(){return new se(3300,!1)}()),o=[]),r.length)throw function $Z(n){return new se(3504,!1)}();a.forEach((u,d)=>{u.forEach((h,f)=>{u.set(f,this._driver.computeStyle(d,f,ds))})});const c=mo(o.map(u=>{const d=a.get(u.element);return this._buildPlayer(u,new Map,d)}));return this._playersById.set(e,c),c.onDestroy(()=>this.destroy(e)),this.players.push(c),c}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function qZ(n){return new se(3301,!1)}();return t}listen(e,t,i,r){const s=vx(t,"","","");return _x(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const rO="ng-animate-queued",Lx="ng-animate-disabled",YJ=[],sO={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},KJ={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},rr="__ng_removed";class Nx{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function eQ(n){return n??null}(i?e.value:e),i){const s=Wd(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const Xd="void",kx=new Nx(Xd);class ZJ{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,sr(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function XZ(n,e){return new se(3302,!1)}();if(null==i||0==i.length)throw function YZ(n){return new se(3303,!1)}();if(!function tQ(n){return"start"==n||"done"==n}(i))throw function KZ(n,e){return new se(3400,!1)}();const s=ki(this._elementListeners,e,[]),o={name:t,phase:i,callback:r};s.push(o);const a=ki(this._engine.statesByElement,e,new Map);return a.has(t)||(sr(e,Tm),sr(e,Tm+"-"+t),a.set(t,kx)),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function ZZ(n){return new se(3401,!1)}();return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),o=new Bx(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(sr(e,Tm),sr(e,Tm+"-"+t),this._engine.statesByElement.set(e,a=new Map));let l=a.get(t);const c=new Nx(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(t,c),l||(l=kx),c.value!==Xd&&l.value===c.value){if(!function rQ(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(l.params,c.params)){const m=[],g=s.matchStyles(l.value,l.params,m),y=s.matchStyles(c.value,c.params,m);m.length?this._engine.reportError(m):this._engine.afterFlush(()=>{Da(e,g),Yr(e,y)})}return}const h=ki(this._engine.playersByElement,e,[]);h.forEach(m=>{m.namespaceId==this.id&&m.triggerName==t&&m.queued&&m.destroy()});let f=s.matchTransition(l.value,c.value,e,c.params),p=!1;if(!f){if(!r)return;f=s.fallbackTransition,p=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:l,toState:c,player:o,isFallbackTransition:p}),p||(sr(e,rO),o.onStart(()=>{Mc(e,rO)})),o.onDone(()=>{let m=this.players.indexOf(o);m>=0&&this.players.splice(m,1);const g=this._engine.playersByElement.get(e);if(g){let y=g.indexOf(o);y>=0&&g.splice(y,1)}}),this.players.push(o),h.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,Im,!0);i.forEach(r=>{if(r[rr])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((l,c)=>{if(o.set(c,l.value),this._triggers.has(c)){const u=this.trigger(e,c,Xd,r);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),i&&mo(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const l=this._triggers.get(o).fallbackTransition,c=i.get(o)||kx,u=new Nx(Xd),d=new Bx(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:l,fromState:c,toState:u,player:d,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[rr];(!s||s===sO)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){sr(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==i.triggerName){const l=vx(s,i.triggerName,i.fromState.value,i.toState.value);l._data=e,_x(i.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(i=>i.element===e)||t,t}}class JJ{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new ZJ(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const l=r.get(a);if(l){const c=i.indexOf(l);i.splice(c+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){if(!e)return;const i=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,i,r){if(zm(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!zm(t))return;const s=t[rr];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),sr(e,Lx)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Mc(e,Lx))}removeNode(e,t,i,r){if(zm(t)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),i){const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[rr]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return zm(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,Im,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,Sx,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return mo(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[rr];if(t&&t.setForRemoval){if(e[rr]=sO,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(Lx)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)sr(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?mo(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function JZ(n){return new se(3402,!1)}()}_flushAnimations(e,t){const i=new Bm,r=[],s=new Map,o=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(O=>{u.add(O);const G=this.driver.query(O,".ng-animate-queued",!0);for(let N=0;N<G.length;N++)u.add(G[N])});const d=this.bodyNode,h=Array.from(this.statesByElement.keys()),f=lO(h,this.collectedEnterElements),p=new Map;let m=0;f.forEach((O,G)=>{const N=Mx+m++;p.set(G,N),O.forEach($=>sr($,N))});const g=[],y=new Set,v=new Set;for(let O=0;O<this.collectedLeaveElements.length;O++){const G=this.collectedLeaveElements[O],N=G[rr];N&&N.setForRemoval&&(g.push(G),y.add(G),N.hasAnimation?this.driver.query(G,".ng-star-inserted",!0).forEach($=>y.add($)):v.add(G))}const _=new Map,b=lO(h,Array.from(y));b.forEach((O,G)=>{const N=Am+m++;_.set(G,N),O.forEach($=>sr($,N))}),e.push(()=>{f.forEach((O,G)=>{const N=p.get(G);O.forEach($=>Mc($,N))}),b.forEach((O,G)=>{const N=_.get(G);O.forEach($=>Mc($,N))}),g.forEach(O=>{this.processLeaveNode(O)})});const w=[],M=[];for(let O=this._namespaceList.length-1;O>=0;O--)this._namespaceList[O].drainQueuedTransitions(t).forEach(N=>{const $=N.player,Y=N.element;if(w.push($),this.collectedEnterElements.length){const ve=Y[rr];if(ve&&ve.setForMove){if(ve.previousTriggersValues&&ve.previousTriggersValues.has(N.triggerName)){const _e=ve.previousTriggersValues.get(N.triggerName),be=this.statesByElement.get(N.element);if(be&&be.has(N.triggerName)){const le=be.get(N.triggerName);le.value=_e,be.set(N.triggerName,le)}}return void $.destroy()}}const pe=!d||!this.driver.containsElement(d,Y),B=_.get(Y),te=p.get(Y),ne=this._buildInstruction(N,i,te,B,pe);if(ne.errors&&ne.errors.length)return void M.push(ne);if(pe)return $.onStart(()=>Da(Y,ne.fromStyles)),$.onDestroy(()=>Yr(Y,ne.toStyles)),void r.push($);if(N.isFallbackTransition)return $.onStart(()=>Da(Y,ne.fromStyles)),$.onDestroy(()=>Yr(Y,ne.toStyles)),void r.push($);const ce=[];ne.timelines.forEach(ve=>{ve.stretchStartingKeyframe=!0,this.disabledNodes.has(ve.element)||ce.push(ve)}),ne.timelines=ce,i.append(Y,ne.timelines),o.push({instruction:ne,player:$,element:Y}),ne.queriedElements.forEach(ve=>ki(a,ve,[]).push($)),ne.preStyleProps.forEach((ve,_e)=>{if(ve.size){let be=l.get(_e);be||l.set(_e,be=new Set),ve.forEach((le,qe)=>be.add(qe))}}),ne.postStyleProps.forEach((ve,_e)=>{let be=c.get(_e);be||c.set(_e,be=new Set),ve.forEach((le,qe)=>be.add(qe))})});if(M.length){const O=[];M.forEach(G=>{O.push(function QZ(n,e){return new se(3505,!1)}())}),w.forEach(G=>G.destroy()),this.reportError(O)}const C=new Map,x=new Map;o.forEach(O=>{const G=O.element;i.has(G)&&(x.set(G,G),this._beforeAnimationBuild(O.player.namespaceId,O.instruction,C))}),r.forEach(O=>{const G=O.element;this._getPreviousPlayers(G,!1,O.namespaceId,O.triggerName,null).forEach($=>{ki(C,G,[]).push($),$.destroy()})});const S=g.filter(O=>uO(O,l,c)),I=new Map;aO(I,this.driver,v,c,ds).forEach(O=>{uO(O,l,c)&&S.push(O)});const k=new Map;f.forEach((O,G)=>{aO(k,this.driver,new Set(O),l,uv)}),S.forEach(O=>{const G=I.get(O),N=k.get(O);I.set(O,new Map([...Array.from(G?.entries()??[]),...Array.from(N?.entries()??[])]))});const P=[],R=[],j={};o.forEach(O=>{const{element:G,player:N,instruction:$}=O;if(i.has(G)){if(u.has(G))return N.onDestroy(()=>Yr(G,$.toStyles)),N.disabled=!0,N.overrideTotalTime($.totalTime),void r.push(N);let Y=j;if(x.size>1){let B=G;const te=[];for(;B=B.parentNode;){const ne=x.get(B);if(ne){Y=ne;break}te.push(B)}te.forEach(ne=>x.set(ne,Y))}const pe=this._buildAnimation(N.namespaceId,$,C,s,k,I);if(N.setRealPlayer(pe),Y===j)P.push(N);else{const B=this.playersByElement.get(Y);B&&B.length&&(N.parentPlayer=mo(B)),r.push(N)}}else Da(G,$.fromStyles),N.onDestroy(()=>Yr(G,$.toStyles)),R.push(N),u.has(G)&&r.push(N)}),R.forEach(O=>{const G=s.get(O.element);if(G&&G.length){const N=mo(G);O.setRealPlayer(N)}}),r.forEach(O=>{O.parentPlayer?O.syncPlayerEvents(O.parentPlayer):O.destroy()});for(let O=0;O<g.length;O++){const G=g[O],N=G[rr];if(Mc(G,Am),N&&N.hasAnimation)continue;let $=[];if(a.size){let pe=a.get(G);pe&&pe.length&&$.push(...pe);let B=this.driver.query(G,Sx,!0);for(let te=0;te<B.length;te++){let ne=a.get(B[te]);ne&&ne.length&&$.push(...ne)}}const Y=$.filter(pe=>!pe.destroyed);Y.length?nQ(this,G,Y):this.processLeaveNode(G)}return g.length=0,P.forEach(O=>{this.players.push(O),O.onDone(()=>{O.destroy();const G=this.players.indexOf(O);this.players.splice(G,1)}),O.play()}),P}elementContainsData(e,t){let i=!1;const r=t[rr];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(t)&&(i=!0),this.playersByQueriedElement.has(t)&&(i=!0),this.statesByElement.has(t)&&(i=!0),this._fetchNamespace(e).elementContainsData(t)||i}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const l=!s||s==Xd;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||o.push(c)})}}return(i||r)&&(o=o.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,i){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const l of t.timelines){const c=l.element,u=c!==s,d=ki(i,c,[]);this._getPreviousPlayers(c,u,o,a,t.toState).forEach(f=>{const p=f.getRealPlayer();p.beforeDestroy&&p.beforeDestroy(),f.destroy(),d.push(f)})}Da(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,o){const a=t.triggerName,l=t.element,c=[],u=new Set,d=new Set,h=t.timelines.map(p=>{const m=p.element;u.add(m);const g=m[rr];if(g&&g.removedBeforeQueried)return new Du(p.duration,p.delay);const y=m!==l,v=function iQ(n){const e=[];return cO(n,e),e}((i.get(m)||YJ).map(C=>C.getRealPlayer())).filter(C=>!!C.element&&C.element===m),_=s.get(m),b=o.get(m),w=LF(0,this._normalizer,0,p.keyframes,_,b),M=this._buildPlayer(p,w,v);if(p.subTimeline&&r&&d.add(m),y){const C=new Bx(e,a,m);C.setRealPlayer(M),c.push(C)}return M});c.forEach(p=>{ki(this.playersByQueriedElement,p.element,[]).push(p),p.onDone(()=>function QJ(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,p.element,p))}),u.forEach(p=>sr(p,jF));const f=mo(h);return f.onDestroy(()=>{u.forEach(p=>Mc(p,jF)),Yr(l,t.toStyles)}),d.forEach(p=>{ki(r,p,[]).push(f)}),f}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new Du(e.duration,e.delay)}}class Bx{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new Du,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>_x(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){ki(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function zm(n){return n&&1===n.nodeType}function oO(n,e){const t=n.style.display;return n.style.display=e??"none",t}function aO(n,e,t,i,r){const s=[];t.forEach(l=>s.push(oO(l)));const o=[];i.forEach((l,c)=>{const u=new Map;l.forEach(d=>{const h=e.computeStyle(c,d,r);u.set(d,h),(!h||0==h.length)&&(c[rr]=KJ,o.push(c))}),n.set(c,u)});let a=0;return t.forEach(l=>oO(l,s[a++])),o}function lO(n,e){const t=new Map;if(n.forEach(a=>t.set(a,[])),0==e.length)return t;const i=1,r=new Set(e),s=new Map;function o(a){if(!a)return i;let l=s.get(a);if(l)return l;const c=a.parentNode;return l=t.has(c)?c:r.has(c)?i:o(c),s.set(a,l),l}return e.forEach(a=>{const l=o(a);l!==i&&t.get(l).push(a)}),t}function sr(n,e){n.classList?.add(e)}function Mc(n,e){n.classList?.remove(e)}function nQ(n,e,t){mo(t).onDone(()=>n.processLeaveNode(e))}function cO(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof vT?cO(i.players,e):e.push(i)}}function uO(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class Hm{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new JJ(e,t,i),this._timelineEngine=new jJ(e,t,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,i,r,s){const o=e+"-"+r;let a=this._triggerCache[o];if(!a){const l=[],c=[],u=Ax(this._driver,s,l,c);if(l.length)throw function HZ(n,e){return new se(3404,!1)}();a=function UJ(n,e,t){return new zJ(n,e,t)}(r,u,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i,r){this._transitionEngine.removeNode(e,t,r||!1,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,o]=NF(i);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[o,a]=NF(i);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let oQ=(()=>{class n{constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r,this._state=0;let s=n.initialStylesByElement.get(t);s||n.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&Yr(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Yr(this._element,this._initialStyles),this._endStyles&&(Yr(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Da(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Da(this._element,this._endStyles),this._endStyles=null),Yr(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function Vx(n){let e=null;return n.forEach((t,i)=>{(function aQ(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class dO{constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&e.set(r,this._finished?i:KF(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class lQ{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return UF(e,t)}getParentElement(e){return xx(e)}query(e,t,i){return zF(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}animate(e,t,i,r,s,o=[]){const l={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(l.easing=s);const c=new Map,u=o.filter(f=>f instanceof dO);(function hJ(n,e){return 0===n||0===e})(i,r)&&u.forEach(f=>{f.currentSnapshot.forEach((p,m)=>c.set(m,p))});let d=function lJ(n){return n.length?n[0]instanceof Map?n:n.map(e=>WF(e)):[]}(t).map(f=>go(f));d=function fJ(n,e,t){if(t.size&&e.length){let i=e[0],r=[];if(t.forEach((s,o)=>{i.has(o)||r.push(o),i.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(a=>o.set(a,KF(n,a)))}}return e}(e,d,c);const h=function sQ(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=Vx(e[0]),e.length>1&&(i=Vx(e[e.length-1]))):e instanceof Map&&(t=Vx(e)),t||i?new oQ(n,t,i):null}(e,d);return new dO(e,d,l,h)}}let cQ=(()=>{class n extends gT{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:ar.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?_T(t):t;return hO(this._renderer,null,i,"register",[r]),new uQ(i,this._renderer)}}return n.\u0275fac=function(t){return new(t||n)(ie(Lo),ie(at))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac}),n})();class uQ extends YG{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new dQ(this._id,e,t||{},this._renderer)}}class dQ{constructor(e,t,i,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return hO(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function hO(n,e,t,i,r){return n.setProperty(e,`@@${t}:${i}`,r)}const fO="@.disabled";let hQ=(()=>{class n{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(s,o)=>{const a=o?.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,i){const s=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let u=this._rendererCache.get(s);return u||(u=new pO("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,u)),u}const o=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const l=u=>{Array.isArray(u)?u.forEach(l):this.engine.registerTrigger(o,a,t,u.name,u)};return i.data.animation.forEach(l),new fQ(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(t){return new(t||n)(ie(Lo),ie(Hm),ie(ot))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac}),n})();class pO{constructor(e,t,i,r){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?s=>t.destroyNode(s):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate,i)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==fO?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class fQ extends pO{constructor(e,t,i,r,s){super(t,i,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==fO?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function pQ(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function mQ(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(e,t,i)}}const mO=[{provide:gT,useClass:cQ},{provide:Fx,useFactory:function _Q(){return new NJ}},{provide:Hm,useClass:(()=>{class n extends Hm{constructor(t,i,r,s){super(t.body,i,r)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(t){return new(t||n)(ie(at),ie(wx),ie(Fx),ie(yu))},n.\u0275prov=Ce({token:n,factory:n.\u0275fac}),n})()},{provide:Lo,useFactory:function yQ(n,e,t){return new hQ(n,e,t)},deps:[Lf,Hm,ot]}],Ux=[{provide:wx,useFactory:()=>new lQ},{provide:Ml,useValue:"BrowserAnimations"},...mO],gO=[{provide:wx,useClass:HF},{provide:Ml,useValue:"NoopAnimations"},...mO];let vQ=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?gO:Ux}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=wn({type:n}),n.\u0275inj=hn({providers:Ux,imports:[hT]}),n})(),bL=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=wn({type:n}),n.\u0275inj=hn({}),n})(),Pee=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=wn({type:n}),n.\u0275inj=hn({imports:[bL,Gr,Sv,Qy,bL,Gr]}),n})(),Fee=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=wn({type:n,bootstrap:[bZ]}),n.\u0275inj=hn({imports:[vQ,hT,v8,tj,fW,Pee,MF]}),n})();zG().bootstrapModule(Fee).catch(n=>console.error(n))}},Qm=>{Qm(Qm.s=456)}]);